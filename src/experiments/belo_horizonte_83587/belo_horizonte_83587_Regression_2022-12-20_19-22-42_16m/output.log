Running:
main.py --output_dir experiments/belo_horizonte_83587/ --comment regression for belo_horizonte_83587 --name belo_horizonte_83587_Regression --records_file experiments/belo_horizonte_83587/belo_horizonte_83587_Regression.xls --data_dir datasets/files/belo_horizonte_83587/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.0001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
639 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18651294708251953 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18651294708251953 seconds
Avg batch val. time: 0.018651294708251952 seconds
Avg sample val. time: 0.00029188254629502276 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 583.363783 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 474.625507 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9234321117401123 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9234321117401123 seconds
Avg batch train. time: 0.06411440372467041 seconds
Avg sample train. time: 0.001002309594445082 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1886301040649414 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18757152557373047 seconds
Avg batch val. time: 0.018757152557373046 seconds
Avg sample val. time: 0.00029353916365216034 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 466.535288 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 469.664772 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.822967290878296 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.873199701309204 seconds
Avg batch train. time: 0.062439990043640134 seconds
Avg sample train. time: 0.0009761332471647754 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1680009365081787 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18104799588521323 seconds
Avg batch val. time: 0.018104799588521323 seconds
Avg sample val. time: 0.00028333019700346355 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 461.804773 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 461.737500 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6960065364837646 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8141353130340576 seconds
Avg batch train. time: 0.060471177101135254 seconds
Avg sample train. time: 0.000945354514348128 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 451.858513 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8033602237701416 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8114415407180786 seconds
Avg batch train. time: 0.06038138469060262 seconds
Avg sample train. time: 0.0009439507768202599 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1920008659362793 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18378621339797974 seconds
Avg batch val. time: 0.018378621339797972 seconds
Avg sample val. time: 0.00028761535743032824 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 448.678064 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 440.669447 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8240265846252441 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8139585494995116 seconds
Avg batch train. time: 0.060465284983317054 seconds
Avg sample train. time: 0.000945262402032054 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 426.396585 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6983726024627686 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.794694224993388 seconds
Avg batch train. time: 0.05982314083311293 seconds
Avg sample train. time: 0.0009352236711794622 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1920008659362793 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18542914390563964 seconds
Avg batch val. time: 0.018542914390563964 seconds
Avg sample val. time: 0.00029018645368644703 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 426.875171 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 408.178027 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.805494785308838 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7962371621813094 seconds
Avg batch train. time: 0.05987457207271031 seconds
Avg sample train. time: 0.0009360277030647782 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 390.648558 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.90339994430542 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8096325099468231 seconds
Avg batch train. time: 0.0603210836648941 seconds
Avg sample train. time: 0.0009430080823068385 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19200396537780762 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18652494748433432 seconds
Avg batch val. time: 0.018652494748433432 seconds
Avg sample val. time: 0.0002919013262665639 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 387.167318 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 367.270306 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.027811288833618 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8338745964898004 seconds
Avg batch train. time: 0.061129153216326684 seconds
Avg sample train. time: 0.0009556407485616469 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 342.365177 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9150245189666748 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8419895887374877 seconds
Avg batch train. time: 0.06139965295791626 seconds
Avg sample train. time: 0.0009598695095036413 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1809983253479004 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18573543003627233 seconds
Avg batch val. time: 0.018573543003627232 seconds
Avg sample val. time: 0.0002906657747046515 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 337.152801 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 313.708898 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9315404891967773 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8501305796883323 seconds
Avg batch train. time: 0.06167101932294441 seconds
Avg sample train. time: 0.0009641118184931382 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 284.041501 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9474163055419922 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8582377235094707 seconds
Avg batch train. time: 0.06194125745031569 seconds
Avg sample train. time: 0.0009683364895828404 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20800113677978516 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18851864337921143 seconds
Avg batch val. time: 0.018851864337921142 seconds
Avg sample val. time: 0.00029502135114117594 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 275.599588 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 251.946690 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.782250165939331 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8523925267733061 seconds
Avg batch train. time: 0.06174641755911021 seconds
Avg sample train. time: 0.0009652905298453915 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 220.247341 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8186414241790771 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.849981733730861 seconds
Avg batch train. time: 0.061666057791028704 seconds
Avg sample train. time: 0.0009640342541588645 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1871778964996338 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1883696715037028 seconds
Avg batch val. time: 0.01883696715037028 seconds
Avg sample val. time: 0.00029478821831565384 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 207.789345 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 189.911580 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7796802520751953 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.84529496828715 seconds
Avg batch train. time: 0.06150983227623833 seconds
Avg sample train. time: 0.0009615919584612558 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 160.636431 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.697035312652588 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.83602873980999 seconds
Avg batch train. time: 0.06120095799366633 seconds
Avg sample train. time: 0.0009567632828608597 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18899965286254883 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1884326696395874 seconds
Avg batch val. time: 0.01884326696395874 seconds
Avg sample val. time: 0.00029488680694771113 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 155.593260 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 133.910059 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6306753158569336 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8239491266362808 seconds
Avg batch train. time: 0.06079830422120936 seconds
Avg sample train. time: 0.0009504685391538723 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 108.663279 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.563075304031372 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8094561364915636 seconds
Avg batch train. time: 0.06031520454971879 seconds
Avg sample train. time: 0.0009429161732629305 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.16700029373168945 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1864842718297785 seconds
Avg batch val. time: 0.01864842718297785 seconds
Avg sample val. time: 0.000291837671095115 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 102.095188 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 85.647884 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5755009651184082 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7971427064192922 seconds
Avg batch train. time: 0.059904756880643076 seconds
Avg sample train. time: 0.0009364995864613299 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 65.042959 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5928337574005127 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7869272589683534 seconds
Avg batch train. time: 0.05956424196561178 seconds
Avg sample train. time: 0.000931176268352451 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1784987449645996 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18581881125768027 seconds
Avg batch val. time: 0.018581881125768026 seconds
Avg sample val. time: 0.0002907962617491084 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 63.547930 | 
Best loss was 63.547929886174686. Other metrics: OrderedDict([('epoch', 20), ('loss', 63.547929886174686)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 41.61161494255066 seconds

