Running:
main.py --output_dir experiments/belo_horizonte_83587/ --comment regression for belo_horizonte_83587 --name belo_horizonte_83587_Regression --records_file experiments/belo_horizonte_83587/belo_horizonte_83587_Regression.xls --data_dir datasets/files/belo_horizonte_83587/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
639 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19705796241760254 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19705796241760254 seconds
Avg batch val. time: 0.019705796241760255 seconds
Avg sample val. time: 0.0003083849177114281 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 536.269186 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 468.274024 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8083667755126953 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8083667755126953 seconds
Avg batch train. time: 0.060278892517089844 seconds
Avg sample train. time: 0.0009423485020910345 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19398903846740723 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19552350044250488 seconds
Avg batch val. time: 0.01955235004425049 seconds
Avg sample val. time: 0.00030598356876761326 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 461.936183 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 463.161486 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9609968662261963 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8846818208694458 seconds
Avg batch train. time: 0.06282272736231485 seconds
Avg sample train. time: 0.0009821166341164387 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19900798797607422 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19668499628702799 seconds
Avg batch val. time: 0.019668499628702797 seconds
Avg sample val. time: 0.0003078012461455837 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 457.391456 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 456.001343 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.793992280960083 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8544519742329915 seconds
Avg batch train. time: 0.061815065807766384 seconds
Avg sample train. time: 0.0009663637176826427 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 445.118105 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7438342571258545 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8267975449562073 seconds
Avg batch train. time: 0.06089325149854024 seconds
Avg sample train. time: 0.000951952863447737 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18199968338012695 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19301366806030273 seconds
Avg batch val. time: 0.019301366806030274 seconds
Avg sample val. time: 0.00030205581856072416 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 442.626800 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 432.869162 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7819273471832275 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8178235054016114 seconds
Avg batch train. time: 0.06059411684672038 seconds
Avg sample train. time: 0.0009472764488804645 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 420.047787 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9306087493896484 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8366210460662842 seconds
Avg batch train. time: 0.06122070153554281 seconds
Avg sample train. time: 0.0009570719364597625 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21999406814575195 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1984097480773926 seconds
Avg batch val. time: 0.019840974807739258 seconds
Avg sample val. time: 0.00031050038822753146 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 419.385829 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 402.742559 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.892486333847046 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.844601801463536 seconds
Avg batch train. time: 0.0614867267154512 seconds
Avg sample train. time: 0.0009612307459424366 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 383.862976 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.075000047683716 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8734015822410583 seconds
Avg batch train. time: 0.06244671940803528 seconds
Avg sample train. time: 0.0009762384482756948 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2100214958190918 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20034503936767578 seconds
Avg batch val. time: 0.02003450393676758 seconds
Avg sample val. time: 0.00031352901309495427 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 383.851780 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 361.386942 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.86911940574646 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8729257848527696 seconds
Avg batch train. time: 0.06243085949509232 seconds
Avg sample train. time: 0.000975990508000401 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 337.970258 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9239459037780762 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8780277967453003 seconds
Avg batch train. time: 0.06260092655817667 seconds
Avg sample train. time: 0.0009786491905916105 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21100068092346191 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20186727387564524 seconds
Avg batch val. time: 0.020186727387564524 seconds
Avg sample val. time: 0.0003159112267224495 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 333.721064 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 311.104229 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.899101734161377 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.879943609237671 seconds
Avg batch train. time: 0.06266478697458903 seconds
Avg sample train. time: 0.0009796475295662695 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 283.295920 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8135828971862793 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.874413549900055 seconds
Avg batch train. time: 0.062480451663335164 seconds
Avg sample train. time: 0.0009767657894216024 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1951742172241211 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2010306417942047 seconds
Avg batch val. time: 0.020103064179420472 seconds
Avg sample val. time: 0.0003146019433399135 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 277.190312 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 254.266022 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7829623222351074 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8673788400796743 seconds
Avg batch train. time: 0.06224596133598914 seconds
Avg sample train. time: 0.0009730999687752341 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 223.537196 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9856016635894775 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8758233274732317 seconds
Avg batch train. time: 0.06252744424910772 seconds
Avg sample train. time: 0.000977500431200225 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20800256729125977 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20180530018276638 seconds
Avg batch val. time: 0.02018053001827664 seconds
Avg sample val. time: 0.0003158142412875843 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 208.761737 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 194.781980 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8216474056243896 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8722115993499755 seconds
Avg batch train. time: 0.06240705331166585 seconds
Avg sample train. time: 0.0009756183425481894 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 166.504164 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.954176902770996 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8773344308137894 seconds
Avg batch train. time: 0.06257781436045964 seconds
Avg sample train. time: 0.0009782878743167219 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1949005126953125 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20111482143402098 seconds
Avg batch val. time: 0.0201114821434021 seconds
Avg sample val. time: 0.00031473367986544756 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 151.315128 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 140.063236 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7965149879455566 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8725803459391874 seconds
Avg batch train. time: 0.062419344864639584 seconds
Avg sample train. time: 0.0009758104981444437 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 115.072412 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7089879512786865 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8634918795691595 seconds
Avg batch train. time: 0.06211639598563865 seconds
Avg sample train. time: 0.0009710744552210315 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19800734519958496 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20083232359452682 seconds
Avg batch val. time: 0.020083232359452682 seconds
Avg sample val. time: 0.00031429158621991676 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 101.261059 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 91.856738 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7474358081817627 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8573836652856124 seconds
Avg batch train. time: 0.06191278884285375 seconds
Avg sample train. time: 0.0009678914357923983 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 70.405134 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9680061340332031 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.862914788722992 seconds
Avg batch train. time: 0.062097159624099736 seconds
Avg sample train. time: 0.0009707737304444982 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17062640190124512 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19831516345342 seconds
Avg batch val. time: 0.019831516345342002 seconds
Avg sample val. time: 0.0003103523684717058 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 59.736477 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 52.066473 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7632455825805664 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.858168636049543 seconds
Avg batch train. time: 0.06193895453498477 seconds
Avg sample train. time: 0.0009683004877798557 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 36.237024 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7389423847198486 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8527492609891025 seconds
Avg batch train. time: 0.06175830869963675 seconds
Avg sample train. time: 0.0009654764257368955 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18500351905822754 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19729119080763596 seconds
Avg batch val. time: 0.019729119080763597 seconds
Avg sample val. time: 0.00030874990736719243 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 28.796980 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 23.677537 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7357826232910156 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.847663755002229 seconds
Avg batch train. time: 0.06158879183340763 seconds
Avg sample train. time: 0.0009628263444513961 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 14.756212 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7071623802185059 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8418095310529072 seconds
Avg batch train. time: 0.061393651035096905 seconds
Avg sample train. time: 0.0009597756805903633 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19700050354003906 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19727042743137904 seconds
Avg batch val. time: 0.019727042743137906 seconds
Avg sample val. time: 0.0003087174138206245 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 13.178008 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 8.553576 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7289819717407227 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8372964286804199 seconds
Avg batch train. time: 0.06124321428934733 seconds
Avg sample train. time: 0.0009574238815426888 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 5.060868 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7269182205200195 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.833051112981943 seconds
Avg batch train. time: 0.06110170376606476 seconds
Avg sample train. time: 0.0009552116274006998 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18805646896362305 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19665616353352863 seconds
Avg batch val. time: 0.019665616353352865 seconds
Avg sample val. time: 0.000307756124465616 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 4.309551 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 3.539032 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8789253234863281 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8347501578154388 seconds
Avg batch train. time: 0.06115833859384796 seconds
Avg sample train. time: 0.0009560970077203954 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 3.028021 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8614866733551025 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8357050333704268 seconds
Avg batch train. time: 0.061190167779014225 seconds
Avg sample train. time: 0.0009565945979001703 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22400164604187012 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1983652561903 seconds
Avg batch val. time: 0.019836525619029998 seconds
Avg sample val. time: 0.0003104307608611893 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 1.960918 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 2.559824 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0299477577209473 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8424030583480309 seconds
Avg batch train. time: 0.061413435278267696 seconds
Avg sample train. time: 0.0009600849704783902 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 2.151411 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9390740394592285 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8456254243850707 seconds
Avg batch train. time: 0.06152084747950236 seconds
Avg sample train. time: 0.0009617641607009228 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18000006675720215 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19728495092952952 seconds
Avg batch val. time: 0.019728495092952953 seconds
Avg sample val. time: 0.0003087401422997332 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 1.571162 | 
Best loss was 1.5711619596526096. Other metrics: OrderedDict([('epoch', 30), ('loss', 1.5711619596526096)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 2.6704344749450684 seconds

