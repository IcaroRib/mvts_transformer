Running:
main.py --output_dir experiments/belo_horizonte_83587/ --comment regression for belo_horizonte_83587 --name belo_horizonte_83587_Regression --records_file experiments/belo_horizonte_83587/belo_horizonte_83587_Regression.xls --data_dir datasets/files/belo_horizonte_83587/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
639 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21194815635681152 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21194815635681152 seconds
Avg batch val. time: 0.021194815635681152 seconds
Avg sample val. time: 0.00033168725564446247 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 439.018510 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 467.114712 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8999252319335938 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8999252319335938 seconds
Avg batch train. time: 0.06333084106445312 seconds
Avg sample train. time: 0.0009900600479070317 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18324613571166992 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19759714603424072 seconds
Avg batch val. time: 0.019759714603424072 seconds
Avg sample val. time: 0.00030922871053871786 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 452.822639 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 439.453201 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8631904125213623 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.881557822227478 seconds
Avg batch train. time: 0.06271859407424926 seconds
Avg sample train. time: 0.0009804887036099416 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2059931755065918 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20039582252502441 seconds
Avg batch val. time: 0.020039582252502443 seconds
Avg sample val. time: 0.00031360848595465477 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 425.270292 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 393.233994 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9086921215057373 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8906025886535645 seconds
Avg batch train. time: 0.06302008628845215 seconds
Avg sample train. time: 0.0009852019742853384 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 327.983559 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8502013683319092 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8805022835731506 seconds
Avg batch train. time: 0.06268340945243836 seconds
Avg sample train. time: 0.0009799386574117512 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22051644325256348 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20542597770690918 seconds
Avg batch val. time: 0.020542597770690917 seconds
Avg sample val. time: 0.00032148040329719747 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 286.558698 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 246.828563 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2780439853668213 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9600106239318849 seconds
Avg batch train. time: 0.06533368746439616 seconds
Avg sample train. time: 0.0010213708306054637 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 165.540845 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2175192832946777 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0029287338256836 seconds
Avg batch train. time: 0.06676429112752279 seconds
Avg sample train. time: 0.0010437356611910805 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24100565910339355 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21254191398620606 seconds
Avg batch val. time: 0.021254191398620607 seconds
Avg sample val. time: 0.00033261645381252905 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 114.721750 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 93.245608 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.19464111328125 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0303162166050504 seconds
Avg batch train. time: 0.06767720722016835 seconds
Avg sample train. time: 0.0010580074083403077 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 37.124177 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1288347244262695 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0426310300827026 seconds
Avg batch train. time: 0.06808770100275675 seconds
Avg sample train. time: 0.0010644247160410123 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.26699113845825195 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22161678473154703 seconds
Avg batch val. time: 0.022161678473154704 seconds
Avg sample val. time: 0.00034681812947033965 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 15.238903 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 9.023585 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.206200361251831 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.060805400212606 seconds
Avg batch train. time: 0.0686935133404202 seconds
Avg sample train. time: 0.0010738954664995342 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 3.640205 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2117927074432373 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.075904130935669 seconds
Avg batch train. time: 0.0691968043645223 seconds
Avg sample train. time: 0.0010817634866783059 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2530536651611328 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2261077676500593 seconds
Avg batch val. time: 0.02261077676500593 seconds
Avg sample val. time: 0.00035384627175283145 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 2.180851 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 1.971109 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.329418897628784 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0989509279077705 seconds
Avg batch train. time: 0.06996503093025902 seconds
Avg sample train. time: 0.0010937732818696042 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 1.541529 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.3343567848205566 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1185680826505027 seconds
Avg batch train. time: 0.07061893608835008 seconds
Avg sample train. time: 0.0011039958742316324 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2709977626800537 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2317190170288086 seconds
Avg batch val. time: 0.02317190170288086 seconds
Avg sample val. time: 0.00036262756968514646 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.566636 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 1.176600 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.356107234954834 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1368403251354513 seconds
Avg batch train. time: 0.07122801083784838 seconds
Avg sample train. time: 0.0011135176264384843 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.961085 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.227757453918457 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1433344057628085 seconds
Avg batch train. time: 0.07144448019209362 seconds
Avg sample train. time: 0.0011169017226486757 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24636125564575195 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23334593243069118 seconds
Avg batch val. time: 0.023334593243069118 seconds
Avg sample val. time: 0.0003651736031779205 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 1.475833 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.934353 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.078948497772217 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1390420118967692 seconds
Avg batch train. time: 0.07130140039655898 seconds
Avg sample train. time: 0.0011146649358503226 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.730522 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0673367977142334 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1345604360103607 seconds
Avg batch train. time: 0.07115201453367868 seconds
Avg sample train. time: 0.0011123295654040441 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22912049293518066 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23292338848114014 seconds
Avg batch val. time: 0.023292338848114012 seconds
Avg sample val. time: 0.0003645123450409079 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 1.031353 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.679866 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0602052211761475 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1301865998436424 seconds
Avg batch train. time: 0.07100621999478808 seconds
Avg sample train. time: 0.0011100503386366036 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.628713 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.060251235961914 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.126301301850213 seconds
Avg batch train. time: 0.07087671006167377 seconds
Avg sample train. time: 0.001108025691427938 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24625444412231445 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2341353026303378 seconds
Avg batch val. time: 0.02341353026303378 seconds
Avg sample val. time: 0.000366408924304128 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.284726 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.583342 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1546828746795654 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1277950688412317 seconds
Avg batch train. time: 0.07092650229470772 seconds
Avg sample train. time: 0.0011088041004904802 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.548312 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0534417629241943 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1240774035453795 seconds
Avg batch train. time: 0.07080258011817932 seconds
Avg sample train. time: 0.0011068668074754452 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22572898864746094 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23343477646509805 seconds
Avg batch val. time: 0.023343477646509805 seconds
Avg sample val. time: 0.00036531263922550555 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.765105 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.476540 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0777177810668945 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1218698024749756 seconds
Avg batch train. time: 0.07072899341583253 seconds
Avg sample train. time: 0.0011057164160890962 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.537643 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0754148960113525 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.119758215817538 seconds
Avg batch train. time: 0.07065860719391794 seconds
Avg sample train. time: 0.0011046160582686493 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21805715560913086 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23225188255310059 seconds
Avg batch val. time: 0.02322518825531006 seconds
Avg sample val. time: 0.00036346147504397587 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 0.346901 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.601087 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.073275089263916 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1177372103152066 seconds
Avg batch train. time: 0.07059124034384022 seconds
Avg sample train. time: 0.0011035629027176688 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.432078 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9982953071594238 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1127604643503823 seconds
Avg batch train. time: 0.07042534881167942 seconds
Avg sample train. time: 0.001100969496795405 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22700142860412598 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23187685012817383 seconds
Avg batch val. time: 0.023187685012817382 seconds
Avg sample val. time: 0.0003628745698406476 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 1.084177 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.439366 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.080347776412964 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.111463956832886 seconds
Avg batch train. time: 0.07038213189442953 seconds
Avg sample train. time: 0.0011002938805799302 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.452929 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9238286018371582 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.104247212409973 seconds
Avg batch train. time: 0.0701415737469991 seconds
Avg sample train. time: 0.0010965332008389646 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24299836158752441 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23261828422546388 seconds
Avg batch val. time: 0.02326182842254639 seconds
Avg sample val. time: 0.00036403487359227524 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 0.920586 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.403111 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8947925567626953 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0964896325711853 seconds
Avg batch train. time: 0.06988298775237284 seconds
Avg sample train. time: 0.0010924906891981163 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.412598 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8959870338439941 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0893288254737854 seconds
Avg batch train. time: 0.06964429418245952 seconds
Avg sample train. time: 0.0010887591586627335 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19900989532470703 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23051775991916656 seconds
Avg batch val. time: 0.023051775991916656 seconds
Avg sample val. time: 0.000360747668105112 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 0.484221 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.385307 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9510180950164795 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0845594899407747 seconds
Avg batch train. time: 0.06948531633135915 seconds
Avg sample train. time: 0.001086273835300039 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.449309 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0724174976348877 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.084154756863912 seconds
Avg batch train. time: 0.06947182522879707 seconds
Avg sample train. time: 0.00108606292697442 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20600533485412598 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22907585256239948 seconds
Avg batch val. time: 0.022907585256239947 seconds
Avg sample val. time: 0.0003584911620694828 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 0.865238 | 
Best loss was 0.2847262727262828. Other metrics: OrderedDict([('epoch', 18), ('loss', 0.2847262727262828)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 10.414057970046997 seconds

