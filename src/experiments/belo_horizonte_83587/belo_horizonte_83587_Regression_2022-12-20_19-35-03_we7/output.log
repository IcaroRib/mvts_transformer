Running:
main.py --output_dir experiments/belo_horizonte_83587/ --comment regression for belo_horizonte_83587 --name belo_horizonte_83587_Regression --records_file experiments/belo_horizonte_83587/belo_horizonte_83587_Regression.xls --data_dir datasets/files/belo_horizonte_83587/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
639 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20408177375793457 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20408177375793457 seconds
Avg batch val. time: 0.02040817737579346 seconds
Avg sample val. time: 0.0003193767977432466 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 295.591620 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 435.203042 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.825190544128418 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.825190544128418 seconds
Avg batch train. time: 0.0608396848042806 seconds
Avg sample train. time: 0.0009511154476958926 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19889450073242188 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20148813724517822 seconds
Avg batch val. time: 0.020148813724517822 seconds
Avg sample val. time: 0.00031531789866225075 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 414.765747 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 373.488928 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9757695198059082 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.900480031967163 seconds
Avg batch train. time: 0.06334933439890543 seconds
Avg sample train. time: 0.000990349156835416 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20186209678649902 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2016127904256185 seconds
Avg batch val. time: 0.02016127904256185 seconds
Avg sample val. time: 0.00031551297406200076 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 328.910792 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 272.557805 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7906761169433594 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8638787269592285 seconds
Avg batch train. time: 0.06212929089864095 seconds
Avg sample train. time: 0.0009712760432304474 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 151.267709 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.880248785018921 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8679712414741516 seconds
Avg batch train. time: 0.062265708049138384 seconds
Avg sample train. time: 0.0009734086719510952 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19408202171325684 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19973009824752808 seconds
Avg batch val. time: 0.019973009824752808 seconds
Avg sample val. time: 0.0003125666639241441 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 65.906896 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 51.979849 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.838019847869873 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.861980962753296 seconds
Avg batch train. time: 0.06206603209177653 seconds
Avg sample train. time: 0.0009702871093034372 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 5.349285 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.800159215927124 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8516773382822673 seconds
Avg batch train. time: 0.061722577942742246 seconds
Avg sample train. time: 0.0009649178417312493 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2001659870147705 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19981727600097657 seconds
Avg batch val. time: 0.019981727600097657 seconds
Avg sample val. time: 0.00031270309233329667 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 3.519720 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 1.697281 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7858986854553223 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.842280387878418 seconds
Avg batch train. time: 0.061409346262613934 seconds
Avg sample train. time: 0.000960021046314965 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 1.132505 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.830409288406372 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8407965004444122 seconds
Avg batch train. time: 0.06135988334814708 seconds
Avg sample train. time: 0.0009592477855364316 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1935107707977295 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1987661918004354 seconds
Avg batch val. time: 0.01987661918004354 seconds
Avg sample val. time: 0.00031105820313057184 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 0.885116 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.861234 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8105943202972412 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8374407026502821 seconds
Avg batch train. time: 0.061248023421676075 seconds
Avg sample train. time: 0.0009574990633925389 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.780050 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7860403060913086 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8323006629943848 seconds
Avg batch train. time: 0.061076688766479495 seconds
Avg sample train. time: 0.0009548205643535096 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20800089836120605 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2000854355948312 seconds
Avg batch val. time: 0.02000854355948312 seconds
Avg sample val. time: 0.0003131227474097515 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.574666 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.644256 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.935744285583496 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.841704628684304 seconds
Avg batch train. time: 0.0613901542894768 seconds
Avg sample train. time: 0.0009597210154686316 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.593397 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.786170482635498 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8370767831802368 seconds
Avg batch train. time: 0.06123589277267456 seconds
Avg sample train. time: 0.0009573094232309728 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18556690216064453 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19827061891555786 seconds
Avg batch val. time: 0.019827061891555788 seconds
Avg sample val. time: 0.0003102826587097932 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.888482 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.520849 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8158798217773438 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8354462476877065 seconds
Avg batch train. time: 0.061181541589590216 seconds
Avg sample train. time: 0.0009564597434537292 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.572634 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7984497547149658 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8328036410467965 seconds
Avg batch train. time: 0.061093454701559885 seconds
Avg sample train. time: 0.00095508266860177 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19698834419250488 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19812814394632974 seconds
Avg batch val. time: 0.019812814394632974 seconds
Avg sample val. time: 0.0003100596931867445 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.549759 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.595016 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7001867294311523 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8239625136057536 seconds
Avg batch train. time: 0.06079875045352512 seconds
Avg sample train. time: 0.0009504755151671462 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.513670 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6424100399017334 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8126154839992523 seconds
Avg batch train. time: 0.06042051613330841 seconds
Avg sample train. time: 0.0009445625242309809 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19100046157836914 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19741537570953369 seconds
Avg batch val. time: 0.019741537570953368 seconds
Avg sample val. time: 0.00030894424993667245 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.264516 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.511089 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7559030055999756 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8092794558581184 seconds
Avg batch train. time: 0.060309315195270614 seconds
Avg sample train. time: 0.0009428241041470133 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.427726 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9496936798095703 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8170802460776434 seconds
Avg batch train. time: 0.060569341535921445 seconds
Avg sample train. time: 0.0009468891329221696 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23984861373901367 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20127294280312277 seconds
Avg batch val. time: 0.020127294280312277 seconds
Avg sample val. time: 0.000314981131147297 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.705547 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.503338 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.998427391052246 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.826624832655254 seconds
Avg batch train. time: 0.060887494421841805 seconds
Avg sample train. time: 0.0009518628622486993 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.424081 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8183612823486328 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.826211655139923 seconds
Avg batch train. time: 0.060873721837997434 seconds
Avg sample train. time: 0.0009516475534861506 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1874246597290039 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20011891921361288 seconds
Avg batch val. time: 0.02001189192136129 seconds
Avg sample val. time: 0.0003131751474391438 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.751849 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.402972 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6518921852111816 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8179107280004592 seconds
Avg batch train. time: 0.060597024266681974 seconds
Avg sample train. time: 0.0009473219009903383 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.378123 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8173608779907227 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8178857348181985 seconds
Avg batch train. time: 0.06059619116060662 seconds
Avg sample train. time: 0.0009473088769245433 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23499345779418945 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20280157602750337 seconds
Avg batch val. time: 0.020280157602750336 seconds
Avg sample val. time: 0.00031737335841549826 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 0.762159 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.380448 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9801950454711914 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8249426613683286 seconds
Avg batch train. time: 0.060831422045610956 seconds
Avg sample train. time: 0.0009509862748141369 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.378331 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8062152862548828 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.824162354071935 seconds
Avg batch train. time: 0.06080541180239783 seconds
Avg sample train. time: 0.0009505796529817274 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20199131965637207 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20274370057242258 seconds
Avg batch val. time: 0.02027437005724226 seconds
Avg sample val. time: 0.0003172827864983139 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 0.140220 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.468025 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8446335792541504 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8249812030792236 seconds
Avg batch train. time: 0.06083270676930745 seconds
Avg sample train. time: 0.0009510063590824511 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.432268 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0511903762817383 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.833681555894705 seconds
Avg batch train. time: 0.061122718529823504 seconds
Avg sample train. time: 0.0009555401541921339 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2565462589263916 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2063305377960205 seconds
Avg batch val. time: 0.02063305377960205 seconds
Avg sample val. time: 0.0003228959902911119 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 1.478060 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.360959 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0392260551452637 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8412943151262071 seconds
Avg batch train. time: 0.06137647717087357 seconds
Avg sample train. time: 0.0009595071991277786 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.608831 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1611380577087402 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8527173059327262 seconds
Avg batch train. time: 0.061757243531090876 seconds
Avg sample train. time: 0.0009654597738054853 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.27085280418395996 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21036317944526672 seconds
Avg batch val. time: 0.02103631794452667 seconds
Avg sample val. time: 0.0003292068535919667 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 0.700895 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.441698 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.900641679763794 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8543698705475906 seconds
Avg batch train. time: 0.06181232901825302 seconds
Avg sample train. time: 0.0009663209330628403 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.418415 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0356900691986084 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.860413877169291 seconds
Avg batch train. time: 0.062013795905643036 seconds
Avg sample train. time: 0.0009694704935744092 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2340097427368164 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21175415375653436 seconds
Avg batch val. time: 0.021175415375653435 seconds
Avg sample val. time: 0.00033138365220114924 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 0.576771 | 
Best loss was 0.14021972871162522. Other metrics: OrderedDict([('epoch', 24), ('loss', 0.14021972871162522)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 3.353086471557617 seconds

