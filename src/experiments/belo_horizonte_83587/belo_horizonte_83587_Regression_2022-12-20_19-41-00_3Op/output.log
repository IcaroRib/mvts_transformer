Running:
main.py --output_dir experiments/belo_horizonte_83587/ --comment regression for belo_horizonte_83587 --name belo_horizonte_83587_Regression --records_file experiments/belo_horizonte_83587/belo_horizonte_83587_Regression.xls --data_dir datasets/files/belo_horizonte_83587/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0025 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
639 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21699833869934082 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21699833869934082 seconds
Avg batch val. time: 0.02169983386993408 seconds
Avg sample val. time: 0.0003395905143964645 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 538.259784 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 435.940786 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7215561866760254 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7215561866760254 seconds
Avg batch train. time: 0.05738520622253418 seconds
Avg sample train. time: 0.0008971110925878194 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1959998607635498 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2064990997314453 seconds
Avg batch val. time: 0.02064990997314453 seconds
Avg sample val. time: 0.0003231597804873949 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 389.912546 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 274.859316 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.059556484222412 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8905563354492188 seconds
Avg batch train. time: 0.06301854451497396 seconds
Avg sample train. time: 0.0009851778715212187 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2539949417114258 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22233104705810547 seconds
Avg batch val. time: 0.022233104705810545 seconds
Avg sample val. time: 0.0003479359108890539 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 95.170776 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 69.930128 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.3410422801971436 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0407183170318604 seconds
Avg batch train. time: 0.068023943901062 seconds
Avg sample train. time: 0.0010634279922000314 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 3.596244 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.011869192123413 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0335060358047485 seconds
Avg batch train. time: 0.06778353452682495 seconds
Avg sample train. time: 0.0010596696382515626 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2536318302154541 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23015624284744263 seconds
Avg batch val. time: 0.02301562428474426 seconds
Avg sample val. time: 0.0003601819136892686 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 3.341710 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.274942 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.234516143798828 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0737080574035645 seconds
Avg batch train. time: 0.06912360191345215 seconds
Avg sample train. time: 0.0010806191023468288 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.782133 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9381992816925049 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.051123261451721 seconds
Avg batch train. time: 0.06837077538172404 seconds
Avg sample train. time: 0.0010688500580780204 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22404146194458008 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22893328666687013 seconds
Avg batch val. time: 0.022893328666687012 seconds
Avg sample val. time: 0.00035826805425175296 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 0.345853 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.651522 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0802829265594482 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.055288927895682 seconds
Avg batch train. time: 0.06850963092985607 seconds
Avg sample train. time: 0.00107102080661578 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.679212 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1030526161193848 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.061259388923645 seconds
Avg batch train. time: 0.06870864629745484 seconds
Avg sample train. time: 0.0010741320421696952 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2480006217956543 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23211117585500082 seconds
Avg batch val. time: 0.023211117585500082 seconds
Avg sample val. time: 0.0003632412767683894 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 0.870127 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.623042 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8753740787506104 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0406054655710855 seconds
Avg batch train. time: 0.06802018218570285 seconds
Avg sample train. time: 0.001063369184768674 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.509710 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.857053279876709 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.022250247001648 seconds
Avg batch train. time: 0.06740834156672161 seconds
Avg sample train. time: 0.0010538041933307182 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17951083183288574 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22459684099469865 seconds
Avg batch val. time: 0.022459684099469863 seconds
Avg sample val. time: 0.00035148175429530304 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 1.718963 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.514672 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7792668342590332 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0001608458432285 seconds
Avg batch train. time: 0.06667202819477429 seconds
Avg sample train. time: 0.0010422933016379513 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.506774 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7799973487854004 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9818138877550762 seconds
Avg batch train. time: 0.0660604629251692 seconds
Avg sample train. time: 0.0010327326147759647 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18800091743469238 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22002235054969788 seconds
Avg batch val. time: 0.022002235054969788 seconds
Avg sample val. time: 0.0003443229273078214 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.146392 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.757891 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7765898704528809 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9660274248856764 seconds
Avg batch train. time: 0.06553424749618922 seconds
Avg sample train. time: 0.0010245062141144743 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.469351 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.718437671661377 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9483424425125122 seconds
Avg batch train. time: 0.0649447480837504 seconds
Avg sample train. time: 0.0010152904859366922 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1860034465789795 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21624247233072916 seconds
Avg batch val. time: 0.021624247233072914 seconds
Avg sample val. time: 0.00033840762493071854 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 1.097293 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.498085 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7820465564727783 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9372560501098632 seconds
Avg batch train. time: 0.06457520167032878 seconds
Avg sample train. time: 0.0010095133142834097 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.400798 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6981201171875 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9223100543022156 seconds
Avg batch train. time: 0.06407700181007385 seconds
Avg sample train. time: 0.001001724884993338 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1889967918395996 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2135179042816162 seconds
Avg batch val. time: 0.02135179042816162 seconds
Avg sample val. time: 0.00033414382516684855 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.133924 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.472319 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9718472957611084 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9252240096821505 seconds
Avg batch train. time: 0.06417413365607168 seconds
Avg sample train. time: 0.0010032433609599534 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.526013 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0031802654266357 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9295549127790663 seconds
Avg batch train. time: 0.06431849709263554 seconds
Avg sample train. time: 0.0010055002151011288 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21715021133422852 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21384811401367188 seconds
Avg batch val. time: 0.021384811401367186 seconds
Avg sample val. time: 0.0003346605853109106 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 1.618785 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.450764 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.040773630142212 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9354085294823897 seconds
Avg batch train. time: 0.06451361764941299 seconds
Avg sample train. time: 0.0010085505625233922 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.547952 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9632351398468018 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9367998600006104 seconds
Avg batch train. time: 0.06455999533335369 seconds
Avg sample train. time: 0.0010092755914542003 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25052356719970703 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2169044017791748 seconds
Avg batch val. time: 0.02169044017791748 seconds
Avg sample val. time: 0.0003394435082616194 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.085424 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.558277 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8745970726013184 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.933837822505406 seconds
Avg batch train. time: 0.0644612607501802 seconds
Avg sample train. time: 0.00100773205966931 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.513967 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7565951347351074 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.925781336697665 seconds
Avg batch train. time: 0.0641927112232555 seconds
Avg sample train. time: 0.0010035337867106123 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2180020809173584 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21698883863595816 seconds
Avg batch val. time: 0.021698883863595815 seconds
Avg sample val. time: 0.0003395756473176184 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 0.661885 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.623906 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.827519178390503 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.92150906894518 seconds
Avg batch train. time: 0.06405030229817267 seconds
Avg sample train. time: 0.0010013074877254717 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.690936 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8102855682373047 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.916874756415685 seconds
Avg batch train. time: 0.06389582521385616 seconds
Avg sample train. time: 0.0009988925254901953 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24501609802246094 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21899078573499406 seconds
Avg batch val. time: 0.021899078573499407 seconds
Avg sample val. time: 0.0003427085848747951 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 1.453973 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.504597 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1185052394866943 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9249399757385255 seconds
Avg batch train. time: 0.06416466585795084 seconds
Avg sample train. time: 0.0010030953495250264 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.601208 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.15234375 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9336862747485821 seconds
Avg batch train. time: 0.06445620915828607 seconds
Avg sample train. time: 0.0010076530874145817 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2500026226043701 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2210582415262858 seconds
Avg batch val. time: 0.02210582415262858 seconds
Avg sample val. time: 0.00034594403994723914 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 0.476570 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.499252 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9950525760650635 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9359591007232666 seconds
Avg batch train. time: 0.06453197002410889 seconds
Avg sample train. time: 0.0010088374678078513 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.482311 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9575424194335938 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9367299335343497 seconds
Avg batch train. time: 0.064557664451145 seconds
Avg sample train. time: 0.0010092391524410369 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23108863830566406 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22168514132499695 seconds
Avg batch val. time: 0.022168514132499696 seconds
Avg sample val. time: 0.0003469251037949874 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 2.022315 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.430583 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.166626214981079 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9446573915152714 seconds
Avg batch train. time: 0.06482191305050905 seconds
Avg sample train. time: 0.0010133701883873222 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.447913 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.241086959838867 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.954538377126058 seconds
Avg batch train. time: 0.06515127923753526 seconds
Avg sample train. time: 0.001018519216845262 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.274334192276001 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22478214432211482 seconds
Avg batch val. time: 0.02247821443221148 seconds
Avg sample val. time: 0.00035177174385307486 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 4.201104 | 
Best loss was 0.08542369602245158. Other metrics: OrderedDict([('epoch', 20), ('loss', 0.08542369602245158)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 6.464720964431763 seconds

