Running:
main.py --output_dir experiments/belo_horizonte_83587/ --comment regression for belo_horizonte_83587 --name belo_horizonte_83587_Regression --records_file experiments/belo_horizonte_83587/belo_horizonte_83587_Regression.xls --data_dir datasets/files/belo_horizonte_83587/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
639 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20291924476623535 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20291924476623535 seconds
Avg batch val. time: 0.020291924476623535 seconds
Avg sample val. time: 0.0003175575035465342 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 458.920497 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 378.472065 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9272534847259521 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9272534847259521 seconds
Avg batch train. time: 0.0642417828241984 seconds
Avg sample train. time: 0.0010043009300291568 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2570013999938965 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22996032238006592 seconds
Avg batch val. time: 0.022996032238006593 seconds
Avg sample val. time: 0.00035987530888899203 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 221.004021 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 110.618567 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9517247676849365 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9394891262054443 seconds
Avg batch train. time: 0.06464963754018148 seconds
Avg sample train. time: 0.0010106769808261825 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22356200218200684 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2278275489807129 seconds
Avg batch val. time: 0.02278275489807129 seconds
Avg sample val. time: 0.00035653763533757886 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 4.817411 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 3.450500 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1710336208343506 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0166706244150796 seconds
Avg batch train. time: 0.06722235414716932 seconds
Avg sample train. time: 0.0010508966255419903 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.349851 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8896231651306152 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9849087595939636 seconds
Avg batch train. time: 0.06616362531979879 seconds
Avg sample train. time: 0.0010343453671672557 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2239999771118164 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22687065601348877 seconds
Avg batch val. time: 0.022687065601348876 seconds
Avg sample val. time: 0.000355040150255851 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 2.252008 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 0.785420 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.025740385055542 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9930750846862793 seconds
Avg batch train. time: 0.06643583615620931 seconds
Avg sample train. time: 0.001038600877898009 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.698145 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9353201389312744 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9834492603937786 seconds
Avg batch train. time: 0.06611497534645928 seconds
Avg sample train. time: 0.0010335848152130164 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23099946975708008 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22769641876220703 seconds
Avg batch val. time: 0.022769641876220704 seconds
Avg sample val. time: 0.00035633242372802354 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 1.676231 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.872450 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9259440898895264 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9752342360360282 seconds
Avg batch train. time: 0.06584114120120094 seconds
Avg sample train. time: 0.0010293039270641107 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.842879 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0031094551086426 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.978718638420105 seconds
Avg batch train. time: 0.06595728794733684 seconds
Avg sample train. time: 0.0010311196656696744 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2355189323425293 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22900017102559408 seconds
Avg batch val. time: 0.022900017102559407 seconds
Avg sample val. time: 0.0003583727246096934 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 2.708495 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.830128 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.913996934890747 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.971527338027954 seconds
Avg batch train. time: 0.06571757793426514 seconds
Avg sample train. time: 0.0010273722449337958 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.531114 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0044796466827393 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9748225688934327 seconds
Avg batch train. time: 0.06582741896311442 seconds
Avg sample train. time: 0.0010290894053639566 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2670018672943115 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23442898477826798 seconds
Avg batch val. time: 0.0234428984778268 seconds
Avg sample val. time: 0.0003668685207797621 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 2.253986 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 1.302605 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0724785327911377 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9837003837932239 seconds
Avg batch train. time: 0.0661233461264408 seconds
Avg sample train. time: 0.0010337156768073078 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.633653 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0071184635162354 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9856518904368083 seconds
Avg batch train. time: 0.06618839634789361 seconds
Avg sample train. time: 0.001034732616173428 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23415875434875488 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23439520597457886 seconds
Avg batch val. time: 0.023439520597457887 seconds
Avg sample val. time: 0.00036681565880215784 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.928247 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.624950 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.901021957397461 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9791418955876277 seconds
Avg batch train. time: 0.06597139651958758 seconds
Avg sample train. time: 0.0010313402269867783 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.635463 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9182677268981934 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9747937406812395 seconds
Avg batch train. time: 0.06582645802270798 seconds
Avg sample train. time: 0.0010290743828458779 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25600242614746094 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2367960082160102 seconds
Avg batch val. time: 0.023679600821601022 seconds
Avg sample val. time: 0.0003705727828106576 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 1.552949 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.678441 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.991072654724121 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9758790016174317 seconds
Avg batch train. time: 0.06586263338724772 seconds
Avg sample train. time: 0.0010296399174660926 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.602179 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.108126163482666 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9841444492340088 seconds
Avg batch train. time: 0.06613814830780029 seconds
Avg sample train. time: 0.0010339470814142828 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21799826622009277 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23491623401641845 seconds
Avg batch val. time: 0.023491623401641844 seconds
Avg sample val. time: 0.00036763103914932467 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 4.294296 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.959024 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.881392240524292 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.978100201662849 seconds
Avg batch train. time: 0.06593667338876164 seconds
Avg sample train. time: 0.0010307973953428084 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.766499 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.05910062789917 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9826002253426447 seconds
Avg batch train. time: 0.06608667417808815 seconds
Avg sample train. time: 0.0010331423790217013 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23699593544006348 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23510529778220438 seconds
Avg batch val. time: 0.023510529778220438 seconds
Avg sample val. time: 0.0003679269135871743 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 3.167236 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.610605 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.902170181274414 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9783670651285272 seconds
Avg batch train. time: 0.06594556883761757 seconds
Avg sample train. time: 0.001030936459160254 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.606237 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.974066972732544 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.978152060508728 seconds
Avg batch train. time: 0.0659384020169576 seconds
Avg sample train. time: 0.001030824419233313 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22951674461364746 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23463958501815796 seconds
Avg batch val. time: 0.023463958501815797 seconds
Avg sample val. time: 0.0003671980986199655 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.852008 | 
Best loss was 0.8520076375612071. Other metrics: OrderedDict([('epoch', 20), ('loss', 0.8520076375612071)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 46.37301564216614 seconds

