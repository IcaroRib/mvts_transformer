Running:
main.py --output_dir experiments/belo_horizonte_83587/ --comment regression for belo_horizonte_83587 --name belo_horizonte_83587_Regression --records_file experiments/belo_horizonte_83587/belo_horizonte_83587_Regression.xls --data_dir datasets/files/belo_horizonte_83587/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
639 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18300819396972656 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18300819396972656 seconds
Avg batch val. time: 0.018300819396972656 seconds
Avg sample val. time: 0.0002863977996396347 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 454.971305 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 383.413672 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7006494998931885 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7006494998931885 seconds
Avg batch train. time: 0.05668831666310628 seconds
Avg sample train. time: 0.0008862165189646631 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18268752098083496 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18284785747528076 seconds
Avg batch val. time: 0.018284785747528075 seconds
Avg sample val. time: 0.00028614688180795113 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 234.296858 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 112.250271 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7424507141113281 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7215501070022583 seconds
Avg batch train. time: 0.05738500356674194 seconds
Avg sample train. time: 0.0008971079244409892 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19369053840637207 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1864620844523112 seconds
Avg batch val. time: 0.01864620844523112 seconds
Avg sample val. time: 0.00029180294906464975 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 12.982112 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 3.092323 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7933032512664795 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7454678217569988 seconds
Avg batch train. time: 0.05818226072523329 seconds
Avg sample train. time: 0.0009095715590187591 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.151543 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7277212142944336 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7410311698913574 seconds
Avg batch train. time: 0.05803437232971191 seconds
Avg sample train. time: 0.0009072595986927345 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18500185012817383 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18609702587127686 seconds
Avg batch val. time: 0.018609702587127686 seconds
Avg sample val. time: 0.00029123165238071496 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 1.369393 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.180872 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.788724660873413 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7505698680877686 seconds
Avg batch train. time: 0.058352328936258954 seconds
Avg sample train. time: 0.0009122302595558981 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.794388 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.867018461227417 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7699779669443767 seconds
Avg batch train. time: 0.05899926556481256 seconds
Avg sample train. time: 0.0009223439119043131 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.189009428024292 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18667950630187988 seconds
Avg batch val. time: 0.018667950630187988 seconds
Avg sample val. time: 0.00029214320235035975 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 1.131777 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.860057 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8059797286987305 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.775121075766427 seconds
Avg batch train. time: 0.05917070252554757 seconds
Avg sample train. time: 0.0009250240103003789 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 1.356794 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9170053005218506 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.792856603860855 seconds
Avg batch train. time: 0.05976188679536184 seconds
Avg sample train. time: 0.0009342660780932023 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24800348281860352 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19690016905466715 seconds
Avg batch val. time: 0.019690016905466713 seconds
Avg sample val. time: 0.00030813797974126316 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 0.808354 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.831657 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7265067100524902 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7854843934377034 seconds
Avg batch train. time: 0.05951614644792345 seconds
Avg sample train. time: 0.0009304243842822842 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.815042 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7595915794372559 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7828951120376586 seconds
Avg batch train. time: 0.05942983706792195 seconds
Avg sample train. time: 0.0009290750974662108 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19500136375427246 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19662891115461076 seconds
Avg batch val. time: 0.019662891115461077 seconds
Avg sample val. time: 0.00030771347598530633 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 3.272516 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.738749 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7186546325683594 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7770550684495405 seconds
Avg batch train. time: 0.05923516894831802 seconds
Avg sample train. time: 0.0009260318230586454 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.732126 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.768052339553833 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.776304841041565 seconds
Avg batch train. time: 0.05921016136805216 seconds
Avg sample train. time: 0.000925640875998731 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2180004119873047 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1993003487586975 seconds
Avg batch val. time: 0.01993003487586975 seconds
Avg sample val. time: 0.00031189412951282864 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.120125 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.720284 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7261378765106201 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7724458437699537 seconds
Avg batch train. time: 0.059081528125665125 seconds
Avg sample train. time: 0.0009236299342209243 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.668496 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.693641185760498 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7668169396264213 seconds
Avg batch train. time: 0.05889389798754738 seconds
Avg sample train. time: 0.0009206966855791669 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19269061088562012 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19856593343946669 seconds
Avg batch val. time: 0.01985659334394667 seconds
Avg sample val. time: 0.0003107448097644236 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.241812 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 1.490008 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8610258102416992 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.773097531000773 seconds
Avg batch train. time: 0.0591032510333591 seconds
Avg sample train. time: 0.0009239695315272397 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.972066 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.788802146911621 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.774079069495201 seconds
Avg batch train. time: 0.05913596898317337 seconds
Avg sample train. time: 0.000924481015891194 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19999980926513672 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1987093210220337 seconds
Avg batch val. time: 0.01987093210220337 seconds
Avg sample val. time: 0.000310969203477361 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 2.039264 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.841388 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8293037414550781 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.777327579610488 seconds
Avg batch train. time: 0.05924425265368293 seconds
Avg sample train. time: 0.0009261738299168775 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.726882 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7218399047851562 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7742449310090807 seconds
Avg batch train. time: 0.059141497700302685 seconds
Avg sample train. time: 0.0009245674471126007 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21499967575073242 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20019026236100632 seconds
Avg batch val. time: 0.02001902623610063 seconds
Avg sample val. time: 0.0003132867955571304 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.418062 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.761119 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.000826597213745 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7861702818619578 seconds
Avg batch train. time: 0.05953900939539859 seconds
Avg sample train. time: 0.0009307818039926825 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.647703 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9305453300476074 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7933890342712402 seconds
Avg batch train. time: 0.059779634475708006 seconds
Avg sample train. time: 0.0009345435301048673 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2320082187652588 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20284175872802734 seconds
Avg batch val. time: 0.020284175872802734 seconds
Avg sample val. time: 0.00031743624214088784 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 8.735406 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.722411 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9228861331939697 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7995555627913702 seconds
Avg batch train. time: 0.059985185426379005 seconds
Avg sample train. time: 0.000937756937358713 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.727246 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0290257930755615 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.809986027804288 seconds
Avg batch train. time: 0.060332867593476266 seconds
Avg sample train. time: 0.000943192302138764 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2290325164794922 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20485643240121695 seconds
Avg batch val. time: 0.020485643240121695 seconds
Avg sample val. time: 0.0003205890960895414 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 1.610077 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.616996 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9135150909423828 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8144872914189878 seconds
Avg batch train. time: 0.06048290971396626 seconds
Avg sample train. time: 0.0009455379319536153 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.597065 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.17999005317688 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8297165731589 seconds
Avg batch train. time: 0.060990552438630004 seconds
Avg sample train. time: 0.0009534739828863471 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21899032592773438 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20586599622453963 seconds
Avg batch val. time: 0.020586599622453964 seconds
Avg sample val. time: 0.00032216900817611834 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 1.927416 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.805431 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9757459163665771 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.835557746887207 seconds
Avg batch train. time: 0.06118525822957357 seconds
Avg sample train. time: 0.0009565178462153242 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.768513 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0045464038848877 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.842057310617887 seconds
Avg batch train. time: 0.06140191035392957 seconds
Avg sample train. time: 0.0009599047996966582 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21399354934692383 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20640783309936522 seconds
Avg batch val. time: 0.020640783309936524 seconds
Avg sample val. time: 0.0003230169532071443 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 3.567391 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.668204 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.319016218185425 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8597224553426106 seconds
Avg batch train. time: 0.061990748511420356 seconds
Avg sample train. time: 0.0009691101903817669 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.696381 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.263864755630493 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8741561089243208 seconds
Avg batch train. time: 0.06247187029747736 seconds
Avg sample train. time: 0.0009766316357083485 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2570347785949707 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20957201719284058 seconds
Avg batch val. time: 0.020957201719284058 seconds
Avg sample val. time: 0.00032796872800131547 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 1.251920 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.850189 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.119598150253296 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8826196275908371 seconds
Avg batch train. time: 0.06275398758636123 seconds
Avg sample train. time: 0.0009810420154199256 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.811014 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.441480875015259 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9012483358383179 seconds
Avg batch train. time: 0.06337494452794393 seconds
Avg sample train. time: 0.0009907495236260125 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2880666255950928 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2141893470988554 seconds
Avg batch val. time: 0.02141893470988554 seconds
Avg sample val. time: 0.00033519459639883475 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 1.083448 | 
Best loss was 0.12012524671957527. Other metrics: OrderedDict([('epoch', 12), ('loss', 0.12012524671957527)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 4.55616569519043 seconds

