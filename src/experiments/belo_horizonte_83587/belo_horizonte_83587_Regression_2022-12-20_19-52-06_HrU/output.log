Running:
main.py --output_dir experiments/belo_horizonte_83587/ --comment regression for belo_horizonte_83587 --name belo_horizonte_83587_Regression --records_file experiments/belo_horizonte_83587/belo_horizonte_83587_Regression.xls --data_dir datasets/files/belo_horizonte_83587/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.01 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
639 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20199966430664062 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20199966430664062 seconds
Avg batch val. time: 0.020199966430664063 seconds
Avg sample val. time: 0.0003161184104955252 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 389.266184 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 297.991268 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.252307891845703 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.252307891845703 seconds
Avg batch train. time: 0.0750769297281901 seconds
Avg sample train. time: 0.0011736883230045352 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2516913414001465 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22684550285339355 seconds
Avg batch val. time: 0.022684550285339354 seconds
Avg sample val. time: 0.00035500078693801807 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 27.602700 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 14.990599 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.192211866378784 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.2222598791122437 seconds
Avg batch train. time: 0.07407532930374146 seconds
Avg sample train. time: 0.001158030161079856 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.26206421852111816 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2385850747426351 seconds
Avg batch val. time: 0.02385850747426351 seconds
Avg sample val. time: 0.0003733725739321363 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 4.537534 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 1.367382 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0897018909454346 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1780738830566406 seconds
Avg batch train. time: 0.07260246276855468 seconds
Avg sample train. time: 0.0011350046290029394 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.462983 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0512585639953613 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.146370053291321 seconds
Avg batch train. time: 0.07154566844304402 seconds
Avg sample train. time: 0.0011184836129709854 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24904274940490723 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24119949340820312 seconds
Avg batch val. time: 0.02411994934082031 seconds
Avg sample val. time: 0.0003774639959439799 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 1.021827 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 0.861741 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.122555732727051 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1416071891784667 seconds
Avg batch train. time: 0.07138690630594889 seconds
Avg sample train. time: 0.0011160016618960223 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 1.013758 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1958134174346924 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1506415605545044 seconds
Avg batch train. time: 0.07168805201848348 seconds
Avg sample train. time: 0.0011207095156615448 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2521836757659912 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24339632987976073 seconds
Avg batch val. time: 0.024339632987976072 seconds
Avg sample val. time: 0.00038090192469446125 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 2.361163 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.944991 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1413414478302 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.149312973022461 seconds
Avg batch train. time: 0.07164376576741537 seconds
Avg sample train. time: 0.0011200171823983643 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.752429 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.199768304824829 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.155619889497757 seconds
Avg batch train. time: 0.0718539963165919 seconds
Avg sample train. time: 0.001123303746481374 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.28403258323669434 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.250169038772583 seconds
Avg batch val. time: 0.0250169038772583 seconds
Avg sample val. time: 0.0003915008431495822 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 5.789213 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 1.174235 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1375315189361572 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1536100705464682 seconds
Avg batch train. time: 0.07178700235154895 seconds
Avg sample train. time: 0.0011222564202951894 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.839873 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2811672687530518 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1663657903671263 seconds
Avg batch train. time: 0.07221219301223754 seconds
Avg sample train. time: 0.0011289034863820357 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.27800536155700684 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.254145656313215 seconds
Avg batch val. time: 0.025414565631321502 seconds
Avg sample val. time: 0.00039772403178906884 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 3.953135 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.822149 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.162935256958008 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1660539236935703 seconds
Avg batch train. time: 0.07220179745645235 seconds
Avg sample train. time: 0.0011287409711795572 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 1.522068 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.954167127609253 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.148396690686544 seconds
Avg batch train. time: 0.0716132230228848 seconds
Avg sample train. time: 0.0011195397033280582 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3080003261566162 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.26087749004364014 seconds
Avg batch val. time: 0.026087749004364013 seconds
Avg sample val. time: 0.00040825898285389695 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 2.286758 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 1.231272 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.982593297958374 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1356425835536075 seconds
Avg batch train. time: 0.07118808611845358 seconds
Avg sample train. time: 0.0011128934776204313 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.984920 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8465235233306885 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1149912221091136 seconds
Avg batch train. time: 0.07049970740363712 seconds
Avg sample train. time: 0.0011021319552418519 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22198486328125 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.25655608707004124 seconds
Avg batch val. time: 0.025655608707004125 seconds
Avg sample val. time: 0.00040149622389677817 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 2.015348 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 1.391976 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8196353912353516 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.095300833384196 seconds
Avg batch train. time: 0.06984336111280652 seconds
Avg sample train. time: 0.0010918712003044272 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 1.312043 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0451438426971436 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.092166021466255 seconds
Avg batch train. time: 0.06973886738220851 seconds
Avg sample train. time: 0.0010902376349485436 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21599984169006348 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.25250046253204345 seconds
Avg batch val. time: 0.025250046253204345 seconds
Avg sample val. time: 0.0003951493936338708 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 2.172997 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 1.516607 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8778400421142578 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0795586109161377 seconds
Avg batch train. time: 0.06931862036387125 seconds
Avg sample train. time: 0.0010836678535258665 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 1.300936 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7813301086425781 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.062990360789829 seconds
Avg batch train. time: 0.06876634535966096 seconds
Avg sample train. time: 0.001075034059817524 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23699617385864258 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2510909817435525 seconds
Avg batch val. time: 0.02510909817435525 seconds
Avg sample val. time: 0.0003929436334014906 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 9.136346 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 1.387408 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9741942882537842 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0583168832879317 seconds
Avg batch train. time: 0.06861056277626439 seconds
Avg sample train. time: 0.0010725986885294068 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 1.661935 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8616280555725098 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0484824419021606 seconds
Avg batch train. time: 0.06828274806340535 seconds
Avg sample train. time: 0.0010674739144878377 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22800064086914062 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24916678667068481 seconds
Avg batch val. time: 0.02491667866706848 seconds
Avg sample val. time: 0.000389932373506549 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 2.434319 | 
Best loss was 1.0218267067683882. Other metrics: OrderedDict([('epoch', 4), ('loss', 1.0218267067683882)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 47.86519932746887 seconds

