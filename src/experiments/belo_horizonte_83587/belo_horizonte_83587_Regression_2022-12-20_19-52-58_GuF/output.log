Running:
main.py --output_dir experiments/belo_horizonte_83587/ --comment regression for belo_horizonte_83587 --name belo_horizonte_83587_Regression --records_file experiments/belo_horizonte_83587/belo_horizonte_83587_Regression.xls --data_dir datasets/files/belo_horizonte_83587/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.01 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
639 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18400120735168457 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18400120735168457 seconds
Avg batch val. time: 0.018400120735168456 seconds
Avg sample val. time: 0.00028795181119199465 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 438.149419 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 299.938934 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6765823364257812 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6765823364257812 seconds
Avg batch train. time: 0.05588607788085938 seconds
Avg sample train. time: 0.0008736750059540288 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18076109886169434 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18238115310668945 seconds
Avg batch val. time: 0.018238115310668945 seconds
Avg sample val. time: 0.00028541651503394283 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 27.477684 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 14.388170 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8655269145965576 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7710546255111694 seconds
Avg batch train. time: 0.05903515418370565 seconds
Avg sample train. time: 0.0009229049637890409 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2069995403289795 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19058728218078613 seconds
Avg batch val. time: 0.019058728218078615 seconds
Avg sample val. time: 0.00029825865755991573 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 2.609438 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 1.565519 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7613775730133057 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7678289413452148 seconds
Avg batch train. time: 0.05892763137817383 seconds
Avg sample train. time: 0.0009212240444737962 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 0.832569 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7527811527252197 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.764066994190216 seconds
Avg batch train. time: 0.05880223313967387 seconds
Avg sample train. time: 0.000919263675971973 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.188002347946167 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18994104862213135 seconds
Avg batch val. time: 0.018994104862213135 seconds
Avg sample val. time: 0.0002972473374368253 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 0.580844 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.068392 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6510546207427979 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7414645195007323 seconds
Avg batch train. time: 0.05804881731669108 seconds
Avg sample train. time: 0.0009074854192291466 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.718016 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7911062240600586 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7497381369272869 seconds
Avg batch train. time: 0.0583246045642429 seconds
Avg sample train. time: 0.0009117968405040577 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18857049942016602 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1896669387817383 seconds
Avg batch val. time: 0.01896669387817383 seconds
Avg sample val. time: 0.0002968183705504512 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 0.302546 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 1.333382 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7913055419921875 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.755676337650844 seconds
Avg batch train. time: 0.058522544588361466 seconds
Avg sample train. time: 0.0009148912650603668 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.728489 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8984239101409912 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7735197842121124 seconds
Avg batch train. time: 0.05911732614040375 seconds
Avg sample train. time: 0.0009241895696780159 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20500636100769043 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19222350915273032 seconds
Avg batch val. time: 0.01922235091527303 seconds
Avg sample val. time: 0.0003008192631498127 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 1.993668 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.796163 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8518202304840088 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7822198337978787 seconds
Avg batch train. time: 0.059407327793262625 seconds
Avg sample train. time: 0.0009287232067732563 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.780415 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.783033847808838 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7823012351989747 seconds
Avg batch train. time: 0.059410041173299157 seconds
Avg sample train. time: 0.0009287656254293771 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.216994047164917 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19576215744018555 seconds
Avg batch val. time: 0.019576215744018556 seconds
Avg sample val. time: 0.000306357053897004 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 1.732474 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.830247 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8734660148620605 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7905889424410733 seconds
Avg batch train. time: 0.05968629808136911 seconds
Avg sample train. time: 0.000933084388973983 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 2.267181 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.901578426361084 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7998380661010742 seconds
Avg batch train. time: 0.05999460220336914 seconds
Avg sample train. time: 0.0009379041511730455 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21741271018981934 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19846847653388977 seconds
Avg batch val. time: 0.019846847653388976 seconds
Avg sample val. time: 0.0003105922950452109 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.795938 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 1.374432 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9075038433074951 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8081200489631066 seconds
Avg batch train. time: 0.06027066829877022 seconds
Avg sample train. time: 0.0009422199317160535 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 1.328005 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.4165971279144287 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8515826974596297 seconds
Avg batch train. time: 0.06171942324865432 seconds
Avg sample train. time: 0.0009648685239497809 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23000836372375488 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20197290844387478 seconds
Avg batch val. time: 0.020197290844387476 seconds
Avg sample val. time: 0.00031607653903579776 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 3.861901 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 1.604273 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1910018920898438 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8742106437683106 seconds
Avg batch train. time: 0.062473688125610355 seconds
Avg sample train. time: 0.0009766600540741586 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.893469 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.417057991027832 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9081386029720306 seconds
Avg batch train. time: 0.06360462009906769 seconds
Avg sample train. time: 0.0009943400745034033 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.26300477981567383 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2080760955810547 seconds
Avg batch val. time: 0.02080760955810547 seconds
Avg sample val. time: 0.0003256276926151091 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 1.924408 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 1.417784 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8940231800079346 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9073082839741426 seconds
Avg batch train. time: 0.06357694279913809 seconds
Avg sample train. time: 0.0009939073913361868 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 1.462525 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0257301330566406 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.913887275589837 seconds
Avg batch train. time: 0.06379624251966123 seconds
Avg sample train. time: 0.0009973357350650531 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21600031852722168 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20879647948525168 seconds
Avg batch val. time: 0.02087964794852517 seconds
Avg sample val. time: 0.00032675505396753 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 6.786223 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 1.202062 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9181463718414307 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9141114385504472 seconds
Avg batch train. time: 0.06380371461834825 seconds
Avg sample train. time: 0.0009974525474468199 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 1.854569 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8569915294647217 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9112554430961608 seconds
Avg batch train. time: 0.06370851476987202 seconds
Avg sample train. time: 0.000995964274672309 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22625041007995605 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21025097370147705 seconds
Avg batch val. time: 0.021025097370147704 seconds
Avg sample val. time: 0.0003290312577487904 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 1.725868 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 1.134761 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0403032302856445 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9174005758194697 seconds
Avg batch train. time: 0.06391335252731566 seconds
Avg sample train. time: 0.0009991665324749711 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 1.825150 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1051549911499023 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9259348674253984 seconds
Avg batch train. time: 0.06419782891417995 seconds
Avg sample train. time: 0.001003613792300885 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22398972511291504 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21130780073312613 seconds
Avg batch val. time: 0.021130780073312615 seconds
Avg sample val. time: 0.00033068513416764655 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 2.655687 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 1.227476 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.554666042327881 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9532710054646367 seconds
Avg batch train. time: 0.06510903351548789 seconds
Avg sample train. time: 0.0010178587834625517 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 1.562272 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.210521697998047 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9639897843201954 seconds
Avg batch train. time: 0.06546632614400652 seconds
Avg sample train. time: 0.0010234443899532024 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3149998188018799 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21871437345232284 seconds
Avg batch val. time: 0.021871437345232284 seconds
Avg sample val. time: 0.0003422760147923675 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 1.400451 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 1.159795 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.6054317951202393 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9896474647521973 seconds
Avg batch train. time: 0.06632158215840658 seconds
Avg sample train. time: 0.001036814728896403 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 1.001108 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2950077056884766 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0013920894035926 seconds
Avg batch train. time: 0.06671306964678642 seconds
Avg sample train. time: 0.0010429349084958794 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.29198670387268066 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22359919548034668 seconds
Avg batch val. time: 0.02235991954803467 seconds
Avg sample val. time: 0.00034992049370946273 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 5.467141 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 1.409133 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.5189321041107178 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.020560238096449 seconds
Avg batch train. time: 0.0673520079365483 seconds
Avg sample train. time: 0.0010529235216761067 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 1.584557 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.3996455669403076 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0340989998408725 seconds
Avg batch train. time: 0.06780329999469575 seconds
Avg sample train. time: 0.0010599786346226537 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3139309883117676 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22924493253231049 seconds
Avg batch val. time: 0.022924493253231048 seconds
Avg sample val. time: 0.00035875576296136226 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 9.981623 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 1.592690 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.217905282974243 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0404371475351266 seconds
Avg batch train. time: 0.06801457158450422 seconds
Avg sample train. time: 0.0010632814734419628 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 2.024136 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.109995126724243 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0427557468414306 seconds
Avg batch train. time: 0.06809185822804768 seconds
Avg sample train. time: 0.001064489706535399 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2665257453918457 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23143792152404785 seconds
Avg batch val. time: 0.023143792152404787 seconds
Avg sample val. time: 0.0003621876706166633 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 3.970930 | 
Best loss was 0.3025458504523097. Other metrics: OrderedDict([('epoch', 6), ('loss', 0.3025458504523097)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 9.038656949996948 seconds

