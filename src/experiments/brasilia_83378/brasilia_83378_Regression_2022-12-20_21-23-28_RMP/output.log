Running:
main.py --output_dir experiments/brasilia_83378/ --comment regression for brasilia_83378 --name brasilia_83378_Regression --records_file experiments/brasilia_83378/brasilia_83378_Regression.xls --data_dir datasets/files/brasilia_83378/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.0001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.16199803352355957 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.16199803352355957 seconds
Avg batch val. time: 0.016199803352355956 seconds
Avg sample val. time: 0.0002531219273805618 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 528.545590 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 505.158986 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7248735427856445 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7248735427856445 seconds
Avg batch train. time: 0.05749578475952148 seconds
Avg sample train. time: 0.0008988397825876209 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20400118827819824 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1829996109008789 seconds
Avg batch val. time: 0.018299961090087892 seconds
Avg sample val. time: 0.0002859368920326233 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 484.075815 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 498.305377 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7660202980041504 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7454469203948975 seconds
Avg batch train. time: 0.058181564013163246 seconds
Avg sample train. time: 0.0009095606672198527 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19300293922424316 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18633405367533365 seconds
Avg batch val. time: 0.018633405367533364 seconds
Avg sample val. time: 0.0002911469588677088 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 477.682791 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 489.548637 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7459986209869385 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7456308205922444 seconds
Avg batch train. time: 0.05818769401974148 seconds
Avg sample train. time: 0.0009096564984847548 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 476.898351 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7031669616699219 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7350148558616638 seconds
Avg batch train. time: 0.057833828528722125 seconds
Avg sample train. time: 0.0009041244689221802 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.16900157928466797 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18200093507766724 seconds
Avg batch val. time: 0.018200093507766725 seconds
Avg sample val. time: 0.0002843764610588551 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 458.464084 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 461.178169 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6724774837493896 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.722507381439209 seconds
Avg batch train. time: 0.0574169127146403 seconds
Avg sample train. time: 0.0008976067646895305 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 442.666125 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6634483337402344 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7126642068227131 seconds
Avg batch train. time: 0.05708880689409044 seconds
Avg sample train. time: 0.0008924774397200173 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.16900420188903809 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17940158843994142 seconds
Avg batch val. time: 0.017940158843994143 seconds
Avg sample val. time: 0.0002803149819374085 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 430.539069 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 421.127294 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.685028076171875 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7087161881583077 seconds
Avg batch train. time: 0.05695720627194359 seconds
Avg sample train. time: 0.0008904201084722812 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 397.670484 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7116379737854004 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7090814113616943 seconds
Avg batch train. time: 0.05696938037872314 seconds
Avg sample train. time: 0.0008906104280154739 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20000004768371582 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18283466498057047 seconds
Avg batch val. time: 0.018283466498057045 seconds
Avg sample val. time: 0.00028567916403214133 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 385.341107 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 370.430783 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6729793548583984 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.705070071750217 seconds
Avg batch train. time: 0.05683566905834057 seconds
Avg sample train. time: 0.0008885200999219473 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 339.746252 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6935184001922607 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7039149045944213 seconds
Avg batch train. time: 0.05679716348648071 seconds
Avg sample train. time: 0.0008879181368391982 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1730036735534668 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1814302376338414 seconds
Avg batch val. time: 0.01814302376338414 seconds
Avg sample val. time: 0.00028348474630287716 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 327.445036 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 308.939491 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7895231246948242 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7116974700580945 seconds
Avg batch train. time: 0.05705658233526981 seconds
Avg sample train. time: 0.0008919736686076573 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 275.883777 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6804766654968262 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7090957363446553 seconds
Avg batch train. time: 0.05696985787815518 seconds
Avg sample train. time: 0.0008906178928320247 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18799376487731934 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18225067853927612 seconds
Avg batch val. time: 0.018225067853927614 seconds
Avg sample val. time: 0.00028476668521761896 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 266.484868 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 243.978062 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.683593511581421 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7071340267474835 seconds
Avg batch train. time: 0.05690446755824945 seconds
Avg sample train. time: 0.0008895956366584073 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 213.844504 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6814312934875488 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7052981172289168 seconds
Avg batch train. time: 0.05684327057429723 seconds
Avg sample train. time: 0.0008886389355023016 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19147467613220215 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18327556716071236 seconds
Avg batch val. time: 0.018327556716071235 seconds
Avg sample val. time: 0.00028636807368861305 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 210.383549 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 184.095942 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6555895805358887 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7019842147827149 seconds
Avg batch train. time: 0.05673280715942383 seconds
Avg sample train. time: 0.0008869120452228843 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 156.128943 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7361347675323486 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.704118624329567 seconds
Avg batch train. time: 0.0568039541443189 seconds
Avg sample train. time: 0.0008880242961592324 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18701839447021484 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1836498498916626 seconds
Avg batch val. time: 0.01836498498916626 seconds
Avg sample val. time: 0.0002869528904557228 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 156.041342 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 129.295198 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.713890552520752 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7046934436349308 seconds
Avg batch train. time: 0.056823114787831024 seconds
Avg sample train. time: 0.0008883238372250811 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 104.545162 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.691054344177246 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7039357158872817 seconds
Avg batch train. time: 0.056797857196242724 seconds
Avg sample train. time: 0.0008879289817025959 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18700075149536133 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18395447731018066 seconds
Avg batch val. time: 0.018395447731018068 seconds
Avg sample val. time: 0.0002874288707971573 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 101.944218 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 81.098678 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8149993419647217 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7097811698913574 seconds
Avg batch train. time: 0.05699270566304525 seconds
Avg sample train. time: 0.0008909750755035735 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 60.264970 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7502288818359375 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7118035554885864 seconds
Avg batch train. time: 0.057060118516286215 seconds
Avg sample train. time: 0.0008920289502285495 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20199990272521973 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18545826276143393 seconds
Avg batch val. time: 0.018545826276143394 seconds
Avg sample val. time: 0.00028977853556474054 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 53.061038 | 
Best loss was 53.06103782653808. Other metrics: OrderedDict([('epoch', 20), ('loss', 53.06103782653808)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 39.95539164543152 seconds

