Running:
main.py --output_dir experiments/brasilia_83378/ --comment regression for brasilia_83378 --name brasilia_83378_Regression --records_file experiments/brasilia_83378/brasilia_83378_Regression.xls --data_dir datasets/files/brasilia_83378/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18299055099487305 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18299055099487305 seconds
Avg batch val. time: 0.018299055099487305 seconds
Avg sample val. time: 0.00028592273592948915 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 249.029851 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 494.229769 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7031173706054688 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7031173706054688 seconds
Avg batch train. time: 0.056770579020182295 seconds
Avg sample train. time: 0.0008875025380956065 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18500041961669922 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18399548530578613 seconds
Avg batch val. time: 0.018399548530578614 seconds
Avg sample val. time: 0.00028749294579029084 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 475.230020 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 488.980709 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7036020755767822 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7033597230911255 seconds
Avg batch train. time: 0.05677865743637085 seconds
Avg sample train. time: 0.0008876288291251305 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1730327606201172 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18034124374389648 seconds
Avg batch val. time: 0.01803412437438965 seconds
Avg sample val. time: 0.0002817831933498383 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 472.051227 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 479.695023 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6810762882232666 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6959319114685059 seconds
Avg batch train. time: 0.056531063715616864 seconds
Avg sample train. time: 0.0008837581612655059 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 469.967627 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6559967994689941 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.685948133468628 seconds
Avg batch train. time: 0.05619827111562093 seconds
Avg sample train. time: 0.0008785555672061636 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20299696922302246 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18600517511367798 seconds
Avg batch val. time: 0.0186005175113678 seconds
Avg sample val. time: 0.00029063308611512186 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 458.581525 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 456.808094 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.726212739944458 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.694001054763794 seconds
Avg batch train. time: 0.0564667018254598 seconds
Avg sample train. time: 0.0008827519826804554 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 441.301897 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6825120449066162 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6920862197875977 seconds
Avg batch train. time: 0.05640287399291992 seconds
Avg sample train. time: 0.0008817541530941103 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18851256370544434 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18650665283203124 seconds
Avg batch val. time: 0.018650665283203124 seconds
Avg sample val. time: 0.0002914166450500488 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 429.588422 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 423.315718 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7500507831573486 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7003668716975622 seconds
Avg batch train. time: 0.05667889572325207 seconds
Avg sample train. time: 0.0008860692400716843 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 403.799860 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6763355731964111 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6973629593849182 seconds
Avg batch train. time: 0.056578765312830605 seconds
Avg sample train. time: 0.0008845038871208537 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1965160369873047 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1881748835245768 seconds
Avg batch val. time: 0.01881748835245768 seconds
Avg sample val. time: 0.00029402325550715127 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 396.167398 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 380.881920 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.682997465133667 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6957667933570013 seconds
Avg batch train. time: 0.05652555977856671 seconds
Avg sample train. time: 0.000883672117434602 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 353.657502 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6820709705352783 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.694397211074829 seconds
Avg batch train. time: 0.056479907035827635 seconds
Avg sample train. time: 0.0008829584216127302 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19499921798706055 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1891497884477888 seconds
Avg batch val. time: 0.018914978844778878 seconds
Avg sample val. time: 0.00029554654444966996 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 348.033408 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 324.710810 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7395236492156982 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.698499614542181 seconds
Avg batch train. time: 0.056616653818072696 seconds
Avg sample train. time: 0.0008850962035133824 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 293.860852 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6780450344085693 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6967950661977131 seconds
Avg batch train. time: 0.05655983553992377 seconds
Avg sample train. time: 0.0008842079552880215 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19500231742858887 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1898813545703888 seconds
Avg batch val. time: 0.01898813545703888 seconds
Avg sample val. time: 0.0002966896165162325 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 285.629369 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 262.105688 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6890292167663574 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.696197693164532 seconds
Avg batch train. time: 0.0565399231054844 seconds
Avg sample train. time: 0.0008838966613676561 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 229.713181 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.666069746017456 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6940456969397408 seconds
Avg batch train. time: 0.056468189897991364 seconds
Avg sample train. time: 0.0008827752459300369 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18900036811828613 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18978346718682182 seconds
Avg batch val. time: 0.018978346718682183 seconds
Avg sample val. time: 0.0002965366674794091 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 225.776050 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 198.762431 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6790966987609863 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6930490970611571 seconds
Avg batch train. time: 0.05643496990203857 seconds
Avg sample train. time: 0.0008822559130073774 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 168.903455 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6815311908721924 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.692329227924347 seconds
Avg batch train. time: 0.056410974264144896 seconds
Avg sample train. time: 0.0008818807857865279 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19700193405151367 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.190505313873291 seconds
Avg batch val. time: 0.019050531387329102 seconds
Avg sample val. time: 0.0002976645529270172 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 171.151201 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 141.609655 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6732065677642822 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6912043655619902 seconds
Avg batch train. time: 0.05637347885206634 seconds
Avg sample train. time: 0.0008812946146753467 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 114.998388 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.748046875 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6943622827529907 seconds
Avg batch train. time: 0.05647874275843302 seconds
Avg sample train. time: 0.0008829402202985882 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18491744995117188 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18999732624400745 seconds
Avg batch val. time: 0.018999732624400745 seconds
Avg sample val. time: 0.00029687082225626164 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 115.349447 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 90.437788 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6763696670532227 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6934153029793186 seconds
Avg batch train. time: 0.05644717676597729 seconds
Avg sample train. time: 0.0008824467446478993 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 67.999065 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6710705757141113 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6922980666160583 seconds
Avg batch train. time: 0.05640993555386861 seconds
Avg sample train. time: 0.0008818645474810101 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17699933052062988 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18891415993372598 seconds
Avg batch val. time: 0.018891415993372598 seconds
Avg sample val. time: 0.00029517837489644684 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 62.729005 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 49.791058 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7374904155731201 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6944500832330613 seconds
Avg batch train. time: 0.05648166944110204 seconds
Avg sample train. time: 0.0008829859735451076 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 33.216298 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6815218925476074 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6938624382019043 seconds
Avg batch train. time: 0.05646208127339681 seconds
Avg sample train. time: 0.0008826797489327276 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1940019130706787 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18930552555964544 seconds
Avg batch val. time: 0.018930552555964545 seconds
Avg sample val. time: 0.000295789883686946 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 28.008454 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 20.434036 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7067816257476807 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6944241420082424 seconds
Avg batch train. time: 0.05648080473360808 seconds
Avg sample train. time: 0.0008829724554498397 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 12.024061 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.675264596939087 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6936258276303608 seconds
Avg batch train. time: 0.05645419425434536 seconds
Avg sample train. time: 0.0008825564500418764 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19699835777282715 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1898550135748727 seconds
Avg batch val. time: 0.01898550135748727 seconds
Avg sample val. time: 0.0002966484587107386 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 7.283574 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 7.065340 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6910784244537354 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.693523931503296 seconds
Avg batch train. time: 0.05645079771677653 seconds
Avg sample train. time: 0.0008825033514868661 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 4.754086 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6980271339416504 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6936971315970788 seconds
Avg batch train. time: 0.05645657105323596 seconds
Avg sample train. time: 0.0008825936068770603 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17000365257263184 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18853158950805665 seconds
Avg batch val. time: 0.018853158950805665 seconds
Avg sample val. time: 0.0002945806086063385 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 4.097810 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 3.620579 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.703711748123169 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6940680433202673 seconds
Avg batch train. time: 0.056468934777342245 seconds
Avg sample train. time: 0.000882786890734897 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 3.381470 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.74354887008667 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6958352157047816 seconds
Avg batch train. time: 0.05652784052349272 seconds
Avg sample train. time: 0.0008837077726444927 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17600178718566895 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1877484768629074 seconds
Avg batch val. time: 0.01877484768629074 seconds
Avg sample val. time: 0.0002933569950982928 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 1.422140 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 2.861890 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.704406976699829 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6961307936701282 seconds
Avg batch train. time: 0.056537693122337605 seconds
Avg sample train. time: 0.0008838617997238813 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 2.590993 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.709463357925415 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6965752124786377 seconds
Avg batch train. time: 0.05655250708262126 seconds
Avg sample train. time: 0.0008840933884724532 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17199182510375977 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18682161499472225 seconds
Avg batch val. time: 0.018682161499472223 seconds
Avg sample val. time: 0.0002919087734292535 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 1.395014 | 
Best loss was 1.3950142502784728. Other metrics: OrderedDict([('epoch', 30), ('loss', 1.3950142502784728)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 57.72442293167114 seconds

