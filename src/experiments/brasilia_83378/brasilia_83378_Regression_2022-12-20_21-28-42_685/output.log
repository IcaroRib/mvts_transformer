Running:
main.py --output_dir experiments/brasilia_83378/ --comment regression for brasilia_83378 --name brasilia_83378_Regression --records_file experiments/brasilia_83378/brasilia_83378_Regression.xls --data_dir datasets/files/brasilia_83378/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.0005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18699073791503906 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18699073791503906 seconds
Avg batch val. time: 0.018699073791503908 seconds
Avg sample val. time: 0.00029217302799224856 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 551.335327 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 493.951768 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7374539375305176 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7374539375305176 seconds
Avg batch train. time: 0.05791513125101725 seconds
Avg sample train. time: 0.0009053954859460749 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2010021209716797 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19399642944335938 seconds
Avg batch val. time: 0.019399642944335938 seconds
Avg sample val. time: 0.000303119421005249 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 468.078006 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 466.403402 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6855230331420898 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7114884853363037 seconds
Avg batch train. time: 0.05704961617787679 seconds
Avg sample train. time: 0.0008918647656781156 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17800140380859375 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18866475423177084 seconds
Avg batch val. time: 0.018866475423177084 seconds
Avg sample val. time: 0.00029478867848714194 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 439.826611 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 418.794046 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7361125946044922 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7196965217590332 seconds
Avg batch train. time: 0.05732321739196777 seconds
Avg sample train. time: 0.0008961420123809448 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 343.907639 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7717220783233643 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.732702910900116 seconds
Avg batch train. time: 0.05775676369667053 seconds
Avg sample train. time: 0.0009029197034393518 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18400192260742188 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1874990463256836 seconds
Avg batch val. time: 0.01874990463256836 seconds
Avg sample val. time: 0.0002929672598838806 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 286.197418 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 247.936388 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7435436248779297 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7348710536956786 seconds
Avg batch train. time: 0.057829035123189286 seconds
Avg sample train. time: 0.0009040495329315678 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 158.094138 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7583746910095215 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.738788326581319 seconds
Avg batch train. time: 0.05795961088604397 seconds
Avg sample train. time: 0.0009060908424081913 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1853809356689453 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18707542419433593 seconds
Avg batch val. time: 0.018707542419433593 seconds
Avg sample val. time: 0.0002923053503036499 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 113.905352 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 84.296639 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7154912948608398 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7354601791926794 seconds
Avg batch train. time: 0.05784867263975598 seconds
Avg sample train. time: 0.0009043565290217193 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 30.625515 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7440509796142578 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7365340292453766 seconds
Avg batch train. time: 0.05788446764151255 seconds
Avg sample train. time: 0.0009049161173764338 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20600366592407227 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.190230131149292 seconds
Avg batch val. time: 0.0190230131149292 seconds
Avg sample val. time: 0.00029723457992076875 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 11.980073 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 7.236315 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.704894781112671 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7330185572306316 seconds
Avg batch train. time: 0.05776728524102105 seconds
Avg sample train. time: 0.0009030841882389951 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 3.575636 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.694127082824707 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7291294097900392 seconds
Avg batch train. time: 0.05763764699300131 seconds
Avg sample train. time: 0.0009010575350651584 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19000816345214844 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19019842147827148 seconds
Avg batch val. time: 0.01901984214782715 seconds
Avg sample val. time: 0.0002971850335597992 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 1.323608 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 2.576503 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.774172306060791 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7332242185419255 seconds
Avg batch train. time: 0.057774140618064185 seconds
Avg sample train. time: 0.0009031913593235672 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 1.929199 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7584936618804932 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7353300054868062 seconds
Avg batch train. time: 0.05784433351622687 seconds
Avg sample train. time: 0.0009042886948862982 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20200037956237793 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1916736662387848 seconds
Avg batch val. time: 0.01916736662387848 seconds
Avg sample val. time: 0.0002994901034981012 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.488002 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 1.638915 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6820435523986816 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7312310475569506 seconds
Avg batch train. time: 0.05770770158523168 seconds
Avg sample train. time: 0.0009021527084715741 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 1.258600 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.749037504196167 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7325029373168945 seconds
Avg batch train. time: 0.05775009791056315 seconds
Avg sample train. time: 0.0009028154962568497 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20731592178344727 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1934116946326362 seconds
Avg batch val. time: 0.01934116946326362 seconds
Avg sample val. time: 0.00030220577286349407 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.692352 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 1.143362 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.707317590713501 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7308239142100017 seconds
Avg batch train. time: 0.05769413047366672 seconds
Avg sample train. time: 0.000901940549353831 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 1.001690 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6875312328338623 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.728118121623993 seconds
Avg batch train. time: 0.05760393738746643 seconds
Avg sample train. time: 0.0009005305480062496 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17600369453430176 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19167089462280273 seconds
Avg batch val. time: 0.019167089462280275 seconds
Avg sample val. time: 0.0002994857728481293 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 1.636702 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.868911 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7586455345153809 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7299138517940746 seconds
Avg batch train. time: 0.057663795059802486 seconds
Avg sample train. time: 0.000901466311513327 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.788224 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6953151226043701 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7279917001724243 seconds
Avg batch train. time: 0.05759972333908081 seconds
Avg sample train. time: 0.00090046466918834 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1750023365020752 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19015557115728204 seconds
Avg batch val. time: 0.019015557115728204 seconds
Avg sample val. time: 0.0002971180799332532 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.912178 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.651504 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7035109996795654 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7267032422517474 seconds
Avg batch train. time: 0.057556774741724916 seconds
Avg sample train. time: 0.0008997932476559392 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.678837 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.762519121170044 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7284940361976624 seconds
Avg batch train. time: 0.05761646787325541 seconds
Avg sample train. time: 0.0009007264388731956 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17599987983703613 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18897593021392822 seconds
Avg batch val. time: 0.018897593021392822 seconds
Avg sample val. time: 0.00029527489095926285 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 1.069721 | 
Best loss was 0.6923522189259529. Other metrics: OrderedDict([('epoch', 14), ('loss', 0.6923522189259529)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 40.577439308166504 seconds

