Running:
main.py --output_dir experiments/brasilia_83378/ --comment regression for brasilia_83378 --name brasilia_83378_Regression --records_file experiments/brasilia_83378/brasilia_83378_Regression.xls --data_dir datasets/files/brasilia_83378/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.16993403434753418 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.16993403434753418 seconds
Avg batch val. time: 0.016993403434753418 seconds
Avg sample val. time: 0.00026552192866802216 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 715.933716 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 508.498161 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7575125694274902 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7575125694274902 seconds
Avg batch train. time: 0.05858375231424968 seconds
Avg sample train. time: 0.0009158481341466859 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19300055503845215 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18146729469299316 seconds
Avg batch val. time: 0.018146729469299315 seconds
Avg sample val. time: 0.0002835426479578018 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 475.757700 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 475.250173 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7184760570526123 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7379943132400513 seconds
Avg batch train. time: 0.05793314377466838 seconds
Avg sample train. time: 0.0009056770782908031 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18199896812438965 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18164451917012533 seconds
Avg batch val. time: 0.018164451917012533 seconds
Avg sample val. time: 0.00028381956120332084 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 442.709409 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 421.233139 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7485756874084473 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7415214379628499 seconds
Avg batch train. time: 0.05805071459876166 seconds
Avg sample train. time: 0.0009075150797096664 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 344.980405 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7440319061279297 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7421490550041199 seconds
Avg batch train. time: 0.058071635166804 seconds
Avg sample train. time: 0.0009078421339260656 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17200160026550293 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17923378944396973 seconds
Avg batch val. time: 0.017923378944396974 seconds
Avg sample val. time: 0.0002800527960062027 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 286.808276 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 253.575014 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7337234020233154 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.740463924407959 seconds
Avg batch train. time: 0.05801546414693196 seconds
Avg sample train. time: 0.0009069640043814273 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 165.840398 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6875264644622803 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7316410144170125 seconds
Avg batch train. time: 0.05772136714723375 seconds
Avg sample train. time: 0.000902366344146437 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1835176944732666 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1800905704498291 seconds
Avg batch val. time: 0.018009057044982908 seconds
Avg sample val. time: 0.00028139151632785794 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 121.228455 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 88.858361 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7683961391448975 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.736891746520996 seconds
Avg batch train. time: 0.05789639155069987 seconds
Avg sample train. time: 0.0009051025255450736 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 31.566844 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.856515645980835 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.751844733953476 seconds
Avg batch train. time: 0.05839482446511587 seconds
Avg sample train. time: 0.0009128945982039999 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21499991416931152 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18590879440307617 seconds
Avg batch val. time: 0.018590879440307618 seconds
Avg sample val. time: 0.00029048249125480653 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 11.725357 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 6.494370 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8462257385253906 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7623315122392442 seconds
Avg batch train. time: 0.058744383741308144 seconds
Avg sample train. time: 0.0009183593080975738 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 2.997472 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9109578132629395 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7771941423416138 seconds
Avg batch train. time: 0.05923980474472046 seconds
Avg sample train. time: 0.0009261042951233005 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20002317428588867 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1879251343863351 seconds
Avg batch val. time: 0.018792513438633508 seconds
Avg sample val. time: 0.00029363302247864857 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 1.302088 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 1.858852 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8992719650268555 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7882921262220903 seconds
Avg batch train. time: 0.05960973754073635 seconds
Avg sample train. time: 0.0009318875071506463 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 1.422571 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9326024055480957 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8003179828325908 seconds
Avg batch train. time: 0.060010599427753025 seconds
Avg sample train. time: 0.0009381542380576293 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2160322666168213 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19143852591514587 seconds
Avg batch val. time: 0.019143852591514587 seconds
Avg sample val. time: 0.0002991226967424154 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 2.719037 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 1.303838 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9510385990142822 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8119118763850286 seconds
Avg batch train. time: 0.06039706254616762 seconds
Avg sample train. time: 0.0009441958709666642 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 1.085532 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9641387462615967 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8227852242333549 seconds
Avg batch train. time: 0.06075950747444516 seconds
Avg sample train. time: 0.0009498620240924204 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23199677467346191 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1959449979994032 seconds
Avg batch val. time: 0.01959449979994032 seconds
Avg sample val. time: 0.0003061640593740675 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.482724 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.902605 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.042630195617676 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8374415556589763 seconds
Avg batch train. time: 0.06124805185529921 seconds
Avg sample train. time: 0.0009574995078994144 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.863108 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.983638048171997 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.84657883644104 seconds
Avg batch train. time: 0.061552627881368 seconds
Avg sample train. time: 0.000962260988244419 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22952628135681152 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19930312633514405 seconds
Avg batch val. time: 0.019930312633514406 seconds
Avg sample val. time: 0.0003114111348986626 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.694126 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.796170 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9911272525787354 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8550816844491398 seconds
Avg batch train. time: 0.06183605614830466 seconds
Avg sample train. time: 0.000966691862662397 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.762801 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9805090427398682 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8620498710208468 seconds
Avg batch train. time: 0.06206832903402823 seconds
Avg sample train. time: 0.0009703230177284247 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22600078582763672 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20173018628900702 seconds
Avg batch val. time: 0.020173018628900703 seconds
Avg sample val. time: 0.0003152034160765735 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 1.061436 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.570102 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0735199451446533 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8731798749220998 seconds
Avg batch train. time: 0.062439329164069995 seconds
Avg sample train. time: 0.0009761229155404376 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.619520 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.004037618637085 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8797227621078492 seconds
Avg batch train. time: 0.06265742540359497 seconds
Avg sample train. time: 0.0009795324450796504 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24353885650634766 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20521424214045206 seconds
Avg batch val. time: 0.020521424214045205 seconds
Avg sample val. time: 0.00032064725334445633 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.674592 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.527001 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.014111280441284 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8861222153618222 seconds
Avg batch train. time: 0.06287074051206074 seconds
Avg sample train. time: 0.0009828672305168434 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.518010 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.02630352973938 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.892494093288075 seconds
Avg batch train. time: 0.06308313644293582 seconds
Avg sample train. time: 0.0009861876463199974 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2239999771118164 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20665929867671087 seconds
Avg batch val. time: 0.020665929867671087 seconds
Avg sample val. time: 0.00032290515418236074 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 0.785590 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.470271 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2025184631347656 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9059734137161919 seconds
Avg batch train. time: 0.06353244712387306 seconds
Avg sample train. time: 0.000993211784114743 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.513899 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.08211088180542 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9133124748865764 seconds
Avg batch train. time: 0.06377708249621922 seconds
Avg sample train. time: 0.0009970362036928486 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22300243377685547 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20782666546957834 seconds
Avg batch val. time: 0.020782666546957835 seconds
Avg sample val. time: 0.00032472916479621617 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 0.698400 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.422093 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0350449085235596 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9181817722320558 seconds
Avg batch train. time: 0.06393939240773519 seconds
Avg sample train. time: 0.0009995736176300447 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.406707 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0092804431915283 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9216855672689586 seconds
Avg batch train. time: 0.06405618557563195 seconds
Avg sample train. time: 0.001001399461838957 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2220008373260498 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20877161026000976 seconds
Avg batch val. time: 0.020877161026000977 seconds
Avg sample val. time: 0.00032620564103126527 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 0.363303 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.496786 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.054046392440796 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9265878200531006 seconds
Avg batch train. time: 0.06421959400177002 seconds
Avg sample train. time: 0.0010039540490115167 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.374353 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0118629932403564 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9296333619526453 seconds
Avg batch train. time: 0.06432111206508818 seconds
Avg sample train. time: 0.0010055410953374911 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22489714622497559 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20977945625782013 seconds
Avg batch val. time: 0.020977945625782014 seconds
Avg sample val. time: 0.000327780400402844 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 0.842161 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.441183 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0344979763031006 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9332493831371438 seconds
Avg batch train. time: 0.06444164610457145 seconds
Avg sample train. time: 0.0010074254211240978 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.380976 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0520546436309814 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9372095584869384 seconds
Avg batch train. time: 0.06457365194956462 seconds
Avg sample train. time: 0.001009489087278238 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23052406311035156 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2109997272491455 seconds
Avg batch val. time: 0.02109997272491455 seconds
Avg sample val. time: 0.00032968707382678985 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 0.358785 | 
Best loss was 0.3587848663330078. Other metrics: OrderedDict([('epoch', 30), ('loss', 0.3587848663330078)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 5.559960842132568 seconds

