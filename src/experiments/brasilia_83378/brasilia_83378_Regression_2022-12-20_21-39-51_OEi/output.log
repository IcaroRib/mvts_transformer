Running:
main.py --output_dir experiments/brasilia_83378/ --comment regression for brasilia_83378 --name brasilia_83378_Regression --records_file experiments/brasilia_83378/brasilia_83378_Regression.xls --data_dir datasets/files/brasilia_83378/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.0025 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.16900873184204102 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.16900873184204102 seconds
Avg batch val. time: 0.0169008731842041 seconds
Avg sample val. time: 0.00026407614350318907 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 559.081039 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 458.779167 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6890017986297607 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6890017986297607 seconds
Avg batch train. time: 0.05630005995432536 seconds
Avg sample train. time: 0.0008801468466022724 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17800664901733398 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1735076904296875 seconds
Avg batch val. time: 0.01735076904296875 seconds
Avg sample val. time: 0.0002711057662963867 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 391.116437 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 294.141533 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1080331802368164 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8985174894332886 seconds
Avg batch train. time: 0.06328391631444295 seconds
Avg sample train. time: 0.0009893264666145328 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2180027961730957 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1883393923441569 seconds
Avg batch val. time: 0.01883393923441569 seconds
Avg sample val. time: 0.00029428030053774514 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 133.133602 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 81.059991 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0890684127807617 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9620344638824463 seconds
Avg batch train. time: 0.06540114879608154 seconds
Avg sample train. time: 0.0010224254632008579 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 4.403148 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0511696338653564 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9843182563781738 seconds
Avg batch train. time: 0.06614394187927246 seconds
Avg sample train. time: 0.00103403765314131 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23600053787231445 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2002546787261963 seconds
Avg batch val. time: 0.020025467872619628 seconds
Avg sample val. time: 0.0003128979355096817 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 5.066540 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.703298 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.075040340423584 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0024626731872557 seconds
Avg batch train. time: 0.06674875577290852 seconds
Avg sample train. time: 0.0010434927947823114 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 1.102157 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1225664615631104 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0224799712498984 seconds
Avg batch train. time: 0.06741599904166327 seconds
Avg sample train. time: 0.001053923903725846 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2520008087158203 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2106039047241211 seconds
Avg batch val. time: 0.02106039047241211 seconds
Avg sample val. time: 0.00032906860113143924 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 1.210996 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.796372 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.989182472229004 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.017723185675485 seconds
Avg batch train. time: 0.06725743952251616 seconds
Avg sample train. time: 0.001051445120206089 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.717169 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.037106990814209 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0201461613178253 seconds
Avg batch train. time: 0.06733820537726085 seconds
Avg sample train. time: 0.001052707744303192 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22084975242614746 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21231154600779215 seconds
Avg batch val. time: 0.021231154600779213 seconds
Avg sample val. time: 0.0003317367906371752 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 1.410090 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.659987 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0616376399993896 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.024756325615777 seconds
Avg batch train. time: 0.0674918775205259 seconds
Avg sample train. time: 0.0010551101227804986 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.578886 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0406222343444824 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0263429164886473 seconds
Avg batch train. time: 0.06754476388295491 seconds
Avg sample train. time: 0.0010559369028080496 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21000146865844727 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21198153495788574 seconds
Avg batch val. time: 0.021198153495788574 seconds
Avg sample val. time: 0.00033122114837169647 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.242766 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.624211 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1637678146362305 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0388360890475186 seconds
Avg batch train. time: 0.06796120296825062 seconds
Avg sample train. time: 0.0010624471542717657 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.533307 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0040481090545654 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0359370907147727 seconds
Avg batch train. time: 0.06786456969049243 seconds
Avg sample train. time: 0.0010609364724933677 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22800040245056152 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21398389339447021 seconds
Avg batch val. time: 0.021398389339447023 seconds
Avg sample val. time: 0.00033434983342885973 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.085143 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.537008 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0543572902679443 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0373540291419396 seconds
Avg batch train. time: 0.06791180097139798 seconds
Avg sample train. time: 0.0010616748458269617 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.532717 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.972545862197876 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0327248743602206 seconds
Avg batch train. time: 0.06775749581200735 seconds
Avg sample train. time: 0.00105926257131851 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23400259017944336 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.216208193037245 seconds
Avg batch val. time: 0.0216208193037245 seconds
Avg sample val. time: 0.0003378253016206953 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.929692 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.598532 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0189599990844727 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.031807216008504 seconds
Avg batch train. time: 0.06772690720028347 seconds
Avg sample train. time: 0.001058784375199846 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.605730 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9556498527526855 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0270473808050156 seconds
Avg batch train. time: 0.06756824602683385 seconds
Avg sample train. time: 0.0010563040025039164 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19900155067443848 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21448752880096436 seconds
Avg batch val. time: 0.021448752880096435 seconds
Avg sample val. time: 0.0003351367637515068 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.604677 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.518760 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9036052227020264 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0197860773871925 seconds
Avg batch train. time: 0.06732620257957309 seconds
Avg sample train. time: 0.0010525201028594021 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.499540 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9125423431396484 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.013828092151218 seconds
Avg batch train. time: 0.06712760307170726 seconds
Avg sample train. time: 0.001049415368499853 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2239987850189209 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2153521884571422 seconds
Avg batch val. time: 0.021535218845714223 seconds
Avg sample val. time: 0.00033648779446428473 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 1.305545 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.430111 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.910599708557129 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0083950193304765 seconds
Avg batch train. time: 0.06694650064434922 seconds
Avg sample train. time: 0.0010465841684890445 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.550507 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9116008281707764 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0035553097724916 seconds
Avg batch train. time: 0.06678517699241639 seconds
Avg sample train. time: 0.0010440621728882186 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19299936294555664 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21348945299784342 seconds
Avg batch val. time: 0.02134894529978434 seconds
Avg sample val. time: 0.0003335772703091303 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 1.628947 | 
Best loss was 0.24276561215519904. Other metrics: OrderedDict([('epoch', 10), ('loss', 0.24276561215519904)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 46.36564517021179 seconds

