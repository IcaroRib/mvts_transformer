Running:
main.py --output_dir experiments/brasilia_83378/ --comment regression for brasilia_83378 --name brasilia_83378_Regression --records_file experiments/brasilia_83378/brasilia_83378_Regression.xls --data_dir datasets/files/brasilia_83378/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17898893356323242 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17898893356323242 seconds
Avg batch val. time: 0.01789889335632324 seconds
Avg sample val. time: 0.00027967020869255064 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 581.804739 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 406.436539 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.632143259048462 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.632143259048462 seconds
Avg batch train. time: 0.054404775301615395 seconds
Avg sample train. time: 0.0008505175920002407 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18500232696533203 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18199563026428223 seconds
Avg batch val. time: 0.018199563026428223 seconds
Avg sample val. time: 0.000284368172287941 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 228.020950 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 117.185427 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9288840293884277 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7805136442184448 seconds
Avg batch train. time: 0.059350454807281496 seconds
Avg sample train. time: 0.0009278341032925715 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22604584693908691 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19667903582255045 seconds
Avg batch val. time: 0.019667903582255043 seconds
Avg sample val. time: 0.00030731099347273505 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 4.669704 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 2.915883 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.919023036956787 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8266834417978923 seconds
Avg batch train. time: 0.06088944805992975 seconds
Avg sample train. time: 0.0009518934037508559 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.803470 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0140035152435303 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8735134601593018 seconds
Avg batch train. time: 0.06245044867197672 seconds
Avg sample train. time: 0.0009762967483894225 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23853850364685059 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2071439027786255 seconds
Avg batch val. time: 0.020714390277862548 seconds
Avg sample val. time: 0.0003236623480916023 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 3.876575 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.041466 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9361274242401123 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.886036252975464 seconds
Avg batch train. time: 0.06286787509918214 seconds
Avg sample train. time: 0.0009828224351096737 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.824375 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9129877090454102 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8905281623204548 seconds
Avg batch train. time: 0.06301760541068183 seconds
Avg sample train. time: 0.0009851631903702214 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24100112915039062 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21391534805297852 seconds
Avg batch val. time: 0.021391534805297853 seconds
Avg sample val. time: 0.00033424273133277895 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 1.017729 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.621955 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8900413513183594 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.890458617891584 seconds
Avg batch train. time: 0.0630152872630528 seconds
Avg sample train. time: 0.0009851269504385534 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.687482 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9087483882904053 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8927448391914368 seconds
Avg batch train. time: 0.06309149463971456 seconds
Avg sample train. time: 0.0009863183111992896 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2229905128479004 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21542787551879883 seconds
Avg batch val. time: 0.021542787551879883 seconds
Avg sample val. time: 0.00033660605549812317 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 0.205068 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.834665 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9320852756500244 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8971159987979465 seconds
Avg batch train. time: 0.06323719995993154 seconds
Avg sample train. time: 0.000988596143198513 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.647514 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9041452407836914 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.897818922996521 seconds
Avg batch train. time: 0.0632606307665507 seconds
Avg sample train. time: 0.0009889624403316942 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22719860076904297 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21710940769740514 seconds
Avg batch val. time: 0.021710940769740512 seconds
Avg sample val. time: 0.0003392334495271955 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 4.731371 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.734265 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8784682750701904 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8960597731850364 seconds
Avg batch train. time: 0.06320199243950121 seconds
Avg sample train. time: 0.0009880457390229476 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 1.032968 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8821818828582764 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8949032823244731 seconds
Avg batch train. time: 0.0631634427441491 seconds
Avg sample train. time: 0.000987443086151367 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22500061988830566 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2180958092212677 seconds
Avg batch val. time: 0.02180958092212677 seconds
Avg sample val. time: 0.00034077470190823077 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 3.134361 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.705086 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9227004051208496 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.897041522539579 seconds
Avg batch train. time: 0.06323471741798596 seconds
Avg sample train. time: 0.0009885573332671072 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.620559 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9065804481506348 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.89772287436894 seconds
Avg batch train. time: 0.06325742914563133 seconds
Avg sample train. time: 0.000988912388936394 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23299884796142578 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2197517024146186 seconds
Avg batch val. time: 0.02197517024146186 seconds
Avg sample val. time: 0.00034336203502284156 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.226393 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.650670 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9030451774597168 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8980776945749918 seconds
Avg batch train. time: 0.06326925648583306 seconds
Avg sample train. time: 0.000989097287428344 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.871562 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8631336688995361 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8958936929702759 seconds
Avg batch train. time: 0.06319645643234253 seconds
Avg sample train. time: 0.0009879591938354746 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24899911880493164 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2226764440536499 seconds
Avg batch val. time: 0.022267644405364988 seconds
Avg sample val. time: 0.00034793194383382793 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 3.538196 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.563565 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9306294918060303 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.897936975254732 seconds
Avg batch train. time: 0.0632645658418244 seconds
Avg sample train. time: 0.000989023957923258 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.904647 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8895313739776611 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8974699974060059 seconds
Avg batch train. time: 0.06324899991353353 seconds
Avg sample train. time: 0.000988780613551853 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20699763298034668 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22125109759244052 seconds
Avg batch val. time: 0.022125109759244053 seconds
Avg sample val. time: 0.00034570483998818834 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 1.876535 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.964144 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9996013641357422 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9028453324970447 seconds
Avg batch train. time: 0.06342817774990149 seconds
Avg sample train. time: 0.000991581726157918 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.685737 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0599889755249023 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9107025146484375 seconds
Avg batch train. time: 0.06369008382161459 seconds
Avg sample train. time: 0.0009956761410361843 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2446579933166504 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22320167223612467 seconds
Avg batch val. time: 0.022320167223612467 seconds
Avg sample val. time: 0.0003487526128689448 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 2.508789 | 
Best loss was 0.2050676830112934. Other metrics: OrderedDict([('epoch', 8), ('loss', 0.2050676830112934)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 44.58305096626282 seconds

