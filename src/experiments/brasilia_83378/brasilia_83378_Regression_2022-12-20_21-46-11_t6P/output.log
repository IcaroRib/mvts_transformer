Running:
main.py --output_dir experiments/brasilia_83378/ --comment regression for brasilia_83378 --name brasilia_83378_Regression --records_file experiments/brasilia_83378/brasilia_83378_Regression.xls --data_dir datasets/files/brasilia_83378/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17198848724365234 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17198848724365234 seconds
Avg batch val. time: 0.017198848724365234 seconds
Avg sample val. time: 0.0002687320113182068 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 339.433716 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 405.752407 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5700252056121826 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.5700252056121826 seconds
Avg batch train. time: 0.052334173520406084 seconds
Avg sample train. time: 0.0008181475797874844 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1635284423828125 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.16775846481323242 seconds
Avg batch val. time: 0.016775846481323242 seconds
Avg sample val. time: 0.00026212260127067566 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 247.665419 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 116.531664 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7374389171600342 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6537320613861084 seconds
Avg batch train. time: 0.05512440204620361 seconds
Avg sample train. time: 0.0008617676192736364 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22002649307250977 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1851811408996582 seconds
Avg batch val. time: 0.01851811408996582 seconds
Avg sample val. time: 0.00028934553265571596 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 9.422877 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 3.447648 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.795140266418457 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7008681297302246 seconds
Avg batch train. time: 0.05669560432434082 seconds
Avg sample train. time: 0.000886330448009497 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.696513 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.814558982849121 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7292908430099487 seconds
Avg batch train. time: 0.057643028100331624 seconds
Avg sample train. time: 0.0009011416586815783 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19603681564331055 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1878950595855713 seconds
Avg batch val. time: 0.018789505958557128 seconds
Avg sample val. time: 0.0002935860306024551 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 6.482634 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.155993 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8293683528900146 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7493063449859618 seconds
Avg batch train. time: 0.05831021149953206 seconds
Avg sample train. time: 0.000911571831675853 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.919778 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7910635471343994 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7562658786773682 seconds
Avg batch train. time: 0.05854219595591227 seconds
Avg sample train. time: 0.0009151984776849235 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18700051307678223 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18771615028381347 seconds
Avg batch val. time: 0.018771615028381348 seconds
Avg sample val. time: 0.00029330648481845856 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 1.209866 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.806911 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7657339572906494 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7576184613364083 seconds
Avg batch train. time: 0.05858728204454695 seconds
Avg sample train. time: 0.0009159033149225682 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.846660 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7978553771972656 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7626480758190155 seconds
Avg batch train. time: 0.05875493586063385 seconds
Avg sample train. time: 0.000918524270880154 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19000029563903809 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18809684117635092 seconds
Avg batch val. time: 0.018809684117635093 seconds
Avg sample val. time: 0.0002939013143380483 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 0.154782 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.968877 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7921037673950195 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7659209304385715 seconds
Avg batch train. time: 0.058864031014619046 seconds
Avg sample train. time: 0.0009202297709424551 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.661987 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7355871200561523 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7628875494003295 seconds
Avg batch train. time: 0.05876291831334432 seconds
Avg sample train. time: 0.0009186490616989732 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19655346870422363 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18930493082318986 seconds
Avg batch val. time: 0.018930493082318985 seconds
Avg sample val. time: 0.00029578895441123413 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 1.673568 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.694728 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8420641422271729 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.770085421475497 seconds
Avg batch train. time: 0.05900284738251657 seconds
Avg sample train. time: 0.000922399906970035 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.725752 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7830312252044678 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7711642384529114 seconds
Avg batch train. time: 0.05903880794843038 seconds
Avg sample train. time: 0.000922962083612773 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20596790313720703 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19138780236244202 seconds
Avg batch val. time: 0.019138780236244202 seconds
Avg sample val. time: 0.00029904344119131566 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.695245 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.627243 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7567055225372314 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7700520295363207 seconds
Avg batch train. time: 0.059001734317877357 seconds
Avg sample train. time: 0.0009223825062721838 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 1.356624 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7360918521881104 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7676263025828771 seconds
Avg batch train. time: 0.05892087675276257 seconds
Avg sample train. time: 0.0009211184484538182 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1810007095336914 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19023368093702528 seconds
Avg batch val. time: 0.019023368093702527 seconds
Avg sample val. time: 0.000297240126464102 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.933096 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.979033 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7649757862091064 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7674496014912924 seconds
Avg batch train. time: 0.05891498671637641 seconds
Avg sample train. time: 0.0009210263686770674 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.564056 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6749870777130127 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7616706937551498 seconds
Avg batch train. time: 0.058722356458504994 seconds
Avg sample train. time: 0.0009180149524518759 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19800162315368652 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1910104751586914 seconds
Avg batch val. time: 0.019101047515869142 seconds
Avg sample val. time: 0.00029845386743545534 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 2.994627 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.550771 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.743058681488037 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7605758695041431 seconds
Avg batch train. time: 0.05868586231680477 seconds
Avg sample train. time: 0.0009174444343429616 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 1.520722 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.708350419998169 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7576744556427002 seconds
Avg batch train. time: 0.05858914852142334 seconds
Avg sample train. time: 0.0009159324938211048 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19399237632751465 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19128155708312988 seconds
Avg batch val. time: 0.01912815570831299 seconds
Avg sample val. time: 0.00029887743294239045 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 2.697080 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.513612 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6989469528198242 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7545835344414962 seconds
Avg batch train. time: 0.05848611781471654 seconds
Avg sample train. time: 0.0009143218001258448 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.893301 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7525582313537598 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7544822692871094 seconds
Avg batch train. time: 0.05848274230957031 seconds
Avg sample train. time: 0.0009142690303736891 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19102048873901367 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19125980138778687 seconds
Avg batch val. time: 0.019125980138778687 seconds
Avg sample val. time: 0.000298843439668417 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.913532 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.746062 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7553253173828125 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7545224144345237 seconds
Avg batch train. time: 0.058484080481150794 seconds
Avg sample train. time: 0.0009142899502003771 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.663421 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.680534839630127 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7511593428525059 seconds
Avg batch train. time: 0.05837197809508353 seconds
Avg sample train. time: 0.0009125374376511234 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20251750946044922 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19212577893183783 seconds
Avg batch val. time: 0.019212577893183782 seconds
Avg sample val. time: 0.0003001965295809966 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 0.649674 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.704737 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7905869483947754 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7528735865717349 seconds
Avg batch train. time: 0.05842911955239116 seconds
Avg sample train. time: 0.0009134307381822485 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.798910 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.738875150680542 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.752290318409602 seconds
Avg batch train. time: 0.058409677280320066 seconds
Avg sample train. time: 0.0009131267943770724 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18799996376037598 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19183107784816197 seconds
Avg batch val. time: 0.019183107784816196 seconds
Avg sample val. time: 0.00029973605913775306 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 0.832839 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 1.078436 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.813080072402954 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.754721908569336 seconds
Avg batch train. time: 0.058490730285644534 seconds
Avg sample train. time: 0.0009143939075400395 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 1.028889 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8050293922424316 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7566568117875319 seconds
Avg batch train. time: 0.058555227059584394 seconds
Avg sample train. time: 0.0009154021947824554 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19602131843566895 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19211042722066243 seconds
Avg batch val. time: 0.019211042722066245 seconds
Avg sample val. time: 0.0003001725425322851 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 3.605403 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 1.202175 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.82059907913208 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7590250439114041 seconds
Avg batch train. time: 0.05863416813038014 seconds
Avg sample train. time: 0.0009166362917724879 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 1.134605 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8601930141448975 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7626381857054574 seconds
Avg batch train. time: 0.05875460619018191 seconds
Avg sample train. time: 0.0009185191170950794 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2109665870666504 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19328893721103668 seconds
Avg batch val. time: 0.01932889372110367 seconds
Avg sample val. time: 0.00030201396439224484 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 2.505636 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.646884 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.868267297744751 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7662805688792262 seconds
Avg batch train. time: 0.05887601896264087 seconds
Avg sample train. time: 0.000920417180239305 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 1.333352 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8455426692962646 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7689226388931274 seconds
Avg batch train. time: 0.05896408796310425 seconds
Avg sample train. time: 0.0009217939754523853 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20800137519836426 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.194154374739703 seconds
Avg batch val. time: 0.0194154374739703 seconds
Avg sample val. time: 0.00030336621053078596 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 3.943588 | 
Best loss was 0.15478244684636594. Other metrics: OrderedDict([('epoch', 8), ('loss', 0.15478244684636594)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 0.14466023445129395 seconds

