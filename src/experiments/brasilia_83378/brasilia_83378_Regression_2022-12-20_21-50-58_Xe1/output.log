Running:
main.py --output_dir experiments/brasilia_83378/ --comment regression for brasilia_83378 --name brasilia_83378_Regression --records_file experiments/brasilia_83378/brasilia_83378_Regression.xls --data_dir datasets/files/brasilia_83378/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.01 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18200039863586426 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18200039863586426 seconds
Avg batch val. time: 0.018200039863586426 seconds
Avg sample val. time: 0.0002843756228685379 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 346.326166 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 334.913628 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5630106925964355 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.5630106925964355 seconds
Avg batch train. time: 0.052100356419881186 seconds
Avg sample train. time: 0.0008144922837917851 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17300152778625488 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17750096321105957 seconds
Avg batch val. time: 0.017750096321105958 seconds
Avg sample val. time: 0.0002773452550172806 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 32.932247 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 19.734042 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6700482368469238 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6165294647216797 seconds
Avg batch train. time: 0.05388431549072266 seconds
Avg sample train. time: 0.0008423811697351118 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19100213050842285 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18200135231018066 seconds
Avg batch val. time: 0.018200135231018065 seconds
Avg sample val. time: 0.00028437711298465727 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 6.955962 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 1.655059 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6370654106140137 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6233747800191243 seconds
Avg batch train. time: 0.05411249266730414 seconds
Avg sample train. time: 0.0008459482959974592 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.640642 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7921571731567383 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6655703783035278 seconds
Avg batch train. time: 0.055519012610117595 seconds
Avg sample train. time: 0.0008679366223572318 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2060256004333496 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1880074143409729 seconds
Avg batch val. time: 0.01880074143409729 seconds
Avg sample val. time: 0.00029376158490777014 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 0.717872 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.530847 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8510441780090332 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.702665138244629 seconds
Avg batch train. time: 0.056755504608154296 seconds
Avg sample train. time: 0.0008872668776678629 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 1.140458 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9272472858428955 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7400954961776733 seconds
Avg batch train. time: 0.058003183205922446 seconds
Avg sample train. time: 0.0009067720146835192 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20100116729736328 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19060616493225097 seconds
Avg batch val. time: 0.019060616493225095 seconds
Avg sample val. time: 0.0002978221327066421 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 5.983727 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.894300 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9690957069396973 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7728098120008196 seconds
Avg batch train. time: 0.059093660400027316 seconds
Avg sample train. time: 0.0009238195997919852 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 1.158386 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9562792778015137 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7957434952259064 seconds
Avg batch train. time: 0.059858116507530215 seconds
Avg sample train. time: 0.0009357704508733228 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22500061988830566 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19633857409159342 seconds
Avg batch val. time: 0.019633857409159343 seconds
Avg sample val. time: 0.00030677902201811473 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 2.410773 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 1.543606 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9676477909088135 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.814843972524007 seconds
Avg batch train. time: 0.06049479908413357 seconds
Avg sample train. time: 0.0009457238001688417 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.893005 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9795114994049072 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8313107252120973 seconds
Avg batch train. time: 0.061043690840403245 seconds
Avg sample train. time: 0.0009543047030808219 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21100163459777832 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19843329702104842 seconds
Avg batch val. time: 0.019843329702104843 seconds
Avg sample val. time: 0.00031005202659538817 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 3.192562 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 1.084768 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0270402431488037 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8491043177517978 seconds
Avg batch train. time: 0.06163681059172659 seconds
Avg sample train. time: 0.0009635770285314214 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 1.394884 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0480475425720215 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8656829198201497 seconds
Avg batch train. time: 0.06218943066067165 seconds
Avg sample train. time: 0.0009722162166858518 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2325584888458252 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2026989459991455 seconds
Avg batch val. time: 0.020269894599914552 seconds
Avg sample val. time: 0.0003167171031236649 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.527709 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 1.232160 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0501976013183594 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8798763568584735 seconds
Avg batch train. time: 0.06266254522861578 seconds
Avg sample train. time: 0.0009796124840325553 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 1.893068 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1336474418640137 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8980028629302979 seconds
Avg batch train. time: 0.0632667620976766 seconds
Avg sample train. time: 0.000989058292303438 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.27300286293029785 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2105104923248291 seconds
Avg batch val. time: 0.02105104923248291 seconds
Avg sample val. time: 0.00032892264425754547 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 2.017183 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 1.346047 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1272165775299072 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9132837772369384 seconds
Avg batch train. time: 0.06377612590789795 seconds
Avg sample train. time: 0.0009970212492115365 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 1.125963 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1295530796051025 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9268006086349487 seconds
Avg batch train. time: 0.06422668695449829 seconds
Avg sample train. time: 0.0010040649341505725 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23099827766418457 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21255927085876464 seconds
Avg batch val. time: 0.021255927085876463 seconds
Avg sample val. time: 0.00033212386071681973 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 5.673920 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 1.099267 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1699821949005127 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9411054078270407 seconds
Avg batch train. time: 0.0647035135942347 seconds
Avg sample train. time: 0.0010115192328436899 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 1.336964 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1743056774139404 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9540609783596463 seconds
Avg batch train. time: 0.06513536594532154 seconds
Avg sample train. time: 0.0010182704420842346 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25151944160461426 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2161011045629328 seconds
Avg batch val. time: 0.02161011045629328 seconds
Avg sample val. time: 0.0003376579758795825 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 4.272828 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 2.088045 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.237558364868164 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.968981893439042 seconds
Avg batch train. time: 0.0656327297813014 seconds
Avg sample train. time: 0.00102604580168788 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 1.970897 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1114025115966797 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.976102924346924 seconds
Avg batch train. time: 0.06587009747823079 seconds
Avg sample train. time: 0.0010297566046622844 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23399901390075684 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21759259700775146 seconds
Avg batch val. time: 0.021759259700775146 seconds
Avg sample val. time: 0.00033998843282461165 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 2.889961 | 
Best loss was 0.7178721144795418. Other metrics: OrderedDict([('epoch', 4), ('loss', 0.7178721144795418)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 45.739696979522705 seconds

