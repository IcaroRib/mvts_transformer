Running:
main.py --output_dir experiments/curitiba_83842/ --comment regression for curitiba_83842 --name curitiba_83842_Regression --records_file experiments/curitiba_83842/curitiba_83842_Regression.xls --data_dir datasets/files/curitiba_83842/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1905 samples may be used for training
635 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.9199991226196289 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.9199991226196289 seconds
Avg batch val. time: 0.09199991226196289 seconds
Avg sample val. time: 0.0014488175159364234 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 605.362580 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 363.652452 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.415004253387451 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.415004253387451 seconds
Avg batch train. time: 0.0805001417795817 seconds
Avg sample train. time: 0.0012677187681823892 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2799820899963379 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5999906063079834 seconds
Avg batch val. time: 0.05999906063079834 seconds
Avg sample val. time: 0.0009448670965480053 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 299.073030 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 332.587806 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2920138835906982 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.3535090684890747 seconds
Avg batch train. time: 0.07845030228296916 seconds
Avg sample train. time: 0.0012354378312278607 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.3260014057159424 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5086608727773031 seconds
Avg batch val. time: 0.05086608727773031 seconds
Avg sample val. time: 0.000801040744531186 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 263.642221 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 285.231188 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.114492654800415 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.273836930592855 seconds
Avg batch train. time: 0.07579456435309516 seconds
Avg sample train. time: 0.001193615186662916 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 226.997969 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7845423221588135 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1515132784843445 seconds
Avg batch train. time: 0.07171710928281148 seconds
Avg sample train. time: 0.0011294032957923068 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20099568367004395 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.4317445755004883 seconds
Avg batch val. time: 0.043174457550048825 seconds
Avg sample val. time: 0.0006799127173236036 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 167.935251 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 164.421495 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7585968971252441 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0729300022125243 seconds
Avg batch train. time: 0.06909766674041748 seconds
Avg sample train. time: 0.0010881522321325586 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 104.279985 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7425782680511475 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.017871379852295 seconds
Avg batch train. time: 0.06726237932840982 seconds
Avg sample train. time: 0.0010592500681639344 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20107650756835938 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3856109619140625 seconds
Avg batch val. time: 0.038561096191406255 seconds
Avg sample val. time: 0.0006072613573449803 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 66.706831 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 52.386160 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8385965824127197 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9922606945037842 seconds
Avg batch train. time: 0.0664086898167928 seconds
Avg sample train. time: 0.0010458061388471309 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 17.294293 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7944881916046143 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.967539131641388 seconds
Avg batch train. time: 0.0655846377213796 seconds
Avg sample train. time: 0.0010328289404941669 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20000147819519043 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3546760479609172 seconds
Avg batch val. time: 0.03546760479609172 seconds
Avg sample val. time: 0.0005585449574187672 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 6.854696 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 4.244617 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.762773036956787 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9447873433430989 seconds
Avg batch train. time: 0.0648262447781033 seconds
Avg sample train. time: 0.0010208857445370598 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 2.194633 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7826125621795654 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9285698652267456 seconds
Avg batch train. time: 0.06428566217422485 seconds
Avg sample train. time: 0.0010123726326649583 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20503497123718262 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3332987512860979 seconds
Avg batch val. time: 0.03332987512860979 seconds
Avg sample val. time: 0.0005248799232851935 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 1.829402 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 1.557351 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.381232976913452 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9697210571982644 seconds
Avg batch train. time: 0.06565736857327548 seconds
Avg sample train. time: 0.0010339743082405587 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 1.076299 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8820276260375977 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9624132712682087 seconds
Avg batch train. time: 0.06541377570894029 seconds
Avg sample train. time: 0.001030138200140792 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19600200653076172 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3161366581916809 seconds
Avg batch val. time: 0.031613665819168094 seconds
Avg sample val. time: 0.0004978530050262691 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.225945 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.964964 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6722562313079834 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.940093498963576 seconds
Avg batch train. time: 0.06466978329878587 seconds
Avg sample train. time: 0.0010184217842328484 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.853561 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6282165050506592 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9178165708269392 seconds
Avg batch train. time: 0.06392721902756464 seconds
Avg sample train. time: 0.0010067278587018054 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18204474449157715 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.3012375566694472 seconds
Avg batch val. time: 0.030123755666944717 seconds
Avg sample val. time: 0.0004743898530227515 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.611608 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.752759 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5998785495758057 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8966207027435302 seconds
Avg batch train. time: 0.06322069009145101 seconds
Avg sample train. time: 0.000995601418763008 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.791720 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.582472324371338 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8769864290952682 seconds
Avg batch train. time: 0.0625662143031756 seconds
Avg sample train. time: 0.0009852947134358363 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1830739974975586 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2894212007522583 seconds
Avg batch val. time: 0.02894212007522583 seconds
Avg sample val. time: 0.0004557814185074934 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.292970 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.734022 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5957634449005127 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8604439006132238 seconds
Avg batch train. time: 0.06201479668710746 seconds
Avg sample train. time: 0.0009766109714505111 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.693923 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5658068656921387 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8440751764509413 seconds
Avg batch train. time: 0.06146917254836471 seconds
Avg sample train. time: 0.0009680184653285781 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1799173355102539 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2794663039120761 seconds
Avg batch val. time: 0.02794663039120761 seconds
Avg sample val. time: 0.00044010441560956865 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.552340 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.733543 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5688958168029785 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8295920522589433 seconds
Avg batch train. time: 0.06098640174196478 seconds
Avg sample train. time: 0.0009604157754640122 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.661432 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5832805633544922 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8172764778137207 seconds
Avg batch train. time: 0.06057588259379069 seconds
Avg sample train. time: 0.0009539509069888298 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1730029582977295 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.27059435844421387 seconds
Avg batch val. time: 0.027059435844421387 seconds
Avg sample val. time: 0.00042613284794364387 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.543082 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.806327 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5822689533233643 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8060856433141799 seconds
Avg batch train. time: 0.06020285477713933 seconds
Avg sample train. time: 0.0009480764531832965 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.589773 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5414106845855713 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7940549633719705 seconds
Avg batch train. time: 0.05980183211239901 seconds
Avg sample train. time: 0.000941761135628331 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18203496932983398 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.26378209774310774 seconds
Avg batch val. time: 0.026378209774310775 seconds
Avg sample val. time: 0.00041540487833560273 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 0.712470 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.578425 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5602498054504395 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7838895217232082 seconds
Avg batch train. time: 0.05946298405744028 seconds
Avg sample train. time: 0.000936424945786461 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.517277 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5528497695922852 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7742628653844197 seconds
Avg batch train. time: 0.05914209551281399 seconds
Avg sample train. time: 0.0009313715828789604 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17804527282714844 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2576580388205392 seconds
Avg batch val. time: 0.025765803882053923 seconds
Avg sample val. time: 0.0004057606910559673 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 0.241013 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.734578 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.527341604232788 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7643860149383546 seconds
Avg batch train. time: 0.05881286716461182 seconds
Avg sample train. time: 0.0009261868844820759 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.636994 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5772490501403809 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7571884393692017 seconds
Avg batch train. time: 0.05857294797897339 seconds
Avg sample train. time: 0.0009224086295901321 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17000651359558105 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.251814603805542 seconds
Avg batch val. time: 0.0251814603805542 seconds
Avg sample val. time: 0.0003965584311898299 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 0.344975 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.537584 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5332393646240234 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7488940291934543 seconds
Avg batch train. time: 0.05829646763978181 seconds
Avg sample train. time: 0.0009180546085005009 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.636613 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5287144184112549 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7410304716655187 seconds
Avg batch train. time: 0.05803434905551729 seconds
Avg sample train. time: 0.0009139267567797999 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17499661445617676 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24701347947120667 seconds
Avg batch val. time: 0.024701347947120665 seconds
Avg sample val. time: 0.0003889976054664672 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 0.395974 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.533695 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5997178554534912 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.736157622830621 seconds
Avg batch train. time: 0.0578719207610207 seconds
Avg sample train. time: 0.0009113688308822158 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.572392 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5441644191741943 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7297578493754069 seconds
Avg batch train. time: 0.05765859497918023 seconds
Avg sample train. time: 0.0009080093697508698 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.16902565956115723 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24242596065296845 seconds
Avg batch val. time: 0.024242596065296846 seconds
Avg sample val. time: 0.0003817731663826275 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 0.704533 | 
Best loss was 0.24101296372300995. Other metrics: OrderedDict([('epoch', 24), ('loss', 0.24101296372300995)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 0.07165098190307617 seconds

