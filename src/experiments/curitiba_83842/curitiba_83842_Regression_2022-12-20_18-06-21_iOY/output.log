Running:
main.py --output_dir experiments/curitiba_83842/ --comment regression for curitiba_83842 --name curitiba_83842_Regression --records_file experiments/curitiba_83842/curitiba_83842_Regression.xls --data_dir datasets/files/curitiba_83842/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1905 samples may be used for training
635 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18200063705444336 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18200063705444336 seconds
Avg batch val. time: 0.018200063705444337 seconds
Avg sample val. time: 0.00028661517646369033 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 432.721718 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 348.558205 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9020705223083496 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9020705223083496 seconds
Avg batch train. time: 0.06340235074361165 seconds
Avg sample train. time: 0.0009984622164348291 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20000195503234863 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.191001296043396 seconds
Avg batch val. time: 0.0191001296043396 seconds
Avg sample val. time: 0.0003007894425880252 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 274.498510 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 285.210463 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6376338005065918 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7698521614074707 seconds
Avg batch train. time: 0.05899507204691569 seconds
Avg sample train. time: 0.0009290562527073337 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.209000825881958 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19700113932291666 seconds
Avg batch val. time: 0.019700113932291666 seconds
Avg sample val. time: 0.00031023801468175853 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 203.179910 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 193.788347 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7170145511627197 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7522396246592205 seconds
Avg batch train. time: 0.058407987488640685 seconds
Avg sample train. time: 0.0009198108265927666 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 99.789406 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8901515007019043 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7867175936698914 seconds
Avg batch train. time: 0.05955725312232971 seconds
Avg sample train. time: 0.0009379094979894443 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.27551770210266113 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21663028001785278 seconds
Avg batch val. time: 0.021663028001785278 seconds
Avg sample val. time: 0.0003411500472722091 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 45.059192 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 29.113278 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1790192127227783 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8651779174804688 seconds
Avg batch train. time: 0.06217259724934896 seconds
Avg sample train. time: 0.0009790960196747868 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 3.908034 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9693167209625244 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.882534384727478 seconds
Avg batch train. time: 0.06275114615758261 seconds
Avg sample train. time: 0.000988207026103663 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23060321807861328 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21942486763000488 seconds
Avg batch val. time: 0.021942486763000486 seconds
Avg sample val. time: 0.00034555097264567697 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 3.987849 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 1.716393 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9733431339263916 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8955070631844657 seconds
Avg batch train. time: 0.06318356877281553 seconds
Avg sample train. time: 0.000995016831067961 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 1.498988 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9143197536468506 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8978586494922638 seconds
Avg batch train. time: 0.06326195498307546 seconds
Avg sample train. time: 0.0009962512595759914 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21451663970947266 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2186068296432495 seconds
Avg batch val. time: 0.021860682964324953 seconds
Avg sample val. time: 0.000344262723847637 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 3.246087 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 1.295576 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.446983575820923 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9588725301954482 seconds
Avg batch train. time: 0.06529575100651494 seconds
Avg sample train. time: 0.001028279543409684 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 1.026361 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.6670010089874268 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.029685378074646 seconds
Avg batch train. time: 0.06765617926915486 seconds
Avg sample train. time: 0.001065451642033935 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.28200197219848633 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22766327857971191 seconds
Avg batch val. time: 0.02276632785797119 seconds
Avg sample val. time: 0.00035852484815702664 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.547371 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 1.003354 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8698034286499023 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0151506553996694 seconds
Avg batch train. time: 0.06717168851332231 seconds
Avg sample train. time: 0.0010578218663515324 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.875986 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9969968795776367 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0136378407478333 seconds
Avg batch train. time: 0.0671212613582611 seconds
Avg sample train. time: 0.0010570277379253717 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21200895309448242 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22570648789405823 seconds
Avg batch val. time: 0.022570648789405824 seconds
Avg sample val. time: 0.00035544328802213895 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.383899 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.716823 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.951202154159546 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.008835095625657 seconds
Avg batch train. time: 0.06696116985418857 seconds
Avg sample train. time: 0.0010545066118769853 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.835007 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9008448123931885 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0011215039661954 seconds
Avg batch train. time: 0.06670405013220651 seconds
Avg sample train. time: 0.001050457482396953 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20100021362304688 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2229613463083903 seconds
Avg batch val. time: 0.02229613463083903 seconds
Avg sample val. time: 0.00035112023040691383 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.167009 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.808758 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.912346363067627 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.995203161239624 seconds
Avg batch train. time: 0.0665067720413208 seconds
Avg sample train. time: 0.0010473507408082015 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.731872 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0157055854797363 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.996484562754631 seconds
Avg batch train. time: 0.06654948542515436 seconds
Avg sample train. time: 0.001048023392522116 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2080399990081787 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22146921157836913 seconds
Avg batch val. time: 0.022146921157836914 seconds
Avg sample val. time: 0.00034877041193443956 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.693658 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.707397 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.926347017288208 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.992358824786018 seconds
Avg batch train. time: 0.0664119608262006 seconds
Avg sample train. time: 0.0010458576508063087 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.569270 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8068130016326904 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.982050723499722 seconds
Avg batch train. time: 0.06606835744999073 seconds
Avg sample train. time: 0.0010404465740156022 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1985173225402832 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21938267621127042 seconds
Avg batch val. time: 0.021938267621127043 seconds
Avg sample val. time: 0.0003454845294665676 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.490246 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.620435 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8076586723327637 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9728721944909346 seconds
Avg batch train. time: 0.06576240648303115 seconds
Avg sample train. time: 0.0010356284485516717 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.643904 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7679495811462402 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9626260638236999 seconds
Avg batch train. time: 0.06542086879412333 seconds
Avg sample train. time: 0.0010302499022696587 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20978951454162598 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2185832460721334 seconds
Avg batch val. time: 0.02185832460721334 seconds
Avg sample val. time: 0.0003442255843655644 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.321222 | 
Best loss was 0.16700924550454446. Other metrics: OrderedDict([('epoch', 14), ('loss', 0.16700924550454446)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 46.16664695739746 seconds

