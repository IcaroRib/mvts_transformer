Running:
main.py --output_dir experiments/curitiba_83842/ --comment regression for curitiba_83842 --name curitiba_83842_Regression --records_file experiments/curitiba_83842/curitiba_83842_Regression.xls --data_dir datasets/files/curitiba_83842/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1905 samples may be used for training
635 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17192316055297852 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17192316055297852 seconds
Avg batch val. time: 0.017192316055297852 seconds
Avg sample val. time: 0.0002707451347291 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 284.843420 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 339.256994 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.010263681411743 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.010263681411743 seconds
Avg batch train. time: 0.06700878938039144 seconds
Avg sample train. time: 0.0010552565256754557 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17751216888427734 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17471766471862793 seconds
Avg batch val. time: 0.01747176647186279 seconds
Avg sample val. time: 0.00027514592869075263 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 264.651483 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 275.798533 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7951860427856445 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9027248620986938 seconds
Avg batch train. time: 0.06342416206995646 seconds
Avg sample train. time: 0.000998805701889078 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21306991577148438 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18750174840291342 seconds
Avg batch val. time: 0.01875017484029134 seconds
Avg sample val. time: 0.00029527834394159596 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 199.229298 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 188.014885 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.370763063430786 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.058737595876058 seconds
Avg batch train. time: 0.06862458652920193 seconds
Avg sample train. time: 0.0010807021500661722 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 98.627693 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.088188648223877 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0661003589630127 seconds
Avg batch train. time: 0.06887001196543376 seconds
Avg sample train. time: 0.0010845671175658859 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.26551175117492676 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20700424909591675 seconds
Avg batch val. time: 0.020700424909591675 seconds
Avg sample val. time: 0.0003259909434581366 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 42.570715 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 28.759946 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2879998683929443 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.110480260848999 seconds
Avg batch train. time: 0.07034934202829997 seconds
Avg sample train. time: 0.001107863653988976 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 3.963919 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.179926872253418 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.122054696083069 seconds
Avg batch train. time: 0.0707351565361023 seconds
Avg sample train. time: 0.0011139394730094849 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24201083183288574 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21400556564331055 seconds
Avg batch val. time: 0.021400556564331055 seconds
Avg sample val. time: 0.0003370166388083631 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 6.835564 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 1.559483 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1335911750793457 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1237027645111084 seconds
Avg batch train. time: 0.07079009215037028 seconds
Avg sample train. time: 0.0011148046007932327 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 1.188694 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0046799182891846 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.108824908733368 seconds
Avg batch train. time: 0.0702941636244456 seconds
Avg sample train. time: 0.0011069947027471747 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2460026741027832 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21933841705322266 seconds
Avg batch val. time: 0.021933841705322265 seconds
Avg sample val. time: 0.00034541483000507503 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 0.969738 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 1.031517 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.011009454727173 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0979565249549017 seconds
Avg batch train. time: 0.0699318841651634 seconds
Avg sample train. time: 0.001101289514412022 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.890531 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.241678476333618 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1123287200927736 seconds
Avg batch train. time: 0.07041095733642579 seconds
Avg sample train. time: 0.001108833973801981 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24924373626708984 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22361060551234654 seconds
Avg batch val. time: 0.022361060551234654 seconds
Avg sample val. time: 0.00035214268584621506 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.888212 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 1.082711 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.908994197845459 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.093843763524836 seconds
Avg batch train. time: 0.06979479211749454 seconds
Avg sample train. time: 0.001099130584527473 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.790771 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9167158603668213 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0790831049283347 seconds
Avg batch train. time: 0.06930277016427783 seconds
Avg sample train. time: 0.0010913822073114617 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21464014053344727 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22248929738998413 seconds
Avg batch val. time: 0.02224892973899841 seconds
Avg sample val. time: 0.0003503768462834396 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.077185 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.729283 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9869613647460938 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0719968172220082 seconds
Avg batch train. time: 0.06906656057406695 seconds
Avg sample train. time: 0.0010876623712451486 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.720264 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0756683349609375 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0722590684890747 seconds
Avg batch train. time: 0.06907530228296915 seconds
Avg sample train. time: 0.0010878000359522701 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2460017204284668 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22510178883870444 seconds
Avg batch val. time: 0.022510178883870444 seconds
Avg sample val. time: 0.00035449100604520385 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.584892 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.744811 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0034656524658203 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.067672840754191 seconds
Avg batch train. time: 0.0689224280251397 seconds
Avg sample train. time: 0.0010853925673250347 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.519664 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9604060649871826 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.060968667268753 seconds
Avg batch train. time: 0.0686989555756251 seconds
Avg sample train. time: 0.0010818733161515764 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22198963165283203 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2247905731201172 seconds
Avg batch val. time: 0.02247905731201172 seconds
Avg sample val. time: 0.00035400090255136566 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.218531 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.666669 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0038676261901855 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0576097824994255 seconds
Avg batch train. time: 0.06858699274998085 seconds
Avg sample train. time: 0.0010801101220469424 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.626985 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0158979892730713 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.055292460653517 seconds
Avg batch train. time: 0.06850974868845056 seconds
Avg sample train. time: 0.0010788936801330797 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23718619346618652 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2259174476970326 seconds
Avg batch val. time: 0.02259174476970326 seconds
Avg sample val. time: 0.0003557755081843033 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.127318 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.633591 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9909851551055908 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.051907865624679 seconds
Avg batch train. time: 0.06839692885415596 seconds
Avg sample train. time: 0.0010771169898292278 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.421643 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9522240161895752 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0469236731529237 seconds
Avg batch train. time: 0.06823078910509746 seconds
Avg sample train. time: 0.0010745006158283065 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2299973964691162 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22625744342803955 seconds
Avg batch val. time: 0.022625744342803955 seconds
Avg sample val. time: 0.00035631093453234575 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.695921 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.458210 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9903838634490967 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0442313012622653 seconds
Avg batch train. time: 0.06814104337540884 seconds
Avg sample train. time: 0.001073087297250533 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.448921 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9475529193878174 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0398368293588813 seconds
Avg batch train. time: 0.06799456097862938 seconds
Avg sample train. time: 0.001070780487852431 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22733592987060547 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22634040392362154 seconds
Avg batch val. time: 0.022634040392362154 seconds
Avg sample val. time: 0.00035644158098208117 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 0.749794 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.450037 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9392623901367188 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.03546402765357 seconds
Avg batch train. time: 0.06784880092178566 seconds
Avg sample train. time: 0.0010684850538863883 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.791869 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.3346729278564453 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.047931065162023 seconds
Avg batch train. time: 0.0682643688387341 seconds
Avg sample train. time: 0.0010750294305312458 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2570028305053711 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22853057725088938 seconds
Avg batch val. time: 0.022853057725088936 seconds
Avg sample val. time: 0.0003598906728360463 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 0.643368 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.641396 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.093769073486328 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0497645854949953 seconds
Avg batch train. time: 0.06832548618316651 seconds
Avg sample train. time: 0.0010759919083963229 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.634230 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.989687204360962 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.04745391698984 seconds
Avg batch train. time: 0.06824846389966134 seconds
Avg sample train. time: 0.0010747789590497849 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21504426002502441 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2276314894358317 seconds
Avg batch val. time: 0.02276314894358317 seconds
Avg sample val. time: 0.00035847478651312076 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 0.226191 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.580069 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9583032131195068 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0441520390687167 seconds
Avg batch train. time: 0.06813840130229055 seconds
Avg sample train. time: 0.0010730456897998513 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.484775 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0471208095550537 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0442580665860857 seconds
Avg batch train. time: 0.06814193555286953 seconds
Avg sample train. time: 0.0010731013472892838 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2340238094329834 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2280310094356537 seconds
Avg batch val. time: 0.022803100943565368 seconds
Avg sample val. time: 0.0003591039518671712 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 0.122219 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.582133 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0136094093322754 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0432012163359543 seconds
Avg batch train. time: 0.06810670721119848 seconds
Avg sample train. time: 0.0010725465702550942 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.610817 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.060072422027588 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.043763589859009 seconds
Avg batch train. time: 0.0681254529953003 seconds
Avg sample train. time: 0.001072841779453548 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23699688911437988 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22855841412263758 seconds
Avg batch val. time: 0.02285584141226376 seconds
Avg sample val. time: 0.00035993451042935055 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 0.254339 | 
Best loss was 0.12221944914089414. Other metrics: OrderedDict([('epoch', 28), ('loss', 0.12221944914089414)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 9.239891052246094 seconds

