Running:
main.py --output_dir experiments/curitiba_83842/ --comment regression for curitiba_83842 --name curitiba_83842_Regression --records_file experiments/curitiba_83842/curitiba_83842_Regression.xls --data_dir datasets/files/curitiba_83842/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0025 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1905 samples may be used for training
635 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21600937843322754 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21600937843322754 seconds
Avg batch val. time: 0.021600937843322753 seconds
Avg sample val. time: 0.00034017224950114573 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 538.658911 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 319.436878 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9953842163085938 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9953842163085938 seconds
Avg batch train. time: 0.06651280721028646 seconds
Avg sample train. time: 0.001047445782839157 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22000360488891602 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21800649166107178 seconds
Avg batch val. time: 0.02180064916610718 seconds
Avg sample val. time: 0.00034331730970247525 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 203.401404 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 179.950166 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.932999610900879 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9641919136047363 seconds
Avg batch train. time: 0.06547306378682455 seconds
Avg sample train. time: 0.0010310718706586543 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18569135665893555 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20723477999369302 seconds
Avg batch val. time: 0.020723477999369303 seconds
Avg sample val. time: 0.00032635398424203627 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 88.593986 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 41.532503 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9715688228607178 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9666508833567302 seconds
Avg batch train. time: 0.06555502944522434 seconds
Avg sample train. time: 0.0010323626684287297 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 2.957464 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9936845302581787 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9734092950820923 seconds
Avg batch train. time: 0.06578030983606974 seconds
Avg sample train. time: 0.0010359103911192085 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22909188270568848 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2126990556716919 seconds
Avg batch val. time: 0.02126990556716919 seconds
Avg sample val. time: 0.000334959142790066 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 1.630120 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.447614 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9805247783660889 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9748323917388917 seconds
Avg batch train. time: 0.06582774639129639 seconds
Avg sample train. time: 0.0010366574234849826 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 1.152731 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9833202362060547 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9762470324834187 seconds
Avg batch train. time: 0.06587490108278063 seconds
Avg sample train. time: 0.0010374000170516634 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2220015525817871 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21455955505371094 seconds
Avg batch val. time: 0.021455955505371094 seconds
Avg sample val. time: 0.00033788906307671016 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 0.936679 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.852746 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.972330093383789 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9756874697549003 seconds
Avg batch train. time: 0.06585624899183001 seconds
Avg sample train. time: 0.0010371062833359056 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.951944 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0832011699676514 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9891266822814941 seconds
Avg batch train. time: 0.06630422274271647 seconds
Avg sample train. time: 0.001044160988074275 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23400139808654785 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21779986222585043 seconds
Avg batch val. time: 0.021779986222585042 seconds
Avg sample val. time: 0.0003429919090170873 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 0.670390 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.911255 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0476598739624023 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9956303702460394 seconds
Avg batch train. time: 0.06652101234153465 seconds
Avg sample train. time: 0.0010475749975044826 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.827098 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9805243015289307 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9941197633743286 seconds
Avg batch train. time: 0.06647065877914429 seconds
Avg sample train. time: 0.0010467820280180202 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23028087615966797 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21958286421639578 seconds
Avg batch val. time: 0.021958286421639578 seconds
Avg sample val. time: 0.00034579978616755243 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.304543 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.929173 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0832459926605225 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0022221478548916 seconds
Avg batch train. time: 0.06674073826182972 seconds
Avg sample train. time: 0.0010510352482177908 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.819681 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.079637050628662 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.008673389752706 seconds
Avg batch train. time: 0.06695577965842353 seconds
Avg sample train. time: 0.0010544217269043076 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22999262809753418 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22088408470153809 seconds
Avg batch val. time: 0.02208840847015381 seconds
Avg sample val. time: 0.00034784895228588675 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.437575 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 1.005050 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.4461491107940674 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.042325368294349 seconds
Avg batch train. time: 0.0680775122764783 seconds
Avg sample train. time: 0.0010720868075035953 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.888159 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.542891263961792 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0780800751277377 seconds
Avg batch train. time: 0.06926933583759126 seconds
Avg sample train. time: 0.001090855682481752 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24477934837341309 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22353911399841309 seconds
Avg batch val. time: 0.02235391139984131 seconds
Avg sample val. time: 0.0003520301007849025 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.962192 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 1.027897 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0539019107818604 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0764681975046795 seconds
Avg batch train. time: 0.06921560658348931 seconds
Avg sample train. time: 0.0010900095524958948 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 1.572511 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9386708736419678 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.06785586476326 seconds
Avg batch train. time: 0.068928528825442 seconds
Avg sample train. time: 0.0010854886429203464 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24302172660827637 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2254873752593994 seconds
Avg batch val. time: 0.02254873752593994 seconds
Avg sample val. time: 0.0003550982287549597 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.190478 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.869099 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9588181972503662 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.061441884321325 seconds
Avg batch train. time: 0.0687147294773775 seconds
Avg sample train. time: 0.0010821217240531888 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.962919 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8969616889953613 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.052304095692105 seconds
Avg batch train. time: 0.06841013652307017 seconds
Avg sample train. time: 0.0010773249846152781 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23800182342529297 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22662505236538974 seconds
Avg batch val. time: 0.022662505236538975 seconds
Avg sample val. time: 0.00035688984624470825 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.326889 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.706264 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8970341682434082 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0441319942474365 seconds
Avg batch train. time: 0.06813773314158121 seconds
Avg sample train. time: 0.0010730351675839562 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.876684 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.881410837173462 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.035995936393738 seconds
Avg batch train. time: 0.0678665312131246 seconds
Avg sample train. time: 0.0010687642710728283 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23209595680236816 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22708096106847128 seconds
Avg batch val. time: 0.02270809610684713 seconds
Avg sample val. time: 0.000357607812706254 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.753830 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.897582 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.999993085861206 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0342815149398077 seconds
Avg batch train. time: 0.06780938383132692 seconds
Avg sample train. time: 0.001067864312304361 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.727613 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.905059576034546 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.028407790444114 seconds
Avg batch train. time: 0.0676135930148038 seconds
Avg sample train. time: 0.0010647809923591148 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23598933219909668 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2277662203862117 seconds
Avg batch val. time: 0.02277662203862117 seconds
Avg sample val. time: 0.00035868696123812863 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 2.959254 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.820896 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9075443744659424 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0231528593146284 seconds
Avg batch train. time: 0.06743842864382095 seconds
Avg sample train. time: 0.0010620224983278889 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.696324 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8522980213165283 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0160339077313743 seconds
Avg batch train. time: 0.06720113025771247 seconds
Avg sample train. time: 0.0010582855158694877 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22611021995544434 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22764793464115687 seconds
Avg batch val. time: 0.02276479346411569 seconds
Avg sample val. time: 0.0003585006844742628 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 2.403635 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.789906 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8062841892242432 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.007643918991089 seconds
Avg batch train. time: 0.06692146396636962 seconds
Avg sample train. time: 0.0010538813223050336 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.736497 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8391425609588623 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.001163097528311 seconds
Avg batch train. time: 0.06670543658427702 seconds
Avg sample train. time: 0.001050479316287827 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24399995803833008 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22873806953430176 seconds
Avg batch val. time: 0.022873806953430175 seconds
Avg sample val. time: 0.00036021743233748306 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 0.172443 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.649460 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0415713787078857 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.002659700534962 seconds
Avg batch train. time: 0.0667553233511654 seconds
Avg sample train. time: 0.001051264934664022 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.864306 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.372913122177124 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.015883037022182 seconds
Avg batch train. time: 0.06719610123407273 seconds
Avg sample train. time: 0.0010582063186468146 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.4270014762878418 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.241129532456398 seconds
Avg batch val. time: 0.0241129532456398 seconds
Avg sample val. time: 0.0003797315471754299 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 1.050660 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.645498 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1899497509002686 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.021885337500737 seconds
Avg batch train. time: 0.06739617791669122 seconds
Avg sample train. time: 0.0010613571325463185 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.840857 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2627921104431152 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0299155632654826 seconds
Avg batch train. time: 0.06766385210884943 seconds
Avg sample train. time: 0.001065572474155109 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.28600096702575684 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24376902860753677 seconds
Avg batch val. time: 0.024376902860753676 seconds
Avg sample val. time: 0.000383888234027617 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 1.794845 | 
Best loss was 0.17244333657692737. Other metrics: OrderedDict([('epoch', 26), ('loss', 0.17244333657692737)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 9.192363262176514 seconds

