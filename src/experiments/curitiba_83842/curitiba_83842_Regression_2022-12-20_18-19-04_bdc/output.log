Running:
main.py --output_dir experiments/curitiba_83842/ --comment regression for curitiba_83842 --name curitiba_83842_Regression --records_file experiments/curitiba_83842/curitiba_83842_Regression.xls --data_dir datasets/files/curitiba_83842/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1905 samples may be used for training
635 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19801115989685059 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19801115989685059 seconds
Avg batch val. time: 0.019801115989685057 seconds
Avg sample val. time: 0.0003118285982627568 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 259.826310 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 266.527142 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7436537742614746 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7436537742614746 seconds
Avg batch train. time: 0.05812179247538249 seconds
Avg sample train. time: 0.0009153038185099605 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20700812339782715 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20250964164733887 seconds
Avg batch val. time: 0.020250964164733886 seconds
Avg sample val. time: 0.0003189128214918722 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 116.107847 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 62.048154 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7625343799591064 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7530940771102905 seconds
Avg batch train. time: 0.05843646923700969 seconds
Avg sample train. time: 0.0009202593580631447 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19700193405151367 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20067373911539713 seconds
Avg batch val. time: 0.02006737391153971 seconds
Avg sample val. time: 0.0003160216364022002 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 6.896824 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 2.722467 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7996439933776855 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7686107158660889 seconds
Avg batch train. time: 0.05895369052886963 seconds
Avg sample train. time: 0.0009284045752577894 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.453420 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8725464344024658 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.794594645500183 seconds
Avg batch train. time: 0.05981982151667277 seconds
Avg sample train. time: 0.0009420444333334294 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22899341583251953 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20775365829467773 seconds
Avg batch val. time: 0.020775365829467773 seconds
Avg sample val. time: 0.00032717111542468935 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 1.230760 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 0.867112 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9280345439910889 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8212826251983643 seconds
Avg batch train. time: 0.060709420839945474 seconds
Avg sample train. time: 0.0009560538714952043 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.925697 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9278476238250732 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8390434583028157 seconds
Avg batch train. time: 0.06130144861009386 seconds
Avg sample train. time: 0.0009653771434660449 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23500299453735352 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2132035255432129 seconds
Avg batch val. time: 0.02132035255432129 seconds
Avg sample val. time: 0.00033575358353261876 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 0.635684 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.970949 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9506807327270508 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8549916403634208 seconds
Avg batch train. time: 0.06183305467878069 seconds
Avg sample train. time: 0.0009737488925792235 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 1.467359 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9434902667999268 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.866053968667984 seconds
Avg batch train. time: 0.06220179895559947 seconds
Avg sample train. time: 0.0009795558890645585 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24099278450012207 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21783506870269775 seconds
Avg batch val. time: 0.021783506870269774 seconds
Avg sample val. time: 0.000343047352287713 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 1.959423 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 2.063806 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.023562431335449 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.883554908964369 seconds
Avg batch train. time: 0.06278516363214563 seconds
Avg sample train. time: 0.0009887427343644982 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.759767 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0374481678009033 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8989442348480225 seconds
Avg batch train. time: 0.06329814116160075 seconds
Avg sample train. time: 0.00099682112065513 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24613094329833984 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2218773365020752 seconds
Avg batch val. time: 0.02218773365020752 seconds
Avg sample val. time: 0.0003494131283497247 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.385543 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.886179 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.072429895401001 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.914715658534657 seconds
Avg batch train. time: 0.06382385528448857 seconds
Avg sample train. time: 0.0010051000832202923 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 1.196064 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0536928176879883 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.926297088464101 seconds
Avg batch train. time: 0.06420990294880337 seconds
Avg sample train. time: 0.0010111795739969035 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24368596076965332 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22460341453552246 seconds
Avg batch val. time: 0.022460341453552246 seconds
Avg sample val. time: 0.00035370616462287004 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.358927 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 1.556690 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0770814418792725 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.937895884880653 seconds
Avg batch train. time: 0.06459652949602177 seconds
Avg sample train. time: 0.0010172681810397127 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.993519 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.144430637359619 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.952648367200579 seconds
Avg batch train. time: 0.06508827890668596 seconds
Avg sample train. time: 0.0010250122662470232 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24053072929382324 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22637311617533365 seconds
Avg batch val. time: 0.022637311617533365 seconds
Avg sample val. time: 0.0003564930963391081 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 4.319811 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 1.063939 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0927653312683105 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9619894981384278 seconds
Avg batch train. time: 0.0653996499379476 seconds
Avg sample train. time: 0.0010299157470542927 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 1.161055 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0980770587921143 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9704949706792831 seconds
Avg batch train. time: 0.06568316568930944 seconds
Avg sample train. time: 0.0010343805620363692 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24172210693359375 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22790801525115967 seconds
Avg batch val. time: 0.022790801525115967 seconds
Avg sample val. time: 0.0003589102602380467 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 1.200167 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.951514 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.497067928314209 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.001469850540161 seconds
Avg batch train. time: 0.06671566168467204 seconds
Avg sample train. time: 0.0010506403414908983 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 1.234041 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.619272232055664 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0357922050688 seconds
Avg batch train. time: 0.06785974016896 seconds
Avg sample train. time: 0.001068657325495433 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2695281505584717 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23169166391546075 seconds
Avg batch val. time: 0.023169166391546075 seconds
Avg sample val. time: 0.0003648687620715917 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.377927 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 1.603707 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1560745239257812 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.042122853429694 seconds
Avg batch train. time: 0.0680707617809898 seconds
Avg sample train. time: 0.0010719805004880283 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 1.452623 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1861159801483154 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.049322509765625 seconds
Avg batch train. time: 0.06831075032552084 seconds
Avg sample train. time: 0.0010757598476459974 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25929927825927734 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23399229844411215 seconds
Avg batch val. time: 0.023399229844411215 seconds
Avg sample val. time: 0.000368491808573405 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 3.819840 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 1.418111 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.179553747177124 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0555239972614108 seconds
Avg batch train. time: 0.06851746657538035 seconds
Avg sample train. time: 0.0010790152216595332 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 1.146310 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.219996929168701 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.063000039620833 seconds
Avg batch train. time: 0.0687666679873611 seconds
Avg sample train. time: 0.0010829396533442693 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2610008716583252 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2360698809990516 seconds
Avg batch val. time: 0.02360698809990516 seconds
Avg sample val. time: 0.0003717635921244907 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 6.162390 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 1.898993 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.5288679599761963 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.083255166592805 seconds
Avg batch train. time: 0.06944183888642684 seconds
Avg sample train. time: 0.0010935722659279818 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 1.465382 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.207263708114624 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0884221891562142 seconds
Avg batch train. time: 0.0696140729718738 seconds
Avg sample train. time: 0.0010962846137302963 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24700117111206055 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2368506874356951 seconds
Avg batch val. time: 0.023685068743569508 seconds
Avg sample val. time: 0.00037299320856014974 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 5.127481 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 1.433320 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1705379486083984 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0917068195343016 seconds
Avg batch train. time: 0.0697235606511434 seconds
Avg sample train. time: 0.0010980088291518643 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 1.063154 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.175011157989502 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0949108325518093 seconds
Avg batch train. time: 0.06983036108506031 seconds
Avg sample train. time: 0.0010996907257489813 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.255035400390625 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23806300163269042 seconds
Avg batch val. time: 0.023806300163269043 seconds
Avg sample val. time: 0.0003749023647758904 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 0.187538 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 1.179665 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2134931087493896 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0993027687072754 seconds
Avg batch train. time: 0.06997675895690918 seconds
Avg sample train. time: 0.001101996204045814 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 1.484059 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.4586586952209473 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1121369089399065 seconds
Avg batch train. time: 0.07040456363133021 seconds
Avg sample train. time: 0.0011087332855327593 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2535243034362793 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23902933299541473 seconds
Avg batch val. time: 0.023902933299541473 seconds
Avg sample val. time: 0.000376424146449472 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 2.735651 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 1.172834 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2503576278686523 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.116903140627105 seconds
Avg batch train. time: 0.0705634380209035 seconds
Avg sample train. time: 0.0011112352444236772 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 1.397410 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 3.121154308319092 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.150378179550171 seconds
Avg batch train. time: 0.07167927265167237 seconds
Avg sample train. time: 0.001128807443333423 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23998141288757324 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23908533769495346 seconds
Avg batch val. time: 0.023908533769495345 seconds
Avg sample val. time: 0.00037651234282669836 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 5.358038 | 
Best loss was 0.1875378375916969. Other metrics: OrderedDict([('epoch', 26), ('loss', 0.1875378375916969)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 12.637251377105713 seconds

