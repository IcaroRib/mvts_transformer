Running:
main.py --output_dir experiments/curitiba_83842/ --comment regression for curitiba_83842 --name curitiba_83842_Regression --records_file experiments/curitiba_83842/curitiba_83842_Regression.xls --data_dir datasets/files/curitiba_83842/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.01 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1905 samples may be used for training
635 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1849973201751709 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1849973201751709 seconds
Avg batch val. time: 0.01849973201751709 seconds
Avg sample val. time: 0.0002913343624805841 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 442.722659 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 207.074442 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.948213815689087 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.948213815689087 seconds
Avg batch train. time: 0.06494046052296956 seconds
Avg sample train. time: 0.0010226844176845602 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23899221420288086 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21199476718902588 seconds
Avg batch val. time: 0.02119947671890259 seconds
Avg sample val. time: 0.0003338500270693321 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 25.003954 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 8.234490 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1028497219085693 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.025531768798828 seconds
Avg batch train. time: 0.0675177256266276 seconds
Avg sample train. time: 0.0010632712697106709 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24296140670776367 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22231698036193848 seconds
Avg batch val. time: 0.022231698036193848 seconds
Avg sample val. time: 0.00035010548088494246 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 6.467213 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 1.478812 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.048619031906128 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.033227523167928 seconds
Avg batch train. time: 0.06777425077226427 seconds
Avg sample train. time: 0.0010673110357836894 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.111420 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0291993618011475 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.032220482826233 seconds
Avg batch train. time: 0.06774068276087443 seconds
Avg sample train. time: 0.0010667824056830619 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2430555820465088 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22750163078308105 seconds
Avg batch val. time: 0.022750163078308107 seconds
Avg sample val. time: 0.0003582702846977654 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 0.293676 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.705664 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0162487030029297 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0290261268615724 seconds
Avg batch train. time: 0.06763420422871907 seconds
Avg sample train. time: 0.0010651055784050248 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 1.588927 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0490942001342773 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0323708057403564 seconds
Avg batch train. time: 0.06774569352467855 seconds
Avg sample train. time: 0.0010668613153492685 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23418641090393066 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22883858680725097 seconds
Avg batch val. time: 0.022883858680725098 seconds
Avg sample val. time: 0.0003603757272555133 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 5.202196 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 1.358244 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.062459945678711 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0366692543029785 seconds
Avg batch train. time: 0.06788897514343262 seconds
Avg sample train. time: 0.0010691177187942145 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 1.165046 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0074942111968994 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0330223739147186 seconds
Avg batch train. time: 0.06776741246382395 seconds
Avg sample train. time: 0.0010672033458869914 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25699353218078613 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23353107770284018 seconds
Avg batch val. time: 0.02335310777028402 seconds
Avg sample val. time: 0.0003677654766973861 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 2.085915 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 1.654690 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.055539131164551 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0355242358313665 seconds
Avg batch train. time: 0.06785080786104555 seconds
Avg sample train. time: 0.0010685166592290637 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 1.531397 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.021440267562866 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0341158390045164 seconds
Avg batch train. time: 0.06780386130015055 seconds
Avg sample train. time: 0.0010677773433094575 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2610507011413574 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2374624524797712 seconds
Avg batch val. time: 0.02374624524797712 seconds
Avg sample val. time: 0.00037395661807837987 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.704029 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 1.496720 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0911951065063477 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0393048633228648 seconds
Avg batch train. time: 0.06797682877742882 seconds
Avg sample train. time: 0.0010705012405894303 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 1.962400 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0405125617980957 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0394055048624673 seconds
Avg batch train. time: 0.06798018349541558 seconds
Avg sample train. time: 0.001070554070793946 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25407886505126953 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2395395040512085 seconds
Avg batch val. time: 0.023953950405120848 seconds
Avg sample val. time: 0.000377227565434974 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.837064 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 1.804053 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.068837881088257 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0416695338029127 seconds
Avg batch train. time: 0.06805565112676376 seconds
Avg sample train. time: 0.0010717425374293505 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 1.575103 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0442135334014893 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0418512480599538 seconds
Avg batch train. time: 0.06806170826866513 seconds
Avg sample train. time: 0.0010718379254907894 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2445049285888672 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24009121788872612 seconds
Avg batch val. time: 0.02400912178887261 seconds
Avg sample val. time: 0.0003780964061239781 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 1.353014 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 2.093985 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0161006450653076 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0401345411936442 seconds
Avg batch train. time: 0.0680044847064548 seconds
Avg sample train. time: 0.0010709367670307844 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 1.386389 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.028949022293091 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0394354462623596 seconds
Avg batch train. time: 0.06798118154207865 seconds
Avg sample train. time: 0.0010705697880642308 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24507975578308105 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24059007167816163 seconds
Avg batch val. time: 0.024059007167816164 seconds
Avg sample val. time: 0.0003788820026427742 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 1.512334 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 2.335518 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.013176918029785 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0378908269545613 seconds
Avg batch train. time: 0.0679296942318187 seconds
Avg sample train. time: 0.0010697589642806097 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 1.821518 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.961620807647705 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0336536036597357 seconds
Avg batch train. time: 0.06778845345532453 seconds
Avg sample train. time: 0.0010675347000838507 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23862934112548828 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2404118234461004 seconds
Avg batch val. time: 0.02404118234461004 seconds
Avg sample val. time: 0.00037860129676551245 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 1.489355 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 2.006654 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9386556148529053 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.028653709512008 seconds
Avg batch train. time: 0.06762179031706693 seconds
Avg sample train. time: 0.0010649100837333376 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 1.542233 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.034648895263672 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.028953468799591 seconds
Avg batch train. time: 0.0676317822933197 seconds
Avg sample train. time: 0.0010650674376900741 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25699615478515625 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24179385105768839 seconds
Avg batch val. time: 0.02417938510576884 seconds
Avg sample val. time: 0.00038077771820108406 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 0.850248 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 1.530910 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.01212477684021 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.028152102515811 seconds
Avg batch train. time: 0.06760507008386037 seconds
Avg sample train. time: 0.001064646772974179 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 1.245339 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9561271667480469 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0248782417990943 seconds
Avg batch train. time: 0.06749594139330314 seconds
Avg sample train. time: 0.0010629282109181598 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23499226570129395 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24127065218411958 seconds
Avg batch val. time: 0.02412706521841196 seconds
Avg sample val. time: 0.00037995378296711745 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 1.205591 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 1.115499 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9950530529022217 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.023581494455752 seconds
Avg batch train. time: 0.0674527164818584 seconds
Avg sample train. time: 0.0010622475036513135 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 1.723302 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0215656757354736 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0234975020090737 seconds
Avg batch train. time: 0.06744991673363579 seconds
Avg sample train. time: 0.0010622034131281227 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22799158096313477 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24032214709690639 seconds
Avg batch val. time: 0.02403221470969064 seconds
Avg sample val. time: 0.0003784600741683565 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 2.993025 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 1.946111 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9491221904754639 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0205224895477296 seconds
Avg batch train. time: 0.06735074965159099 seconds
Avg sample train. time: 0.0010606417267967085 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 1.376641 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9463520050048828 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.017669778603774 seconds
Avg batch train. time: 0.06725565928679247 seconds
Avg sample train. time: 0.0010591442407368893 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22099709510803223 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2390338102976481 seconds
Avg batch val. time: 0.02390338102976481 seconds
Avg sample val. time: 0.0003764311973191309 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 4.171684 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 1.484186 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9459125995635986 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0150121053059897 seconds
Avg batch train. time: 0.06716707017686632 seconds
Avg sample train. time: 0.001057749136643564 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 1.617834 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0749404430389404 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0171524030821666 seconds
Avg batch train. time: 0.06723841343607222 seconds
Avg sample train. time: 0.0010588726525365703 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22423386573791504 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2381088137626648 seconds
Avg batch val. time: 0.02381088137626648 seconds
Avg sample val. time: 0.00037497450986246424 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 6.153463 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 1.454599 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0717060565948486 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.019033563548121 seconds
Avg batch train. time: 0.06730111878493736 seconds
Avg sample train. time: 0.0010598601383454702 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 1.220211 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9617054462432861 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0171226263046265 seconds
Avg batch train. time: 0.06723742087682089 seconds
Avg sample train. time: 0.0010588570216822186 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21000266075134277 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23645551064435175 seconds
Avg batch val. time: 0.023645551064435173 seconds
Avg sample val. time: 0.00037237088290449096 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 9.264435 | 
Best loss was 0.29367614806167724. Other metrics: OrderedDict([('epoch', 4), ('loss', 0.29367614806167724)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 8.480695247650146 seconds

