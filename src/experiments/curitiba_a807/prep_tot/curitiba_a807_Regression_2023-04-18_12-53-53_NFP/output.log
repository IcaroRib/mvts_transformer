Running:
main.py --output_dir experiments/curitiba_a807/prep_tot --comment regression for curitiba_a807 --name curitiba_a807_Regression --records_file experiments/curitiba_a807/prep_tot/curitiba_a807_Regression.xls --data_dir datasets/files_v2/curitiba_a807/prep_tot/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.005 --optimizer Adam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
2668 samples may be used for training
832 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=16, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 154113
Trainable parameters: 154113
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.5949089527130127 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5949089527130127 seconds
Avg batch val. time: 0.12268530405484714 seconds
Avg sample val. time: 0.0019169578758569865 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 119.080876 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 42.893430 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.857532024383545 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.857532024383545 seconds
Avg batch train. time: 0.3537507624853225 seconds
Avg sample train. time: 0.005568790114086786 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.5579123497009277 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5764106512069702 seconds
Avg batch val. time: 0.12126235778515156 seconds
Avg sample val. time: 0.001894724340392993 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 109.726601 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 42.263168 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.426113605499268 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.141822814941406 seconds
Avg batch train. time: 0.36051959083193824 seconds
Avg sample train. time: 0.005675345882661696 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.5011727809906006 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.551331361134847 seconds
Avg batch val. time: 0.11933318162575746 seconds
Avg sample val. time: 0.0018645809629024603 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 105.016870 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 41.070688 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.659437417984009 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.981027682622274 seconds
Avg batch train. time: 0.3566911353005303 seconds
Avg sample train. time: 0.005615077842062321 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 42.029956 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.668808221817017 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.90297281742096 seconds
Avg batch train. time: 0.3548326861290705 seconds
Avg sample train. time: 0.005585821895585067 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.3071424961090088 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.4902841448783875 seconds
Avg batch val. time: 0.11463724191372211 seconds
Avg sample val. time: 0.001791206904901908 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 108.336153 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 41.341574 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.319480657577515 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.78627438545227 seconds
Avg batch train. time: 0.35205415203457785 seconds
Avg sample train. time: 0.005542081853617793 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 42.761794 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.231406211853027 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.86046302318573 seconds
Avg batch train. time: 0.3538205481710888 seconds
Avg sample train. time: 0.005569888689349974 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.5500295162200928 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5022332191467285 seconds
Avg batch val. time: 0.11555640147282527 seconds
Avg sample val. time: 0.0018055687730128948 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 105.099998 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 43.266289 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.52587628364563 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.812664917537145 seconds
Avg batch train. time: 0.3526824980365987 seconds
Avg sample train. time: 0.00555197335739773 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 43.260728 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.777355432510376 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.933251231908798 seconds
Avg batch train. time: 0.3555536007597333 seconds
Avg sample train. time: 0.005597170626652473 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.6180341243743896 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5215333700180054 seconds
Avg batch val. time: 0.1170410284629235 seconds
Avg sample val. time: 0.0018287660697331796 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 105.217712 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 43.369196 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.572489023208618 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.004277653164333 seconds
Avg batch train. time: 0.35724470602772224 seconds
Avg sample train. time: 0.005623792223824713 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 42.390717 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.420263528823853 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.045876240730285 seconds
Avg batch train. time: 0.35823514858881633 seconds
Avg sample train. time: 0.0056393838983246946 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.6838295459747314 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5447185380118233 seconds
Avg batch val. time: 0.11882450292398641 seconds
Avg sample val. time: 0.0018566328581872877 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 106.183110 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 41.821967 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.140880107879639 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.05451295592568 seconds
Avg batch train. time: 0.35844078466489715 seconds
Avg sample train. time: 0.005642621047948156 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 43.267282 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 13.941452741622925 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.961757938067118 seconds
Avg batch train. time: 0.3562323318587409 seconds
Avg sample train. time: 0.005607855299125606 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.4047656059265137 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5272244215011597 seconds
Avg batch val. time: 0.11747880165393536 seconds
Avg sample val. time: 0.00183560627584274 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 106.031479 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 43.361935 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.571957349777222 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.931773277429434 seconds
Avg batch train. time: 0.35551841136736745 seconds
Avg sample train. time: 0.005596616670700687 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 42.925008 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.683274507522583 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.91402336529323 seconds
Avg batch train. time: 0.3550957944117436 seconds
Avg sample train. time: 0.005589963780094914 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.5361521244049072 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.528216388490465 seconds
Avg batch val. time: 0.11755510680695884 seconds
Avg sample val. time: 0.0018367985438587319 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 109.128686 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 42.840122 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.397389650344849 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.946247784296672 seconds
Avg batch train. time: 0.35586304248325407 seconds
Avg sample train. time: 0.005602041898162171 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 40.667710 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.60019040107727 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.987119197845459 seconds
Avg batch train. time: 0.35683617137727286 seconds
Avg sample train. time: 0.005617361018682706 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.5169799327850342 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.527092742919922 seconds
Avg batch val. time: 0.11746867253230169 seconds
Avg sample val. time: 0.0018354480083172138 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 109.840850 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 42.320593 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.536752939224243 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.019450594397153 seconds
Avg batch train. time: 0.35760596653326554 seconds
Avg sample train. time: 0.005629479233282291 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 43.043888 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.741342782974243 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 15.004000160429213 seconds
Avg batch train. time: 0.3572380990578384 seconds
Avg sample train. time: 0.005623688216052928 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.4230213165283203 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.517631704157049 seconds
Avg batch val. time: 0.11674090031977301 seconds
Avg sample val. time: 0.0018240765674964533 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 109.304779 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 42.697295 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 13.810542345046997 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.94118659119857 seconds
Avg batch train. time: 0.3557425378856802 seconds
Avg sample train. time: 0.005600144899249838 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 43.061228 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.918839931488037 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.940069258213043 seconds
Avg batch train. time: 0.3557159347193582 seconds
Avg sample train. time: 0.0055997261087755035 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.512836217880249 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.517232080300649 seconds
Avg batch val. time: 0.11671016002312684 seconds
Avg sample val. time: 0.0018235962503613569 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 108.599715 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 42.526420 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.483583927154541 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.918331861495972 seconds
Avg batch train. time: 0.355198377654666 seconds
Avg sample train. time: 0.005591578658731624 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 42.060307 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.74088168144226 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.910265944220804 seconds
Avg batch train. time: 0.3550063320052572 seconds
Avg sample train. time: 0.005588555451357123 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.7365844249725342 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5341053375831017 seconds
Avg batch val. time: 0.11800810289100783 seconds
Avg sample val. time: 0.0018438766076719973 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 110.597149 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 42.436351 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 16.182300806045532 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.9655718077784 seconds
Avg batch train. time: 0.3563231382804381 seconds
Avg sample train. time: 0.005609284785524138 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 41.996161 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.6265230178833 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.99311144153277 seconds
Avg batch train. time: 0.35697884384601836 seconds
Avg sample train. time: 0.005619606987081248 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.626633644104004 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5407145023345947 seconds
Avg batch val. time: 0.1185165001795842 seconds
Avg sample val. time: 0.0018518203153060032 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 107.293460 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 41.099038 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 11.089514970779419 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.836967582702636 seconds
Avg batch train. time: 0.3532611329214913 seconds
Avg sample train. time: 0.005561082302362307 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 41.161526 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.941979885101318 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.841006517410278 seconds
Avg batch train. time: 0.35335729803357807 seconds
Avg sample train. time: 0.005562596145955876 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.7127506732940674 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5521835803985595 seconds
Avg batch val. time: 0.11939873695373535 seconds
Avg sample val. time: 0.0018656052649021148 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 110.749387 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 40.806884 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.314684629440308 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.858550151189169 seconds
Avg batch train. time: 0.3537750035997421 seconds
Avg sample train. time: 0.005569171720835521 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 42.191580 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 14.889544010162354 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.859657074723925 seconds
Avg batch train. time: 0.3538013589219982 seconds
Avg sample train. time: 0.005569586609716614 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.6317212581634521 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5571546852588654 seconds
Avg batch val. time: 0.11978112963529733 seconds
Avg sample val. time: 0.0018715801505515208 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 107.144220 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 41.430525 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 15.714251279830933 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.88912584041727 seconds
Avg batch train. time: 0.3545029962004112 seconds
Avg sample train. time: 0.005580631874219366 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 42.192948 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 16.12106418609619 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 14.9301904519399 seconds
Avg batch train. time: 0.3554807250461881 seconds
Avg sample train. time: 0.005596023407773576 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 1.6991593837738037 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 1.5655079028185677 seconds
Avg batch val. time: 0.12042368483219751 seconds
Avg sample val. time: 0.001881620075503086 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 112.575432 | 
Best loss was 105.01687005849985. Other metrics: OrderedDict([('epoch', 2), ('loss', 105.01687005849985)])
All Done!
Total runtime: 0.0 hours, 8.0 minutes, 20.089670658111572 seconds

