Running:
main.py --output_dir experiments/manaus_82332/ --comment regression for manaus_82332 --name manaus_82332_Regression --records_file experiments/manaus_82332/manaus_82332_Regression.xls --data_dir datasets/files/manaus_82332/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1917 samples may be used for training
638 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17793822288513184 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17793822288513184 seconds
Avg batch val. time: 0.017793822288513183 seconds
Avg sample val. time: 0.0002789000358701126 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 463.401422 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 732.653440 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.847930669784546 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.847930669784546 seconds
Avg batch train. time: 0.06159768899281819 seconds
Avg sample train. time: 0.0009639700937843223 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21550226211547852 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19672024250030518 seconds
Avg batch val. time: 0.019672024250030517 seconds
Avg sample val. time: 0.0003083389380882526 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 724.388690 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 701.184717 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.3764212131500244 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.112175941467285 seconds
Avg batch train. time: 0.07040586471557617 seconds
Avg sample train. time: 0.0011018132193360904 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.28560590744018555 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2263487974802653 seconds
Avg batch val. time: 0.02263487974802653 seconds
Avg sample val. time: 0.0003547786794361525 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 694.426963 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 649.137715 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1763322353363037 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.133561372756958 seconds
Avg batch train. time: 0.07111871242523193 seconds
Avg sample train. time: 0.0011129688955435358 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 576.141465 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1892528533935547 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.147484242916107 seconds
Avg batch train. time: 0.07158280809720358 seconds
Avg sample train. time: 0.0011202317386103846 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2509901523590088 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23250913619995117 seconds
Avg batch val. time: 0.023250913619995116 seconds
Avg sample val. time: 0.00036443438275854417 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 544.025461 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 483.361086 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.3625283241271973 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1904930591583254 seconds
Avg batch train. time: 0.07301643530527752 seconds
Avg sample train. time: 0.001142667219174922 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 370.066592 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.3091306686401367 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.2102659940719604 seconds
Avg batch train. time: 0.07367553313573201 seconds
Avg sample train. time: 0.0011529817392133335 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2910032272338867 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2442079544067383 seconds
Avg batch val. time: 0.02442079544067383 seconds
Avg sample val. time: 0.0003827710884118155 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 283.109415 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 256.435080 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2607650756835938 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.217480148587908 seconds
Avg batch train. time: 0.07391600495293026 seconds
Avg sample train. time: 0.0011567449914386583 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 152.647725 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2959938049316406 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.2272943556308746 seconds
Avg batch train. time: 0.07424314518769583 seconds
Avg sample train. time: 0.0011618645569279472 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.28408002853393555 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2508533000946045 seconds
Avg batch val. time: 0.02508533000946045 seconds
Avg sample val. time: 0.00039318699074389416 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 103.534650 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 71.403925 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.245054244995117 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.229267676671346 seconds
Avg batch train. time: 0.07430892255571155 seconds
Avg sample train. time: 0.0011628939367091008 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 24.543422 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.081467628479004 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.214487671852112 seconds
Avg batch train. time: 0.07381625572840372 seconds
Avg sample train. time: 0.0011551839707105434 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24399685859680176 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24987380845206125 seconds
Avg batch val. time: 0.024987380845206124 seconds
Avg sample val. time: 0.0003916517373856759 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 15.489563 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 8.994488 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.94173526763916 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.2806010896509346 seconds
Avg batch train. time: 0.07602003632169782 seconds
Avg sample train. time: 0.0011896719299170238 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 4.762141 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.999450445175171 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.257171869277954 seconds
Avg batch train. time: 0.07523906230926514 seconds
Avg sample train. time: 0.001177450114385996 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23900890350341797 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24851569533348083 seconds
Avg batch val. time: 0.024851569533348085 seconds
Avg sample val. time: 0.00038952303343805773 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 6.199350 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 2.634189 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.194896936416626 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.2523814898270826 seconds
Avg batch train. time: 0.07507938299423608 seconds
Avg sample train. time: 0.0011749512205670748 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 2.118699 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1981334686279297 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.24850663117 seconds
Avg batch train. time: 0.07495022103900001 seconds
Avg sample train. time: 0.001172929906713615 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24152350425720215 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2477387852138943 seconds
Avg batch val. time: 0.02477387852138943 seconds
Avg sample val. time: 0.0003883053059778908 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 2.801260 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 1.676190 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.565600633621216 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.269646231333415 seconds
Avg batch train. time: 0.0756548743777805 seconds
Avg sample train. time: 0.001183957345505172 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 1.180196 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2316229343414307 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.2672697752714157 seconds
Avg batch train. time: 0.07557565917571386 seconds
Avg sample train. time: 0.0011827176709814375 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22799921035766602 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2457648277282715 seconds
Avg batch val. time: 0.02457648277282715 seconds
Avg sample val. time: 0.00038521132872769827 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 2.210890 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 1.106606 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9639441967010498 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.2494270941790413 seconds
Avg batch train. time: 0.07498090313930138 seconds
Avg sample train. time: 0.0011734100647777994 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.913945 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.934126377105713 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.2319103876749673 seconds
Avg batch train. time: 0.07439701292249891 seconds
Avg sample train. time: 0.0011642725026995134 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2090015411376953 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24242271076549182 seconds
Avg batch val. time: 0.024242271076549183 seconds
Avg sample val. time: 0.00037997290088635083 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 1.445834 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.837657 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8804383277893066 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.213411858207301 seconds
Avg batch train. time: 0.0737803952735767 seconds
Avg sample train. time: 0.0011546227742343772 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.769010 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9980320930480957 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.202642869949341 seconds
Avg batch train. time: 0.07342142899831136 seconds
Avg sample train. time: 0.0011490051486433704 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23900461196899414 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24213786919911703 seconds
Avg batch val. time: 0.024213786919911703 seconds
Avg sample val. time: 0.0003795264407509671 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 1.168947 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.678216 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9526174068450928 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1907368955158053 seconds
Avg batch train. time: 0.07302456318386018 seconds
Avg sample train. time: 0.0011427944160228509 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.544682 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0901761054992676 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1861659505150537 seconds
Avg batch train. time: 0.0728721983505018 seconds
Avg sample train. time: 0.0011404099898357088 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22764992713928223 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.24102341211759126 seconds
Avg batch val. time: 0.024102341211759127 seconds
Avg sample val. time: 0.0003777796428175412 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 1.677567 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.497425 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.971933364868164 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1768514902695366 seconds
Avg batch train. time: 0.07256171634231788 seconds
Avg sample train. time: 0.0011355511164681986 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.535052 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9985716342926025 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1694231629371643 seconds
Avg batch train. time: 0.07231410543123881 seconds
Avg sample train. time: 0.0011316761413339407 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21899628639221191 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23945004599434988 seconds
Avg batch val. time: 0.023945004599434987 seconds
Avg sample val. time: 0.00037531355171528197 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 1.733385 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.461360 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9401800632476807 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.160253438949585 seconds
Avg batch train. time: 0.07200844796498616 seconds
Avg sample train. time: 0.0011268927694051043 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.376525 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8782644271850586 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1494077077278724 seconds
Avg batch train. time: 0.07164692359092908 seconds
Avg sample train. time: 0.0011212351109691561 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20900344848632812 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23742027282714845 seconds
Avg batch val. time: 0.023742027282714843 seconds
Avg sample val. time: 0.0003721320890707656 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 3.249066 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.493629 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8770666122436523 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.139321000487716 seconds
Avg batch train. time: 0.0713107000162572 seconds
Avg sample train. time: 0.0011159733961855587 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.401932 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8820717334747314 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1301335266658237 seconds
Avg batch train. time: 0.07100445088886079 seconds
Avg sample train. time: 0.0011111807650838934 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21100354194641113 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23576922714710236 seconds
Avg batch val. time: 0.023576922714710236 seconds
Avg sample val. time: 0.0003695442431772764 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 1.046292 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.402574 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.849604845046997 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1204601238513816 seconds
Avg batch train. time: 0.07068200412837938 seconds
Avg sample train. time: 0.001106134649896391 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.373687 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.987090826034546 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1160144805908203 seconds
Avg batch train. time: 0.07053381601969401 seconds
Avg sample train. time: 0.0011038155871626605 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.229935884475708 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23542608934290268 seconds
Avg batch val. time: 0.02354260893429027 seconds
Avg sample val. time: 0.0003690064096283741 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 1.630696 | 
Best loss was 1.046292110670323. Other metrics: OrderedDict([('epoch', 28), ('loss', 1.046292110670323)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 11.485555648803711 seconds

