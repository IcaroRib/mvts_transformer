Running:
main.py --output_dir experiments/manaus_82332/ --comment regression for manaus_82332 --name manaus_82332_Regression --records_file experiments/manaus_82332/manaus_82332_Regression.xls --data_dir datasets/files/manaus_82332/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1917 samples may be used for training
638 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.16723847389221191 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.16723847389221191 seconds
Avg batch val. time: 0.01672384738922119 seconds
Avg sample val. time: 0.00026212926942352965 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 750.217470 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 726.631747 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.725388765335083 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.725388765335083 seconds
Avg batch train. time: 0.05751295884450277 seconds
Avg sample train. time: 0.000900046304295818 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24181389808654785 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20452618598937988 seconds
Avg batch val. time: 0.02045261859893799 seconds
Avg sample val. time: 0.00032057395923100295 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 709.752921 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 661.903848 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.311619997024536 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0185043811798096 seconds
Avg batch train. time: 0.06728347937266031 seconds
Avg sample train. time: 0.001052949598946171 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23300576210021973 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2140193780263265 seconds
Avg batch val. time: 0.02140193780263265 seconds
Avg sample val. time: 0.00033545357057417947 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 623.875000 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 537.697053 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0890326499938965 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0420138041178384 seconds
Avg batch train. time: 0.06806712680392794 seconds
Avg sample train. time: 0.0010652132520176517 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 372.805984 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.051381826400757 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.044355809688568 seconds
Avg batch train. time: 0.0681451936562856 seconds
Avg sample train. time: 0.0010664349554974273 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24999666213989258 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22301369905471802 seconds
Avg batch val. time: 0.022301369905471803 seconds
Avg sample val. time: 0.0003495512524368621 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 233.104915 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 205.053838 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.067246675491333 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.048933982849121 seconds
Avg batch train. time: 0.06829779942830404 seconds
Avg sample train. time: 0.0010688231522426297 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 74.351865 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1379878520965576 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0637762943903604 seconds
Avg batch train. time: 0.06879254314634535 seconds
Avg sample train. time: 0.0010765656204435891 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2526266574859619 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2289362907409668 seconds
Avg batch val. time: 0.02289362907409668 seconds
Avg sample val. time: 0.00035883431150621756 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 23.853368 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 16.067021 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.040771961212158 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0604899610791887 seconds
Avg batch train. time: 0.06868299870263962 seconds
Avg sample train. time: 0.0010748513099004635 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 6.042674 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0171380043029785 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0550709664821625 seconds
Avg batch train. time: 0.06850236554940542 seconds
Avg sample train. time: 0.001072024499990695 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24054408073425293 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2308709224065145 seconds
Avg batch val. time: 0.02308709224065145 seconds
Avg sample val. time: 0.00036186664953999137 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 7.791606 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 2.916475 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.076584577560425 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0574613677130804 seconds
Avg batch train. time: 0.06858204559043601 seconds
Avg sample train. time: 0.001073271448989609 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 1.787901 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9996235370635986 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0516775846481323 seconds
Avg batch train. time: 0.06838925282160441 seconds
Avg sample train. time: 0.0010702543477559376 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22300338745117188 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22974698884146555 seconds
Avg batch val. time: 0.022974698884146556 seconds
Avg sample val. time: 0.00036010499818411526 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 1.801005 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 1.123212 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.033555269241333 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0500301014293325 seconds
Avg batch train. time: 0.06833433671431108 seconds
Avg sample train. time: 0.001069394940756042 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.887750 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9565281867980957 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0422382752100625 seconds
Avg batch train. time: 0.06807460917366875 seconds
Avg sample train. time: 0.0010653303470057707 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2160649299621582 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22803673148155212 seconds
Avg batch val. time: 0.022803673148155214 seconds
Avg sample val. time: 0.00035742434401497196 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.072765 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.774785 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9438657760620117 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0346711598909817 seconds
Avg batch train. time: 0.06782237199636605 seconds
Avg sample train. time: 0.001061382973339062 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.568215 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9527013301849365 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0288161720548357 seconds
Avg batch train. time: 0.06762720573516119 seconds
Avg sample train. time: 0.001058328728249784 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20251727104187012 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22520123587714302 seconds
Avg batch val. time: 0.022520123587714304 seconds
Avg sample val. time: 0.00035297999353784174 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 2.168622 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.550207 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9209351539611816 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0216241041819254 seconds
Avg batch train. time: 0.06738747013939751 seconds
Avg sample train. time: 0.001054576997486659 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.500285 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.920954942703247 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.015332281589508 seconds
Avg batch train. time: 0.06717774271965027 seconds
Avg sample train. time: 0.0010512948782417882 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21465253829956055 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22414636611938477 seconds
Avg batch val. time: 0.022414636611938477 seconds
Avg sample val. time: 0.00035132659266361247 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.944007 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.451608 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8650131225585938 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0064899781171013 seconds
Avg batch train. time: 0.06688299927057004 seconds
Avg sample train. time: 0.0010466823047037565 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.550431 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8994088172912598 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.000541024737888 seconds
Avg batch train. time: 0.06668470082459627 seconds
Avg sample train. time: 0.0010435790426384392 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2129981517791748 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22313289208845657 seconds
Avg batch val. time: 0.022313289208845656 seconds
Avg sample val. time: 0.0003497380753737564 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.954151 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.421439 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.890395164489746 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.994743874198512 seconds
Avg batch train. time: 0.06649146247328373 seconds
Avg sample train. time: 0.0010405549682830004 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.467326 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0009963512420654 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9950564980506897 seconds
Avg batch train. time: 0.06650188326835632 seconds
Avg sample train. time: 0.001040718048018096 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22699689865112305 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22345489263534546 seconds
Avg batch val. time: 0.022345489263534545 seconds
Avg sample val. time: 0.0003502427784253064 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 1.761581 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.345325 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.871769905090332 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9891857079097204 seconds
Avg batch train. time: 0.06630619026365735 seconds
Avg sample train. time: 0.0010376555596816486 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.411686 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7892990112304688 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9800999489697544 seconds
Avg batch train. time: 0.06600333163232515 seconds
Avg sample train. time: 0.001032915987986309 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19399619102478027 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22118883866530198 seconds
Avg batch val. time: 0.022118883866530197 seconds
Avg sample val. time: 0.0003466909696948307 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 2.534650 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.397772 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8545687198638916 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9746420694434124 seconds
Avg batch train. time: 0.06582140231478041 seconds
Avg sample train. time: 0.0010300688938150299 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.365667 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8154664039611816 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9680097500483196 seconds
Avg batch train. time: 0.06560032500161066 seconds
Avg sample train. time: 0.0010266091549547833 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1880786418914795 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21882382461002894 seconds
Avg batch val. time: 0.021882382461002894 seconds
Avg sample val. time: 0.00034298405111289805 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 1.641170 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.341376 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8092150688171387 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9616579627990722 seconds
Avg batch train. time: 0.06538859875996908 seconds
Avg sample train. time: 0.0010232957552420824 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.314310 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8327233791351318 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.956698940350459 seconds
Avg batch train. time: 0.06522329801168197 seconds
Avg sample train. time: 0.0010207088890717053 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20244860649108887 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21773214340209962 seconds
Avg batch val. time: 0.021773214340209963 seconds
Avg sample val. time: 0.0003412729520409085 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 1.327440 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.315368 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7839863300323486 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.950302177005344 seconds
Avg batch train. time: 0.0650100725668448 seconds
Avg sample train. time: 0.0010173720276501533 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.335087 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7552921772003174 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9433375341551644 seconds
Avg batch train. time: 0.06477791780517214 seconds
Avg sample train. time: 0.0010137389327882966 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18781065940856934 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21586205065250397 seconds
Avg batch val. time: 0.021586205065250396 seconds
Avg sample val. time: 0.0003383417721826081 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 3.832114 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.455218 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7765471935272217 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9375861430990284 seconds
Avg batch train. time: 0.06458620476996761 seconds
Avg sample train. time: 0.0010107387287944854 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.327808 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7915914058685303 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9327196518580119 seconds
Avg batch train. time: 0.06442398839526706 seconds
Avg sample train. time: 0.0010082001313813313 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18700146675109863 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21416436924653895 seconds
Avg batch val. time: 0.021416436924653896 seconds
Avg sample val. time: 0.0003356808295400297 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 2.793525 | 
Best loss was 0.9440066298720978. Other metrics: OrderedDict([('epoch', 16), ('loss', 0.9440066298720978)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 5.534494638442993 seconds

