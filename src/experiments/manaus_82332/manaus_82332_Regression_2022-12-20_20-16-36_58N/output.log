Running:
main.py --output_dir experiments/manaus_82332/ --comment regression for manaus_82332 --name manaus_82332_Regression --records_file experiments/manaus_82332/manaus_82332_Regression.xls --data_dir datasets/files/manaus_82332/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0025 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1917 samples may be used for training
638 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18500185012817383 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18500185012817383 seconds
Avg batch val. time: 0.01850018501281738 seconds
Avg sample val. time: 0.00028997155192503734 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 965.336703 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 707.721713 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7265520095825195 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7265520095825195 seconds
Avg batch train. time: 0.05755173365275065 seconds
Avg sample train. time: 0.0009006531088067394 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2310032844543457 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20800256729125977 seconds
Avg batch val. time: 0.020800256729125978 seconds
Avg sample val. time: 0.0003260228327449213 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 663.352469 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 523.619009 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1159555912017822 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9212538003921509 seconds
Avg batch train. time: 0.06404179334640503 seconds
Avg sample train. time: 0.0010022189882066515 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23044371604919434 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2154829502105713 seconds
Avg batch val. time: 0.02154829502105713 seconds
Avg sample val. time: 0.0003377475708629644 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 308.910225 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 231.189128 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.128810405731201 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9904393355051677 seconds
Avg batch train. time: 0.06634797785017225 seconds
Avg sample train. time: 0.0010383095125222576 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 33.494664 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0658414363861084 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.009289860725403 seconds
Avg batch train. time: 0.06697632869084676 seconds
Avg sample train. time: 0.0010481428590116864 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22300100326538086 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21736246347427368 seconds
Avg batch val. time: 0.02173624634742737 seconds
Avg sample val. time: 0.0003406935164173569 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 9.913622 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 4.981528 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9929964542388916 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0060311794281005 seconds
Avg batch train. time: 0.06686770598093668 seconds
Avg sample train. time: 0.0010464429730976006 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 1.773528 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.984175205230713 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.002388517061869 seconds
Avg batch train. time: 0.0667462839020623 seconds
Avg sample train. time: 0.0010445427840698326 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2395191192626953 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.221793794631958 seconds
Avg batch val. time: 0.0221793794631958 seconds
Avg sample val. time: 0.0003476391765391191 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 3.212703 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 1.162762 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9779119491577148 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.998891864504133 seconds
Avg batch train. time: 0.06662972881680443 seconds
Avg sample train. time: 0.0010427187608263605 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.676708 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9687590599060059 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.995125263929367 seconds
Avg batch train. time: 0.06650417546431224 seconds
Avg sample train. time: 0.0010407539196292995 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23900055885314941 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22466158866882324 seconds
Avg batch val. time: 0.022466158866882323 seconds
Avg sample val. time: 0.0003521341515185317 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 1.752328 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.604831 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9921393394470215 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9947934945424397 seconds
Avg batch train. time: 0.066493116484748 seconds
Avg sample train. time: 0.0010405808526564632 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.426454 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9990267753601074 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9952168226242066 seconds
Avg batch train. time: 0.06650722742080689 seconds
Avg sample train. time: 0.00104080168107679 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.275998592376709 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23199544634137834 seconds
Avg batch val. time: 0.023199544634137835 seconds
Avg sample val. time: 0.0003636292262404049 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.822750 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.436338 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0107343196868896 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9966275041753596 seconds
Avg batch train. time: 0.06655425013917865 seconds
Avg sample train. time: 0.0010415375608635157 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.401722 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8383457660675049 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9834373593330383 seconds
Avg batch train. time: 0.06611457864443461 seconds
Avg sample train. time: 0.001034656942792404 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22002387046813965 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2304989993572235 seconds
Avg batch val. time: 0.023049899935722352 seconds
Avg sample val. time: 0.0003612836980520745 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.245529 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.499562 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.869692325592041 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9746877413529615 seconds
Avg batch train. time: 0.06582292471176539 seconds
Avg sample train. time: 0.001030092718493981 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.803523 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7820959091186523 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9609311819076538 seconds
Avg batch train. time: 0.06536437273025512 seconds
Avg sample train. time: 0.0010229166311464025 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2024998664855957 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22738798459370932 seconds
Avg batch val. time: 0.02273879845937093 seconds
Avg sample val. time: 0.00035640749936318073 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 5.892303 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.574005 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.786562204360962 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.949306583404541 seconds
Avg batch train. time: 0.0649768861134847 seconds
Avg sample train. time: 0.0010168526778323115 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.417729 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.786651611328125 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.939140647649765 seconds
Avg batch train. time: 0.0646380215883255 seconds
Avg sample train. time: 0.0010115496336201174 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20551586151123047 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22520077228546143 seconds
Avg batch val. time: 0.022520077228546143 seconds
Avg sample val. time: 0.00035297926690511195 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 3.595051 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.418619 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7768363952636719 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9295933386858772 seconds
Avg batch train. time: 0.06431977795619591 seconds
Avg sample train. time: 0.001006569295089138 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.474987 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8011219501495361 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9224560393227472 seconds
Avg batch train. time: 0.0640818679774249 seconds
Avg sample train. time: 0.0010028461342320018 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20999860763549805 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22381875731728293 seconds
Avg batch val. time: 0.02238187573172829 seconds
Avg sample val. time: 0.00035081309924339015 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.314582 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.348928 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7719383239746094 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.914534054304424 seconds
Avg batch train. time: 0.06381780181014747 seconds
Avg sample train. time: 0.0009987136433512907 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.406151 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7233951091766357 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9049771070480346 seconds
Avg batch train. time: 0.06349923690160116 seconds
Avg sample train. time: 0.0009937282770203623 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20400595664978027 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22216769059499106 seconds
Avg batch val. time: 0.022216769059499104 seconds
Avg sample val. time: 0.0003482252203683245 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 1.201271 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.457281 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7493698596954346 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8975672381264823 seconds
Avg batch train. time: 0.06325224127088275 seconds
Avg sample train. time: 0.000989862930686741 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.500955 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7144861221313477 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8892453692176125 seconds
Avg batch train. time: 0.06297484564058708 seconds
Avg sample train. time: 0.0009855218410107524 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20903491973876953 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22115747745220476 seconds
Avg batch val. time: 0.022115747745220477 seconds
Avg sample val. time: 0.0003466418141884087 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 1.490788 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.564395 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6896779537200928 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8805685250655464 seconds
Avg batch train. time: 0.06268561750218488 seconds
Avg sample train. time: 0.000980995579063926 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.372043 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7417347431182861 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8747837841510773 seconds
Avg batch train. time: 0.06249279280503591 seconds
Avg sample train. time: 0.000977977978169576 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20599913597106934 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22007473877498082 seconds
Avg batch val. time: 0.02200747387749808 seconds
Avg sample val. time: 0.000344944731622227 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 2.929537 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.443495 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7190515995025635 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8685544967651366 seconds
Avg batch train. time: 0.062285149892171224 seconds
Avg sample train. time: 0.0009747284803156685 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.292832 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6747722625732422 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8611013339116023 seconds
Avg batch train. time: 0.062036711130386744 seconds
Avg sample train. time: 0.0009708405497713106 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.206010103225708 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2191370964050293 seconds
Avg batch val. time: 0.02191370964050293 seconds
Avg sample val. time: 0.0003434750727351556 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 3.755235 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.383052 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7298388481140137 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8562397603635434 seconds
Avg batch train. time: 0.061874658678784784 seconds
Avg sample train. time: 0.0009683045176648636 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.385700 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.735874891281128 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8519410150391715 seconds
Avg batch train. time: 0.06173136716797238 seconds
Avg sample train. time: 0.0009660620840058276 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2090616226196289 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21850737929344177 seconds
Avg batch val. time: 0.021850737929344177 seconds
Avg sample val. time: 0.00034248805531887427 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 1.261156 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.282956 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7476904392242432 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8483461675972774 seconds
Avg batch train. time: 0.061611538919909246 seconds
Avg sample train. time: 0.0009641868375572652 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.370493 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7723793983459473 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8458139419555664 seconds
Avg batch train. time: 0.061527131398518876 seconds
Avg sample train. time: 0.0009628659060801077 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20406365394592285 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21765774839064655 seconds
Avg batch val. time: 0.021765774839064656 seconds
Avg sample val. time: 0.0003411563454398849 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 2.749254 | 
Best loss was 0.31458219689635275. Other metrics: OrderedDict([('epoch', 18), ('loss', 0.31458219689635275)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 2.9211995601654053 seconds

