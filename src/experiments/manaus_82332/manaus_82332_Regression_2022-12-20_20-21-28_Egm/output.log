Running:
main.py --output_dir experiments/manaus_82332/ --comment regression for manaus_82332 --name manaus_82332_Regression --records_file experiments/manaus_82332/manaus_82332_Regression.xls --data_dir datasets/files/manaus_82332/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1917 samples may be used for training
638 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17792868614196777 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17792868614196777 seconds
Avg batch val. time: 0.017792868614196777 seconds
Avg sample val. time: 0.0002788850879968147 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 749.576025 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 635.346732 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.698868989944458 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.698868989944458 seconds
Avg batch train. time: 0.056628966331481935 seconds
Avg sample train. time: 0.0008862123056569942 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22662615776062012 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20227742195129395 seconds
Avg batch val. time: 0.020227742195129395 seconds
Avg sample val. time: 0.0003170492507073573 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 494.661828 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 283.706433 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7367444038391113 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7178066968917847 seconds
Avg batch train. time: 0.057260223229726154 seconds
Avg sample train. time: 0.0008960911303556518 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20000052452087402 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20151845614115396 seconds
Avg batch val. time: 0.020151845614115396 seconds
Avg sample val. time: 0.0003158596491240658 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 69.775693 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 22.066907 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7178313732147217 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7178149223327637 seconds
Avg batch train. time: 0.05726049741109212 seconds
Avg sample train. time: 0.0008960954211438516 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 2.820774 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8100001811981201 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7408612370491028 seconds
Avg batch train. time: 0.05802870790163676 seconds
Avg sample train. time: 0.0009081174945483061 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21400022506713867 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20463889837265015 seconds
Avg batch val. time: 0.020463889837265013 seconds
Avg sample val. time: 0.0003207506244085426 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 16.872245 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.014341 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6985383033752441 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.732396650314331 seconds
Avg batch train. time: 0.0577465550104777 seconds
Avg sample train. time: 0.000903701956345504 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.772019 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.829958438873291 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.748656948407491 seconds
Avg batch train. time: 0.058288564946916366 seconds
Avg sample train. time: 0.000912184114975217 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19900202751159668 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20351152420043944 seconds
Avg batch val. time: 0.020351152420043945 seconds
Avg sample val. time: 0.00031898358025147247 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 4.092825 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.681054 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.922398567199707 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7734771796635218 seconds
Avg batch train. time: 0.05911590598878406 seconds
Avg sample train. time: 0.0009251315491202514 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.603560 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8959062099456787 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7887808084487915 seconds
Avg batch train. time: 0.05962602694829305 seconds
Avg sample train. time: 0.0009331146627275908 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20600271224975586 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20392672220865884 seconds
Avg batch val. time: 0.020392672220865885 seconds
Avg sample val. time: 0.0003196343608286189 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 3.567237 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.549220 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.895545244216919 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.800643523534139 seconds
Avg batch train. time: 0.0600214507844713 seconds
Avg sample train. time: 0.0009393028291779545 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.608495 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.90559983253479 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8111391544342041 seconds
Avg batch train. time: 0.0603713051478068 seconds
Avg sample train. time: 0.0009447778583381347 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21900272369384766 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20608043670654297 seconds
Avg batch val. time: 0.020608043670654295 seconds
Avg sample val. time: 0.0003230100888817288 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 3.319042 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.427612 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9447753429412842 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8232878988439387 seconds
Avg batch train. time: 0.060776263294797954 seconds
Avg sample train. time: 0.0009511152315304844 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.566755 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9575040340423584 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8344725767771404 seconds
Avg batch train. time: 0.06114908589257135 seconds
Avg sample train. time: 0.0009569497009792073 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24899816513061523 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.211445152759552 seconds
Avg batch val. time: 0.0211445152759552 seconds
Avg sample val. time: 0.00033141873473284015 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 6.912525 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.571818 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9879992008209229 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8462823170882006 seconds
Avg batch train. time: 0.06154274390294002 seconds
Avg sample train. time: 0.0009631102332228485 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.486671 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.922567367553711 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8517312492643083 seconds
Avg batch train. time: 0.06172437497547694 seconds
Avg sample train. time: 0.0009659526600231134 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24300050735473633 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21495130327012804 seconds
Avg batch val. time: 0.021495130327012803 seconds
Avg sample val. time: 0.00033691426844847656 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 3.885576 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.418020 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9749414920806885 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.859945265452067 seconds
Avg batch train. time: 0.0619981755150689 seconds
Avg sample train. time: 0.0009702374884987308 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.430909 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.018181800842285 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8698350489139557 seconds
Avg batch train. time: 0.062327834963798526 seconds
Avg sample train. time: 0.0009753964783067061 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25300121307373047 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2187562942504883 seconds
Avg batch val. time: 0.02187562942504883 seconds
Avg sample val. time: 0.00034287820415437035 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 7.803031 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.571500 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.127037763595581 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.884964620365816 seconds
Avg batch train. time: 0.06283215401219386 seconds
Avg sample train. time: 0.0009832887951830025 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.699528 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0346131324768066 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8932784265942044 seconds
Avg batch train. time: 0.06310928088647348 seconds
Avg sample train. time: 0.0009876256789745459 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2610008716583252 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22259671037847345 seconds
Avg batch val. time: 0.022259671037847345 seconds
Avg sample val. time: 0.0003488976651700211 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 5.119948 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.436913 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0589988231658936 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9020005527295565 seconds
Avg batch train. time: 0.06340001842431855 seconds
Avg sample train. time: 0.0009921755621959084 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.470707 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0151095390319824 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9076560020446778 seconds
Avg batch train. time: 0.06358853340148926 seconds
Avg sample train. time: 0.0009951257183331652 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2420024871826172 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22421385844548544 seconds
Avg batch val. time: 0.022421385844548544 seconds
Avg sample val. time: 0.0003514323800085979 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 7.297426 | 
Best loss was 3.319041930769678. Other metrics: OrderedDict([('epoch', 10), ('loss', 3.319041930769678)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 44.50512886047363 seconds

