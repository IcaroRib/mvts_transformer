Running:
main.py --output_dir experiments/manaus_82332/ --comment regression for manaus_82332 --name manaus_82332_Regression --records_file experiments/manaus_82332/manaus_82332_Regression.xls --data_dir datasets/files/manaus_82332/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1917 samples may be used for training
638 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1880025863647461 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1880025863647461 seconds
Avg batch val. time: 0.01880025863647461 seconds
Avg sample val. time: 0.0002946749002582227 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 681.138482 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 634.996430 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8359224796295166 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8359224796295166 seconds
Avg batch train. time: 0.06119741598765056 seconds
Avg sample train. time: 0.0009577060404953138 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22899961471557617 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20850110054016113 seconds
Avg batch val. time: 0.020850110054016113 seconds
Avg sample val. time: 0.0003268042328215692 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 488.737706 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 262.116054 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0817604064941406 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9588414430618286 seconds
Avg batch train. time: 0.06529471476872763 seconds
Avg sample train. time: 0.0010218265222023102 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2336564064025879 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21688620249430338 seconds
Avg batch val. time: 0.021688620249430336 seconds
Avg sample val. time: 0.0003399470258531401 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 45.010598 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 16.505525 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.051030397415161 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9895710945129395 seconds
Avg batch train. time: 0.06631903648376465 seconds
Avg sample train. time: 0.0010378565959900572 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.791360 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0258948802948 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9986520409584045 seconds
Avg batch train. time: 0.06662173469861349 seconds
Avg sample train. time: 0.0010425936572552971 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23100066184997559 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22041481733322144 seconds
Avg batch val. time: 0.022041481733322144 seconds
Avg sample val. time: 0.00034547777011476716 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 2.335650 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 0.981264 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0160725116729736 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0021361351013183 seconds
Avg batch train. time: 0.06673787117004394 seconds
Avg sample train. time: 0.001044411129421658 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 1.373470 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9727375507354736 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9972363710403442 seconds
Avg batch train. time: 0.06657454570134481 seconds
Avg sample train. time: 0.001041855175294911 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23200345039367676 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2227325439453125 seconds
Avg batch val. time: 0.02227325439453125 seconds
Avg sample val. time: 0.0003491105704471983 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 4.572194 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.629226 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0985825061798096 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.011714390345982 seconds
Avg batch train. time: 0.06705714634486608 seconds
Avg sample train. time: 0.001049407611030768 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.578949 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0644848346710205 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.018310695886612 seconds
Avg batch train. time: 0.06727702319622039 seconds
Avg sample train. time: 0.001052848563321133 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2579836845397949 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2286077340443929 seconds
Avg batch val. time: 0.022860773404439292 seconds
Avg sample val. time: 0.0003583193323579826 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 1.475431 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.820538 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.001595973968506 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.016453504562378 seconds
Avg batch train. time: 0.06721511681874594 seconds
Avg sample train. time: 0.001051879762421689 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.839893 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9941554069519043 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0142236948013306 seconds
Avg batch train. time: 0.06714078982671103 seconds
Avg sample train. time: 0.0010507165857075278 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22592830657958984 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22822495869227818 seconds
Avg batch val. time: 0.02282249586922782 seconds
Avg sample val. time: 0.0003577193709910316 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 1.870409 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.600393 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9998044967651367 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.012912858616222 seconds
Avg batch train. time: 0.0670970952872074 seconds
Avg sample train. time: 0.0010500327900971424 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.450719 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.072164297103882 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.017850478490194 seconds
Avg batch train. time: 0.06726168261633979 seconds
Avg sample train. time: 0.0010526084916485101 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23000049591064453 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22844690084457397 seconds
Avg batch val. time: 0.022844690084457397 seconds
Avg sample val. time: 0.000358067242703094 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 6.593549 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.818258 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0522406101226807 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0204958732311544 seconds
Avg batch train. time: 0.06734986244103848 seconds
Avg sample train. time: 0.001053988457606236 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.518173 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9922940731048584 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0184814589364186 seconds
Avg batch train. time: 0.06728271529788062 seconds
Avg sample train. time: 0.0010529376415943758 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.26555633544921875 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23257017135620117 seconds
Avg batch val. time: 0.023257017135620117 seconds
Avg sample val. time: 0.00036453004914765075 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 4.002230 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.437883 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.066962718963623 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0217135429382322 seconds
Avg batch train. time: 0.06739045143127441 seconds
Avg sample train. time: 0.001054623653071587 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.801686 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1426424980163574 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0292716026306152 seconds
Avg batch train. time: 0.06764238675435384 seconds
Avg sample train. time: 0.0010585663028850366 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21799921989440918 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23111307621002197 seconds
Avg batch val. time: 0.0231113076210022 seconds
Avg sample val. time: 0.00036224620095614727 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.513131 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.561379 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9730370044708252 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.025963685091804 seconds
Avg batch train. time: 0.06753212283639347 seconds
Avg sample train. time: 0.001056840732963904 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.483310 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9486594200134277 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0216690036985607 seconds
Avg batch train. time: 0.06738896678995203 seconds
Avg sample train. time: 0.0010546004192480754 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21798944473266602 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22992001880298962 seconds
Avg batch val. time: 0.022992001880298964 seconds
Avg sample val. time: 0.00036037620502035994 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 1.462739 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.470878 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9365601539611816 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0171895905544885 seconds
Avg batch train. time: 0.06723965301848295 seconds
Avg sample train. time: 0.0010522637405083403 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.501842 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9891161918640137 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0157859206199644 seconds
Avg batch train. time: 0.06719286402066547 seconds
Avg sample train. time: 0.0010515315183202735 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2120664119720459 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2284322182337443 seconds
Avg batch val. time: 0.022843221823374428 seconds
Avg sample val. time: 0.00035804422920649576 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 8.139452 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.834668 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9147515296936035 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0109747591472806 seconds
Avg batch train. time: 0.06703249197157603 seconds
Avg sample train. time: 0.001049021783592739 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.817568 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8988125324249268 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0058764761144463 seconds
Avg batch train. time: 0.06686254920381487 seconds
Avg sample train. time: 0.0010463622723601701 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22255229949951172 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22797991679264948 seconds
Avg batch val. time: 0.022797991679264946 seconds
Avg sample val. time: 0.00035733529277844745 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 1.339760 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.519962 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9035778045654297 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0014287077862285 seconds
Avg batch train. time: 0.06671429025954095 seconds
Avg sample train. time: 0.0010440421010882777 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.795477 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8885540962219238 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.996725598971049 seconds
Avg batch train. time: 0.06655751996570164 seconds
Avg sample train. time: 0.0010415887318576155 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2219998836517334 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22755277156829834 seconds
Avg batch val. time: 0.022755277156829835 seconds
Avg sample val. time: 0.0003566657861572074 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 0.848279 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.969143 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8732128143310547 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9917850875854493 seconds
Avg batch train. time: 0.06639283625284831 seconds
Avg sample train. time: 0.0010390115219538077 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.749276 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.833817720413208 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9857094196172862 seconds
Avg batch train. time: 0.06619031398724287 seconds
Avg sample train. time: 0.001035842159424771 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19696044921875 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2255132834116618 seconds
Avg batch val. time: 0.02255132834116618 seconds
Avg sample val. time: 0.0003534690962565232 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 0.453505 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.716454 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9047088623046875 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9827093989760787 seconds
Avg batch train. time: 0.06609031329920262 seconds
Avg sample train. time: 0.001034277203430401 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.752143 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8163206577301025 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9767669439315796 seconds
Avg batch train. time: 0.06589223146438598 seconds
Avg sample train. time: 0.0010311773312110483 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21399807929992676 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22479358315467834 seconds
Avg batch val. time: 0.022479358315467834 seconds
Avg sample val. time: 0.00035234103942739553 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 9.748981 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 1.189074 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8530285358428955 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.972500102273349 seconds
Avg batch train. time: 0.06575000340911163 seconds
Avg sample train. time: 0.0010289515400486954 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.699589 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9039077758789062 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9702136913935344 seconds
Avg batch train. time: 0.06567378971311781 seconds
Avg sample train. time: 0.001027758837450983 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21504664421081543 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22422023380503936 seconds
Avg batch val. time: 0.022422023380503937 seconds
Avg sample val. time: 0.00035144237273517144 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 3.873232 | 
Best loss was 0.45350511245966707. Other metrics: OrderedDict([('epoch', 26), ('loss', 0.45350511245966707)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 6.790661096572876 seconds

