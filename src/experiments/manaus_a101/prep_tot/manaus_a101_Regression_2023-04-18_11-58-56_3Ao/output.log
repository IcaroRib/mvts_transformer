Running:
main.py --output_dir experiments/manaus_a101/prep_tot --comment regression for manaus_a101 --name manaus_a101_Regression --records_file experiments/manaus_a101/prep_tot/manaus_a101_Regression.xls --data_dir datasets/files_v2/manaus_a101/prep_tot/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0025 --optimizer Adam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
2539 samples may be used for training
832 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=16, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 154113
Trainable parameters: 154113
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.49143314361572266 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.49143314361572266 seconds
Avg batch val. time: 0.037802549508901745 seconds
Avg sample val. time: 0.0005906648360765898 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 241.481266 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 138.986077 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 4.8130927085876465 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 4.8130927085876465 seconds
Avg batch train. time: 0.12032731771469116 seconds
Avg sample train. time: 0.0018956647138982459 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.4719405174255371 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.4816868305206299 seconds
Avg batch val. time: 0.03705283311697153 seconds
Avg sample val. time: 0.0005789505174526802 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 216.197534 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 133.779277 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 4.583317995071411 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 4.698205351829529 seconds
Avg batch train. time: 0.11745513379573821 seconds
Avg sample train. time: 0.0018504156564905587 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.4735445976257324 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.4789727528889974 seconds
Avg batch val. time: 0.03684405791453826 seconds
Avg sample val. time: 0.0005756884049146603 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 219.953076 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 131.793219 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 4.83661413192749 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 4.744341611862183 seconds
Avg batch train. time: 0.11860854029655457 seconds
Avg sample train. time: 0.0018685866923443019 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 129.719700 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 4.9484124183654785 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 4.795359313488007 seconds
Avg batch train. time: 0.11988398283720017 seconds
Avg sample train. time: 0.0018886803125198923 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.5301787853240967 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.4917742609977722 seconds
Avg batch val. time: 0.03782878930752094 seconds
Avg sample val. time: 0.0005910748329300147 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 212.999009 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 126.545904 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.493725061416626 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 4.93503246307373 seconds
Avg batch train. time: 0.12337581157684326 seconds
Avg sample train. time: 0.0019436913993988697 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 126.196852 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.413673639297485 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.014805992444356 seconds
Avg batch train. time: 0.1253701498111089 seconds
Avg sample train. time: 0.001975110670517667 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.6385936737060547 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5211381435394287 seconds
Avg batch val. time: 0.040087549503032976 seconds
Avg sample val. time: 0.0006263679609848903 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 210.516795 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 124.991220 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.540471076965332 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.089901004518781 seconds
Avg batch train. time: 0.12724752511296952 seconds
Avg sample train. time: 0.0020046872802358335 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 127.866205 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.6121015548706055 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.155176073312759 seconds
Avg batch train. time: 0.12887940183281898 seconds
Avg sample train. time: 0.002030396247858511 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.5787372589111328 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5307379961013794 seconds
Avg batch val. time: 0.04082599970010611 seconds
Avg sample val. time: 0.0006379062453141579 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 253.948485 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 125.612071 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.494050025939941 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.192828734715779 seconds
Avg batch train. time: 0.1298207183678945 seconds
Avg sample train. time: 0.002045225968773446 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 129.482128 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.581873655319214 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.231733226776123 seconds
Avg batch train. time: 0.13079333066940307 seconds
Avg sample train. time: 0.0020605487305144243 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.582036018371582 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5380662849971226 seconds
Avg batch val. time: 0.041389714230547894 seconds
Avg sample val. time: 0.0006467142848523108 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 216.127250 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 125.084278 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.653393268585205 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.270065957849676 seconds
Avg batch train. time: 0.1317516489462419 seconds
Avg sample train. time: 0.0020756463008466623 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 127.861403 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.687689304351807 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.3048679033915205 seconds
Avg batch train. time: 0.132621697584788 seconds
Avg sample train. time: 0.0020893532506465226 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.5991499423980713 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5457017421722412 seconds
Avg batch val. time: 0.0419770570901724 seconds
Avg sample val. time: 0.0006558915170339438 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 217.863959 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 125.529268 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.544983148574829 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.323338306867159 seconds
Avg batch train. time: 0.13308345767167898 seconds
Avg sample train. time: 0.002096627927084348 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 122.732767 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.493262529373169 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.335475751331875 seconds
Avg batch train. time: 0.13338689378329688 seconds
Avg sample train. time: 0.002101408330575768 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.5957748889923096 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5512654251522489 seconds
Avg batch val. time: 0.042405032704019144 seconds
Avg sample val. time: 0.0006625786360002991 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 217.318796 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 126.627403 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.569513559341431 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.351078271865845 seconds
Avg batch train. time: 0.1337769567966461 seconds
Avg sample train. time: 0.00210755347454346 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 123.835696 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.6371073722839355 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.368955090641975 seconds
Avg batch train. time: 0.1342238772660494 seconds
Avg sample train. time: 0.00211459436417565 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.666832447052002 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5628221273422241 seconds
Avg batch val. time: 0.043294009795555706 seconds
Avg sample val. time: 0.0006764689030555579 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 228.359313 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 124.615431 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.703469753265381 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.388632423737469 seconds
Avg batch train. time: 0.13471581059343674 seconds
Avg sample train. time: 0.0021223443969032962 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 126.144488 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.572378158569336 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.398840520117018 seconds
Avg batch train. time: 0.13497101300292544 seconds
Avg sample train. time: 0.0021263649153670807 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.6271176338195801 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5686671733856201 seconds
Avg batch val. time: 0.04374362872197078 seconds
Avg sample val. time: 0.0006834941987807935 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 234.140248 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 124.279419 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.582366466522217 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.408499780454133 seconds
Avg batch train. time: 0.13521249451135334 seconds
Avg sample train. time: 0.002130169271545543 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 122.297066 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.412339210510254 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.4086917519569395 seconds
Avg batch train. time: 0.1352172937989235 seconds
Avg sample train. time: 0.002130244880644718 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.6023657321929932 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5714753866195679 seconds
Avg batch val. time: 0.04395964512458214 seconds
Avg sample val. time: 0.000686869455071596 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 231.488608 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 121.881425 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.268176078796387 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.402000529425485 seconds
Avg batch train. time: 0.13505001323563712 seconds
Avg sample train. time: 0.0021276095035153543 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 119.439120 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.341512441635132 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.39925107088956 seconds
Avg batch train. time: 0.13498127677223898 seconds
Avg sample train. time: 0.0021265266131900587 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.513211727142334 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5669935666597806 seconds
Avg batch val. time: 0.04361488974306005 seconds
Avg sample val. time: 0.0006814826522353132 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 242.467755 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 122.979942 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.0506274700164795 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.384093523025513 seconds
Avg batch train. time: 0.13460233807563782 seconds
Avg sample train. time: 0.002120556724310954 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 123.792350 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.000610828399658 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.368115077416102 seconds
Avg batch train. time: 0.13420287693540256 seconds
Avg sample train. time: 0.0021142635200536047 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.5470914840698242 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5655719893319267 seconds
Avg batch val. time: 0.043505537640917434 seconds
Avg sample val. time: 0.0006797740256393349 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 229.957450 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 120.843336 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.369548082351685 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.368172397613526 seconds
Avg batch train. time: 0.13420430994033813 seconds
Avg sample train. time: 0.002114286095948612 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 120.262833 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.535608768463135 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.374612258030818 seconds
Avg batch train. time: 0.13436530645077044 seconds
Avg sample train. time: 0.0021168224726391565 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.5642220973968506 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5654819965362549 seconds
Avg batch val. time: 0.04349861511817345 seconds
Avg sample val. time: 0.0006796658612214601 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 228.734469 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 121.688309 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.637854099273682 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.384361955854628 seconds
Avg batch train. time: 0.13460904889636569 seconds
Avg sample train. time: 0.0021206624481507003 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 123.940733 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.702433347702026 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.395721648420606 seconds
Avg batch train. time: 0.13489304121051515 seconds
Avg sample train. time: 0.002125136529507919 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.6251139640808105 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.5692089945077896 seconds
Avg batch val. time: 0.04378530726982997 seconds
Avg sample val. time: 0.0006841454260910933 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 230.190437 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 120.637726 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.384915113449097 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.395349009283658 seconds
Avg batch train. time: 0.13488372523209144 seconds
Avg sample train. time: 0.0021249897634043552 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 120.473634 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 5.492377996444702 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 5.3985833088556925 seconds
Avg batch train. time: 0.1349645827213923 seconds
Avg sample train. time: 0.0021262636112074408 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.5784578323364258 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.569753043791827 seconds
Avg batch val. time: 0.04382715721475593 seconds
Avg sample val. time: 0.0006847993314805614 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 224.396168 | 
Best loss was 210.51679493830756. Other metrics: OrderedDict([('epoch', 6), ('loss', 210.51679493830756)])
All Done!
Total runtime: 0.0 hours, 3.0 minutes, 20.003681898117065 seconds

