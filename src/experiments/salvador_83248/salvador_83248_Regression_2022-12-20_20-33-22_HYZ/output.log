Running:
main.py --output_dir experiments/salvador_83248/ --comment regression for salvador_83248 --name salvador_83248_Regression --records_file experiments/salvador_83248/salvador_83248_Regression.xls --data_dir datasets/files/salvador_83248/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.0001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17600011825561523 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17600011825561523 seconds
Avg batch val. time: 0.017600011825561524 seconds
Avg sample val. time: 0.0002750001847743988 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 792.045355 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 719.779907 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.686589002609253 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.686589002609253 seconds
Avg batch train. time: 0.05621963342030843 seconds
Avg sample train. time: 0.0008788895271543788 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22429919242858887 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20014965534210205 seconds
Avg batch val. time: 0.020014965534210206 seconds
Avg sample val. time: 0.0003127338364720345 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 704.886395 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 713.413727 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1226258277893066 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9046074151992798 seconds
Avg batch train. time: 0.063486913839976 seconds
Avg sample train. time: 0.0009924999558099425 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23200035095214844 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21076655387878418 seconds
Avg batch val. time: 0.021076655387878417 seconds
Avg sample val. time: 0.00032932274043560026 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 699.459546 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 703.950593 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.069659948348999 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9596249262491863 seconds
Avg batch train. time: 0.06532083087497288 seconds
Avg sample train. time: 0.0010211698417140105 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 692.737860 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0589962005615234 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9844677448272705 seconds
Avg batch train. time: 0.06614892482757569 seconds
Avg sample train. time: 0.0010341155522810164 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25701069831848145 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2223275899887085 seconds
Avg batch val. time: 0.02223275899887085 seconds
Avg sample val. time: 0.000347386859357357 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 684.271051 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 679.506420 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0650322437286377 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.000580644607544 seconds
Avg batch train. time: 0.06668602148691813 seconds
Avg sample train. time: 0.0010425120607647441 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 663.512751 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0140774250030518 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0028301080067954 seconds
Avg batch train. time: 0.0667610036002265 seconds
Avg sample train. time: 0.001043684266809169 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23999404907226562 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2258608818054199 seconds
Avg batch val. time: 0.022586088180541992 seconds
Avg sample val. time: 0.0003529076278209686 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 658.072205 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 645.132780 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0282530784606934 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.006461960928781 seconds
Avg batch train. time: 0.0668820653642927 seconds
Avg sample train. time: 0.0010455768425892552 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 622.200053 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9918107986450195 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0046305656433105 seconds
Avg batch train. time: 0.06682101885477702 seconds
Avg sample train. time: 0.0010446224938214228 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23400282859802246 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22721787293752035 seconds
Avg batch val. time: 0.022721787293752037 seconds
Avg sample val. time: 0.0003550279264648756 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 619.402808 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 595.288462 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.064710855484009 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.011306153403388 seconds
Avg batch train. time: 0.0670435384467796 seconds
Avg sample train. time: 0.0010481011742591913 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 565.375350 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.175893545150757 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.027764892578125 seconds
Avg batch train. time: 0.0675921630859375 seconds
Avg sample train. time: 0.0010566779012913627 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2602803707122803 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23194108690534318 seconds
Avg batch val. time: 0.02319410869053432 seconds
Avg sample val. time: 0.00036240794828959873 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 561.858139 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 532.173869 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.12004017829895 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.036153554916382 seconds
Avg batch train. time: 0.0678717851638794 seconds
Avg sample train. time: 0.001061049273015311 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 499.701622 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.045923948287964 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0369677543640137 seconds
Avg batch train. time: 0.06789892514546712 seconds
Avg sample train. time: 0.001061473556208449 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24306011199951172 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23333096504211426 seconds
Avg batch val. time: 0.023333096504211427 seconds
Avg sample val. time: 0.00036457963287830355 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 492.984885 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 462.869758 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0502243041992188 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0379874889667215 seconds
Avg batch train. time: 0.06793291629889071 seconds
Avg sample train. time: 0.0010620049447455557 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 427.169766 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.040121078491211 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.038139888218471 seconds
Avg batch train. time: 0.06793799627394903 seconds
Avg sample train. time: 0.0010620843607183276 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2250063419342041 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23240600691901314 seconds
Avg batch val. time: 0.023240600691901314 seconds
Avg sample val. time: 0.00036313438581095803 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 421.847672 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 390.910418 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9960944652557373 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0353368600209554 seconds
Avg batch train. time: 0.06784456200069851 seconds
Avg sample train. time: 0.0010606236894324936 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 354.751154 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.011451244354248 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.033844009041786 seconds
Avg batch train. time: 0.06779480030139287 seconds
Avg sample train. time: 0.00105984575770807 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21703696250915527 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23086910247802733 seconds
Avg batch val. time: 0.023086910247802732 seconds
Avg sample val. time: 0.0003607329726219177 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 351.960754 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 319.504622 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0204689502716064 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0330572408788345 seconds
Avg batch train. time: 0.06776857469596115 seconds
Avg sample train. time: 0.0010594357690874594 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 284.910859 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.041883945465088 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0335476133558483 seconds
Avg batch train. time: 0.06778492044519495 seconds
Avg sample train. time: 0.0010596913045106036 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2314615249633789 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23092295906760477 seconds
Avg batch val. time: 0.023092295906760478 seconds
Avg sample val. time: 0.00036081712354313247 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 286.054332 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 249.331688 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.070512056350708 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.035493110355578 seconds
Avg batch train. time: 0.06784977034518593 seconds
Avg sample train. time: 0.0010607051122228128 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 214.171255 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9792306423187256 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0326799869537355 seconds
Avg batch train. time: 0.06775599956512451 seconds
Avg sample train. time: 0.001059239180278132 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22399401664733887 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23034554719924927 seconds
Avg batch val. time: 0.023034554719924927 seconds
Avg sample val. time: 0.000359914917498827 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 218.137173 | 
Best loss was 218.13717346191407. Other metrics: OrderedDict([('epoch', 20), ('loss', 218.13717346191407)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 47.1138870716095 seconds

