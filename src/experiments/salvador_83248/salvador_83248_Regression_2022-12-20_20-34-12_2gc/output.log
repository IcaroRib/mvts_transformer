Running:
main.py --output_dir experiments/salvador_83248/ --comment regression for salvador_83248 --name salvador_83248_Regression --records_file experiments/salvador_83248/salvador_83248_Regression.xls --data_dir datasets/files/salvador_83248/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20200014114379883 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20200014114379883 seconds
Avg batch val. time: 0.020200014114379883 seconds
Avg sample val. time: 0.00031562522053718567 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 640.157483 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 714.210889 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8489043712615967 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8489043712615967 seconds
Avg batch train. time: 0.06163014570871989 seconds
Avg sample train. time: 0.0009634728354672207 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2170391082763672 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.209519624710083 seconds
Avg batch val. time: 0.0209519624710083 seconds
Avg sample val. time: 0.0003273744136095047 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 701.309100 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 707.556609 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.998831033706665 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9238677024841309 seconds
Avg batch train. time: 0.0641289234161377 seconds
Avg sample train. time: 0.0010025365828473846 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21999859809875488 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2130126158396403 seconds
Avg batch val. time: 0.02130126158396403 seconds
Avg sample val. time: 0.00033283221224943794 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 693.913696 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 697.830625 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9470062255859375 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9315805435180664 seconds
Avg batch train. time: 0.06438601811726888 seconds
Avg sample train. time: 0.0010065557808848706 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 684.905503 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0055458545684814 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9500718712806702 seconds
Avg batch train. time: 0.06500239570935568 seconds
Avg sample train. time: 0.0010161916994688223 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20997953414916992 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2122543454170227 seconds
Avg batch val. time: 0.02122543454170227 seconds
Avg sample val. time: 0.000331647414714098 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 674.648718 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 669.361677 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9383444786071777 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9477263927459716 seconds
Avg batch train. time: 0.06492421309153239 seconds
Avg sample train. time: 0.001014969459482007 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 651.946857 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8484418392181396 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9311789671579997 seconds
Avg batch train. time: 0.06437263223859999 seconds
Avg sample train. time: 0.0010063465175393432 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20499825477600098 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21080312728881836 seconds
Avg batch val. time: 0.021080312728881837 seconds
Avg sample val. time: 0.0003293798863887787 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 643.837488 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 632.412167 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8272769451141357 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9163358211517334 seconds
Avg batch train. time: 0.06387786070505778 seconds
Avg sample train. time: 0.0009986116837684906 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 607.073288 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8206541538238525 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9043756127357483 seconds
Avg batch train. time: 0.06347918709119162 seconds
Avg sample train. time: 0.0009923791624469767 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19241023063659668 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2077376445134481 seconds
Avg batch val. time: 0.02077376445134481 seconds
Avg sample val. time: 0.00032459006955226264 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 593.593039 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 580.270553 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.858623743057251 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8992920716603596 seconds
Avg batch train. time: 0.06330973572201198 seconds
Avg sample train. time: 0.0009897301050861697 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 551.614657 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.821211814880371 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8914840459823608 seconds
Avg batch train. time: 0.06304946819941203 seconds
Avg sample train. time: 0.0009856613058792916 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21062922477722168 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20815072740827287 seconds
Avg batch val. time: 0.020815072740827285 seconds
Avg sample val. time: 0.00032523551157542633 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 537.169153 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 519.563037 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8230094909667969 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8852590864354914 seconds
Avg batch train. time: 0.06284196954784972 seconds
Avg sample train. time: 0.000982417449940329 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 486.842432 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7723095417022705 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8758466243743896 seconds
Avg batch train. time: 0.06252822081247965 seconds
Avg sample train. time: 0.0009775125713258935 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19899940490722656 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2070068120956421 seconds
Avg batch val. time: 0.02070068120956421 seconds
Avg sample val. time: 0.00032344814389944075 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 475.955804 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 453.293390 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.789515495300293 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8692057682917669 seconds
Avg batch train. time: 0.062306858943058895 seconds
Avg sample train. time: 0.0009740519897299463 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 417.839026 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7852380275726318 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8632080725261144 seconds
Avg batch train. time: 0.06210693575087048 seconds
Avg sample train. time: 0.0009709265620250726 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18006086349487305 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20401281780666775 seconds
Avg batch val. time: 0.020401281780666775 seconds
Avg sample val. time: 0.00031877002782291835 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 402.409229 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 381.500014 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8286406993865967 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8609035809834797 seconds
Avg batch train. time: 0.06203011936611599 seconds
Avg sample train. time: 0.0009697256805541844 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 344.361007 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8095006942749023 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8576909005641937 seconds
Avg batch train. time: 0.06192303001880646 seconds
Avg sample train. time: 0.000968051537552993 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20807504653930664 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20441904067993164 seconds
Avg batch val. time: 0.020441904067993164 seconds
Avg sample val. time: 0.0003194047510623932 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 338.314929 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 308.067731 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7795166969299316 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8530924179974724 seconds
Avg batch train. time: 0.061769747266582416 seconds
Avg sample train. time: 0.0009656552464812258 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 270.880056 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7952697277069092 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8498800463146634 seconds
Avg batch train. time: 0.06166266821048878 seconds
Avg sample train. time: 0.0009639812643640768 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21255040168762207 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20515825531699441 seconds
Avg batch val. time: 0.020515825531699443 seconds
Avg sample val. time: 0.0003205597739328038 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 273.424191 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 235.359013 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.829169511795044 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8487900181820518 seconds
Avg batch train. time: 0.06162633393940173 seconds
Avg sample train. time: 0.0009634132455352015 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 200.392121 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7374451160430908 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8432227730751038 seconds
Avg batch train. time: 0.06144075910250346 seconds
Avg sample train. time: 0.0009605121277097987 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2040107250213623 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2050626277923584 seconds
Avg batch val. time: 0.02050626277923584 seconds
Avg sample val. time: 0.00032041035592556 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 203.966844 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 168.280743 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7582104206085205 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8391745658147902 seconds
Avg batch train. time: 0.06130581886049301 seconds
Avg sample train. time: 0.0009584025877096353 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 137.941440 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7736585140228271 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.83619656346061 seconds
Avg batch train. time: 0.06120655211535367 seconds
Avg sample train. time: 0.0009568507365610267 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21199607849121094 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2055959701538086 seconds
Avg batch val. time: 0.02055959701538086 seconds
Avg sample val. time: 0.0003212437033653259 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 140.000602 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 111.225141 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8427963256835938 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.836483509644218 seconds
Avg batch train. time: 0.0612161169881406 seconds
Avg sample train. time: 0.0009570002655780187 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 87.440444 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8343548774719238 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8363948166370392 seconds
Avg batch train. time: 0.06121316055456797 seconds
Avg sample train. time: 0.0009569540472313909 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2259981632232666 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20705326965876988 seconds
Avg batch val. time: 0.02070532696587699 seconds
Avg sample val. time: 0.00032352073384182795 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 87.412536 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 66.364405 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.864043951034546 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8375007820129394 seconds
Avg batch train. time: 0.06125002606709798 seconds
Avg sample train. time: 0.0009575303710333191 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 48.829503 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8925557136535645 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8396182793837328 seconds
Avg batch train. time: 0.06132060931279109 seconds
Avg sample train. time: 0.0009586338089545246 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2247328758239746 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20823191006978353 seconds
Avg batch val. time: 0.020823191006978353 seconds
Avg sample val. time: 0.00032536235948403677 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 45.804396 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 34.135564 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9380607604980469 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8432642972027813 seconds
Avg batch train. time: 0.06144214324009271 seconds
Avg sample train. time: 0.0009605337661296411 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 22.752577 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9999964237213135 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8488618731498718 seconds
Avg batch train. time: 0.06162872910499573 seconds
Avg sample train. time: 0.0009634506894996727 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24451494216918945 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2104995995759964 seconds
Avg batch val. time: 0.02104995995759964 seconds
Avg sample val. time: 0.00032890562433749435 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 25.931809 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 15.225044 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0136637687683105 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8545446971367145 seconds
Avg batch train. time: 0.06181815657122382 seconds
Avg sample train. time: 0.0009664120360274698 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 10.147229 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.023056983947754 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8601617733637492 seconds
Avg batch train. time: 0.06200539244545831 seconds
Avg sample train. time: 0.0009693391210858516 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2449960708618164 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21252880376927993 seconds
Avg batch val. time: 0.021252880376927994 seconds
Avg sample val. time: 0.0003320762558894999 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 11.754131 | 
Best loss was 11.754130649566651. Other metrics: OrderedDict([('epoch', 30), ('loss', 11.754130649566651)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 3.252216100692749 seconds

