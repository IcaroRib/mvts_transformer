Running:
main.py --output_dir experiments/salvador_83248/ --comment regression for salvador_83248 --name salvador_83248_Regression --records_file experiments/salvador_83248/salvador_83248_Regression.xls --data_dir datasets/files/salvador_83248/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.0005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18006372451782227 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18006372451782227 seconds
Avg batch val. time: 0.018006372451782226 seconds
Avg sample val. time: 0.0002813495695590973 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 748.900232 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 707.382267 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6791484355926514 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6791484355926514 seconds
Avg batch train. time: 0.05597161451975505 seconds
Avg sample train. time: 0.0008750122123984635 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19692516326904297 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18849444389343262 seconds
Avg batch val. time: 0.018849444389343262 seconds
Avg sample val. time: 0.0002945225685834885 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 687.158716 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 675.581626 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6235156059265137 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6513320207595825 seconds
Avg batch train. time: 0.05504440069198609 seconds
Avg sample train. time: 0.0008605169467220336 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17824006080627441 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18507631619771323 seconds
Avg batch val. time: 0.01850763161977132 seconds
Avg sample val. time: 0.0002891817440589269 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 653.974670 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 618.011810 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.693202257156372 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.665288766225179 seconds
Avg batch train. time: 0.0555096255408393 seconds
Avg sample train. time: 0.0008677898729677848 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 532.891866 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6731107234954834 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6672442555427551 seconds
Avg batch train. time: 0.05557480851809184 seconds
Avg sample train. time: 0.0008688088877242079 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17400836944580078 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1823093295097351 seconds
Avg batch val. time: 0.01823093295097351 seconds
Avg sample val. time: 0.0002848583273589611 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 471.486975 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 427.454374 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7335045337677002 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.6804963111877442 seconds
Avg batch train. time: 0.056016543706258144 seconds
Avg sample train. time: 0.0008757145967627641 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 315.307069 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.718278408050537 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.686793327331543 seconds
Avg batch train. time: 0.05622644424438476 seconds
Avg sample train. time: 0.0008789960017360828 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1930100917816162 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18444948196411132 seconds
Avg batch val. time: 0.018444948196411133 seconds
Avg sample val. time: 0.00028820231556892395 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 258.670378 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 208.022237 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7823054790496826 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7004379204341344 seconds
Avg batch train. time: 0.05668126401447115 seconds
Avg sample train. time: 0.0008861062639052289 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 116.905528 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.754821538925171 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.707235872745514 seconds
Avg batch train. time: 0.056907862424850464 seconds
Avg sample train. time: 0.00088964870909094 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18500089645385742 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.184541384379069 seconds
Avg batch val. time: 0.0184541384379069 seconds
Avg sample val. time: 0.0002883459130922953 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 73.724135 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 51.732284 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.719334363937378 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.70858014954461 seconds
Avg batch train. time: 0.056952671651487 seconds
Avg sample train. time: 0.000890349218105581 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 17.982752 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7746148109436035 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7151836156845093 seconds
Avg batch train. time: 0.05717278718948364 seconds
Avg sample train. time: 0.00089379031562507 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19499731063842773 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18603508813040598 seconds
Avg batch val. time: 0.018603508813040598 seconds
Avg sample val. time: 0.00029067982520375934 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 18.656699 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 8.114242 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7196862697601318 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7155929478732022 seconds
Avg batch train. time: 0.057186431595773406 seconds
Avg sample train. time: 0.0008940036205696728 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 5.021454 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7355496883392334 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7172560095787048 seconds
Avg batch train. time: 0.057241866985956825 seconds
Avg sample train. time: 0.0008948702499107373 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20799899101257324 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18878057599067688 seconds
Avg batch val. time: 0.018878057599067688 seconds
Avg sample val. time: 0.0002949696499854326 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 11.764875 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 3.060671 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.772521734237671 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.721507219167856 seconds
Avg batch train. time: 0.05738357397226187 seconds
Avg sample train. time: 0.0008970855753871057 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 2.380669 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7470569610595703 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.72333220073155 seconds
Avg batch train. time: 0.057444406691051664 seconds
Avg sample train. time: 0.0008980365819341062 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20243382453918457 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19029760360717773 seconds
Avg batch val. time: 0.019029760360717775 seconds
Avg sample val. time: 0.00029734000563621523 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 3.281609 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 1.612387 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7761225700378418 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7268515586853028 seconds
Avg batch train. time: 0.05756171862284343 seconds
Avg sample train. time: 0.0008998705360527894 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 1.206120 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7876670360565186 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7306525260210037 seconds
Avg batch train. time: 0.057688417534033455 seconds
Avg sample train. time: 0.0009018512381558123 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20400309562683105 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19166815280914307 seconds
Avg batch val. time: 0.019166815280914306 seconds
Avg sample val. time: 0.00029948148876428603 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 2.545745 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.982012 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7939801216125488 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7343776787028593 seconds
Avg batch train. time: 0.05781258929009531 seconds
Avg sample train. time: 0.0009037924328831992 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.718480 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8819432258605957 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.742575764656067 seconds
Avg batch train. time: 0.058085858821868896 seconds
Avg sample train. time: 0.0009080644943491751 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21300196647644043 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19360759041526102 seconds
Avg batch val. time: 0.0193607590415261 seconds
Avg sample val. time: 0.0003025118600238453 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.911095 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.645774 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9765167236328125 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7548884467074746 seconds
Avg batch train. time: 0.058496281556915816 seconds
Avg sample train. time: 0.0009144806913535563 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.604446 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9003791809082031 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.762162983417511 seconds
Avg batch train. time: 0.05873876611391703 seconds
Avg sample train. time: 0.000918271486929396 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.26300048828125 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19939033190409342 seconds
Avg batch val. time: 0.019939033190409343 seconds
Avg sample val. time: 0.000311547393600146 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 1.105449 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.465215 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9696948528289795 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7720454533894856 seconds
Avg batch train. time: 0.05906818177964952 seconds
Avg sample train. time: 0.0009234212888949899 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.464280 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9139554500579834 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7784959077835083 seconds
Avg batch train. time: 0.05928319692611694 seconds
Avg sample train. time: 0.0009267826512681127 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23000121116638184 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20174501492426947 seconds
Avg batch val. time: 0.020174501492426947 seconds
Avg sample val. time: 0.00031522658581917105 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 1.982002 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.465453 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9339406490325928 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7852543747943381 seconds
Avg batch train. time: 0.05950847915981127 seconds
Avg sample train. time: 0.0009303045204764659 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.365736 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8877627849578857 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7895255585511525 seconds
Avg batch train. time: 0.05965085195170508 seconds
Avg sample train. time: 0.0009325302545863223 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21601343154907227 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2027641875403268 seconds
Avg batch val. time: 0.02027641875403268 seconds
Avg sample val. time: 0.00031681904303176064 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 1.073186 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 0.382515 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.006390333175659 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7982001495361328 seconds
Avg batch train. time: 0.05994000498453776 seconds
Avg sample train. time: 0.000937050625083967 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.389164 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9398677349090576 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.803648902819707 seconds
Avg batch train. time: 0.06012163009399023 seconds
Avg sample train. time: 0.0009398899962583152 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2220003604888916 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20404659907023112 seconds
Avg batch val. time: 0.02040465990702311 seconds
Avg sample val. time: 0.0003188228110472361 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 1.072346 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.372790 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8918023109436035 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8069138438613326 seconds
Avg batch train. time: 0.06023046146204442 seconds
Avg sample train. time: 0.0009415913725176303 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.357714 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9245951175689697 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8111167464937483 seconds
Avg batch train. time: 0.06037055821645828 seconds
Avg sample train. time: 0.0009437815250097698 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24300599098205566 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20648156106472015 seconds
Avg batch val. time: 0.020648156106472016 seconds
Avg sample val. time: 0.00032262743916362525 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 0.796008 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.395877 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0004780292510986 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8176464458991741 seconds
Avg batch train. time: 0.0605882148633058 seconds
Avg sample train. time: 0.0009471841823341188 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.355419 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9725713729858398 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8228106101353962 seconds
Avg batch train. time: 0.06076035367117987 seconds
Avg sample train. time: 0.0009498752528063555 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21699833869934082 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20710019504322724 seconds
Avg batch val. time: 0.020710019504322726 seconds
Avg sample val. time: 0.0003235940547550426 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 1.019947 | 
Best loss was 0.796008113026619. Other metrics: OrderedDict([('epoch', 28), ('loss', 0.796008113026619)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 2.091813325881958 seconds

