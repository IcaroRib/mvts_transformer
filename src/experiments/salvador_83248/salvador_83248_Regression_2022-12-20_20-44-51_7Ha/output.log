Running:
main.py --output_dir experiments/salvador_83248/ --comment regression for salvador_83248 --name salvador_83248_Regression --records_file experiments/salvador_83248/salvador_83248_Regression.xls --data_dir datasets/files/salvador_83248/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.001 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17999935150146484 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17999935150146484 seconds
Avg batch val. time: 0.017999935150146484 seconds
Avg sample val. time: 0.0002812489867210388 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 786.906848 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 693.426260 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5897603034973145 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.5897603034973145 seconds
Avg batch train. time: 0.05299201011657715 seconds
Avg sample train. time: 0.0008284316328803098 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.16329073905944824 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.17164504528045654 seconds
Avg batch val. time: 0.017164504528045653 seconds
Avg sample val. time: 0.0002681953832507133 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 664.933606 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 617.180186 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8939032554626465 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7418317794799805 seconds
Avg batch train. time: 0.05806105931599935 seconds
Avg sample train. time: 0.0009076768001458991 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2039339542388916 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18240801493326822 seconds
Avg batch val. time: 0.01824080149332682 seconds
Avg sample val. time: 0.0002850125233332316 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 552.885989 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 486.306567 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9339780807495117 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8058805465698242 seconds
Avg batch train. time: 0.06019601821899414 seconds
Avg sample train. time: 0.0009410529163990746 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 323.125967 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9050571918487549 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8306747078895569 seconds
Avg batch train. time: 0.06102249026298523 seconds
Avg sample train. time: 0.0009539732714380182 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21396517753601074 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19029730558395386 seconds
Avg batch val. time: 0.019029730558395387 seconds
Avg sample val. time: 0.0002973395399749279 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 233.487866 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 162.575763 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8820652961730957 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8409528255462646 seconds
Avg batch train. time: 0.061365094184875485 seconds
Avg sample train. time: 0.0009593292472883088 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 50.700280 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9191930294036865 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8539928595225017 seconds
Avg batch train. time: 0.06179976198408339 seconds
Avg sample train. time: 0.0009661244708298602 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19605779647827148 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19144940376281738 seconds
Avg batch val. time: 0.019144940376281738 seconds
Avg sample val. time: 0.00029913969337940215 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 18.341522 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 9.166705 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.947007656097412 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8672806876046317 seconds
Avg batch train. time: 0.06224268958682106 seconds
Avg sample train. time: 0.0009730488210550451 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 3.051162 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8806169033050537 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8689477145671844 seconds
Avg batch train. time: 0.06229825715223948 seconds
Avg sample train. time: 0.0009739175167103619 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20693659782409668 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.1940306027730306 seconds
Avg batch val. time: 0.019403060277303062 seconds
Avg sample val. time: 0.00030317281683286035 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 4.341615 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 1.759393 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8975062370300293 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8721208837297227 seconds
Avg batch train. time: 0.062404029457657426 seconds
Avg sample train. time: 0.0009755710702082975 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 1.338141 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.837024450302124 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8686112403869628 seconds
Avg batch train. time: 0.06228704134623209 seconds
Avg sample train. time: 0.0009737421784194699 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21089744567871094 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19644015175955637 seconds
Avg batch val. time: 0.019644015175955636 seconds
Avg sample val. time: 0.0003069377371243068 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 4.703721 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.974681 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.85325288772583 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.867215026508678 seconds
Avg batch train. time: 0.0622405008836226 seconds
Avg sample train. time: 0.0009730146047465753 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.760044 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8538737297058105 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8661032517751057 seconds
Avg batch train. time: 0.062203441725836854 seconds
Avg sample train. time: 0.0009724352536608159 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2040092945098877 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19738629460334778 seconds
Avg batch val. time: 0.019738629460334778 seconds
Avg sample val. time: 0.0003084160853177309 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 2.979573 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.646273 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8247029781341553 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8629186153411865 seconds
Avg batch train. time: 0.06209728717803955 seconds
Avg sample train. time: 0.0009707757245133854 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.600679 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8333587646484375 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8608071974345617 seconds
Avg batch train. time: 0.06202690658115206 seconds
Avg sample train. time: 0.0009696754546297872 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1869947910308838 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19623168309529623 seconds
Avg batch val. time: 0.019623168309529624 seconds
Avg sample val. time: 0.0003066120048364004 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 2.596790 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.427207 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7791249752044678 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8553617159525553 seconds
Avg batch train. time: 0.061845390531751844 seconds
Avg sample train. time: 0.000966837788406751 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.416818 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7798357009887695 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8506413400173187 seconds
Avg batch train. time: 0.06168804466724396 seconds
Avg sample train. time: 0.0009643779781226257 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18406391143798828 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19501490592956544 seconds
Avg batch val. time: 0.019501490592956545 seconds
Avg sample val. time: 0.000304710790514946 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 1.729827 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.443328 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7488961219787598 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.844656327191521 seconds
Avg batch train. time: 0.06148854423971737 seconds
Avg sample train. time: 0.0009612591595578536 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.383160 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.758150339126587 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8398504389656916 seconds
Avg batch train. time: 0.06132834796552305 seconds
Avg sample train. time: 0.0009587547884135965 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20327448844909668 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19576577706770462 seconds
Avg batch val. time: 0.019576577706770463 seconds
Avg sample val. time: 0.0003058840266682885 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 2.242230 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.406717 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.778649091720581 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8366293154264752 seconds
Avg batch train. time: 0.061220977180882506 seconds
Avg sample train. time: 0.0009570762456625717 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.392138 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7805542945861816 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8338255643844605 seconds
Avg batch train. time: 0.06112751881281535 seconds
Avg sample train. time: 0.0009556151976990414 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19700050354003906 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19586867094039917 seconds
Avg batch val. time: 0.019586867094039916 seconds
Avg sample val. time: 0.0003060447983443737 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 2.516756 | 
Best loss was 1.7298271298408507. Other metrics: OrderedDict([('epoch', 16), ('loss', 1.7298271298408507)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 42.561275243759155 seconds

