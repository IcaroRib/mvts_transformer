Running:
main.py --output_dir experiments/salvador_83248/ --comment regression for salvador_83248 --name salvador_83248_Regression --records_file experiments/salvador_83248/salvador_83248_Regression.xls --data_dir datasets/files/salvador_83248/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.0025 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18399953842163086 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18399953842163086 seconds
Avg batch val. time: 0.018399953842163086 seconds
Avg sample val. time: 0.0002874992787837982 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 814.863947 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 665.242977 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7075774669647217 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7075774669647217 seconds
Avg batch train. time: 0.056919248898824056 seconds
Avg sample train. time: 0.0008898267154584271 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19499564170837402 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18949759006500244 seconds
Avg batch val. time: 0.018949759006500245 seconds
Avg sample val. time: 0.0002960899844765663 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 591.034882 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 470.841303 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6951806545257568 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7013790607452393 seconds
Avg batch train. time: 0.05671263535817464 seconds
Avg sample train. time: 0.0008865966965842831 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20399880409240723 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19433132807413736 seconds
Avg batch val. time: 0.019433132807413735 seconds
Avg sample val. time: 0.0003036427001158396 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 279.113483 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 195.475334 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7205398082733154 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7077659765879314 seconds
Avg batch train. time: 0.05692553255293105 seconds
Avg sample train. time: 0.0008899249487170044 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 23.393198 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6926968097686768 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7039986848831177 seconds
Avg batch train. time: 0.05679995616277059 seconds
Avg sample train. time: 0.0008879617951449285 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.17499947547912598 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18949836492538452 seconds
Avg batch val. time: 0.018949836492538452 seconds
Avg sample val. time: 0.0002960911951959133 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 11.200332 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 4.211396 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7456574440002441 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.712330436706543 seconds
Avg batch train. time: 0.05707768122355143 seconds
Avg sample train. time: 0.0008923035105297254 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 1.456220 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6960210800170898 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.709612210591634 seconds
Avg batch train. time: 0.0569870736863878 seconds
Avg sample train. time: 0.0008908870300112736 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.1770012378692627 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18699893951416016 seconds
Avg batch val. time: 0.018699893951416018 seconds
Avg sample val. time: 0.0002921858429908753 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 4.252075 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.721052 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7417728900909424 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7142065933772497 seconds
Avg batch train. time: 0.057140219779241656 seconds
Avg sample train. time: 0.0008932811846676653 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.496644 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.7540388107299805 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.719185620546341 seconds
Avg batch train. time: 0.0573061873515447 seconds
Avg sample train. time: 0.0008958757793362902 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2100076675415039 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19083372751871744 seconds
Avg batch val. time: 0.019083372751871743 seconds
Avg sample val. time: 0.000298177699247996 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 4.275312 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.458412 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.748687982559204 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7224636607699924 seconds
Avg batch train. time: 0.057415455358999744 seconds
Avg sample train. time: 0.000897583981641476 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.399038 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8423609733581543 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7344533920288085 seconds
Avg batch train. time: 0.057815113067626954 seconds
Avg sample train. time: 0.000903831887456388 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2189960479736328 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19485691615513392 seconds
Avg batch val. time: 0.019485691615513393 seconds
Avg sample val. time: 0.00030446393149239677 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 0.973458 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.425473 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.8486964702606201 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7448391264135188 seconds
Avg batch train. time: 0.05816130421378396 seconds
Avg sample train. time: 0.000909243942893965 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.368895 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.858644962310791 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7543229460716248 seconds
Avg batch train. time: 0.058477431535720825 seconds
Avg sample train. time: 0.0009141860062905809 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.20630097389221191 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19628742337226868 seconds
Avg batch val. time: 0.01962874233722687 seconds
Avg sample val. time: 0.00030669909901916983 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.715552 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.509649 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9320957660675049 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7679977783790002 seconds
Avg batch train. time: 0.05893325927930001 seconds
Avg sample train. time: 0.0009213120262527359 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.365105 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0119569301605225 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7854234320776803 seconds
Avg batch train. time: 0.059514114402589344 seconds
Avg sample train. time: 0.0009303926170284942 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22700214385986328 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19970017009311253 seconds
Avg batch val. time: 0.019970017009311253 seconds
Avg sample val. time: 0.0003120315157704883 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 1.456129 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.400494 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9424521923065186 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7958920160929361 seconds
Avg batch train. time: 0.05986306720309787 seconds
Avg sample train. time: 0.0009358478458014258 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.359888 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9110734462738037 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8030908554792404 seconds
Avg batch train. time: 0.06010302851597468 seconds
Avg sample train. time: 0.000939599195142908 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2165224552154541 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20138239860534668 seconds
Avg batch val. time: 0.020138239860534667 seconds
Avg sample val. time: 0.00031465999782085417 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 0.904575 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.412466 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9210350513458252 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8100287493537455 seconds
Avg batch train. time: 0.06033429164512485 seconds
Avg sample train. time: 0.0009432145645407741 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.386154 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9795823097229004 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8194483915964763 seconds
Avg batch train. time: 0.06064827971988254 seconds
Avg sample train. time: 0.0009481231847819053 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23199462890625 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20416532863270154 seconds
Avg batch val. time: 0.020416532863270154 seconds
Avg sample val. time: 0.00031900832598859616 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 0.556578 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.428472 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9924752712249756 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8285550694716604 seconds
Avg batch train. time: 0.06095183564905535 seconds
Avg sample train. time: 0.0009528687178070143 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.553914 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9711589813232422 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8356852650642395 seconds
Avg batch train. time: 0.06118950883547465 seconds
Avg sample train. time: 0.0009565842965420737 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2225198745727539 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2056948741277059 seconds
Avg batch val. time: 0.02056948741277059 seconds
Avg sample val. time: 0.00032139824082454046 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 1.302297 | 
Best loss was 0.5565775066614151. Other metrics: OrderedDict([('epoch', 18), ('loss', 0.5565775066614151)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 42.76459097862244 seconds

