Running:
main.py --output_dir experiments/salvador_83248/ --comment regression for salvador_83248 --name salvador_83248_Regression --records_file experiments/salvador_83248/salvador_83248_Regression.xls --data_dir datasets/files/salvador_83248/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 30 --lr 0.005 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.19799065589904785 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19799065589904785 seconds
Avg batch val. time: 0.019799065589904786 seconds
Avg sample val. time: 0.0003093603998422623 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 927.543347 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 629.242727 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.098464012145996 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.098464012145996 seconds
Avg batch train. time: 0.06994880040486653 seconds
Avg sample train. time: 0.0010935195477571632 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22919726371765137 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2135939598083496 seconds
Avg batch val. time: 0.02135939598083496 seconds
Avg sample val. time: 0.0003337405622005463 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 460.017401 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 281.305078 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0805397033691406 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0895018577575684 seconds
Avg batch train. time: 0.06965006192525228 seconds
Avg sample train. time: 0.001088849326606341 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.260892391204834 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22936010360717773 seconds
Avg batch val. time: 0.022936010360717775 seconds
Avg sample val. time: 0.00035837516188621523 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 102.884085 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 16.709027 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.3744099140167236 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1844712098439536 seconds
Avg batch train. time: 0.07281570699479846 seconds
Avg sample train. time: 0.0011383383063282718 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 1.820229 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.258000135421753 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.2028534412384033 seconds
Avg batch train. time: 0.07342844804128011 seconds
Avg sample train. time: 0.0011479173742774379 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21903228759765625 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22677814960479736 seconds
Avg batch val. time: 0.022677814960479735 seconds
Avg sample val. time: 0.00035434085875749586 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 7.826579 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 0.907890 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0294699668884277 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1681767463684083 seconds
Avg batch train. time: 0.07227255821228028 seconds
Avg sample train. time: 0.0011298471841419532 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.610861 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0585410594940186 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1499041318893433 seconds
Avg batch train. time: 0.07166347106297812 seconds
Avg sample train. time: 0.0011203252380872033 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2290034294128418 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22722320556640624 seconds
Avg batch val. time: 0.022722320556640623 seconds
Avg sample val. time: 0.00035503625869750974 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 1.713451 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.595280 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.013814687728882 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.130462782723563 seconds
Avg batch train. time: 0.07101542609078543 seconds
Avg sample train. time: 0.0011101942588450041 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.489822 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9081377983093262 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1026721596717834 seconds
Avg batch train. time: 0.07008907198905945 seconds
Avg sample train. time: 0.0010957124333881101 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22400188446044922 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22668631871541342 seconds
Avg batch val. time: 0.02266863187154134 seconds
Avg sample val. time: 0.00035419737299283345 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 4.939391 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.527335 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9305615425109863 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.083548757765028 seconds
Avg batch train. time: 0.06945162525883426 seconds
Avg sample train. time: 0.0010857471379703116 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.601311 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0953867435455322 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0847325563430785 seconds
Avg batch train. time: 0.06949108521143595 seconds
Avg sample train. time: 0.0010863640210229694 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23099899291992188 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22730241503034318 seconds
Avg batch val. time: 0.022730241503034317 seconds
Avg sample val. time: 0.0003551600234849112 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 2.216693 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.500445 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0007894039154053 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0771013606678355 seconds
Avg batch train. time: 0.06923671202226118 seconds
Avg sample train. time: 0.001082387368769065 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.767346 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0137319564819336 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0718205769856772 seconds
Avg batch train. time: 0.06906068589952258 seconds
Avg sample train. time: 0.0010796355273505352 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23400211334228516 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22813987731933594 seconds
Avg batch val. time: 0.022813987731933594 seconds
Avg sample val. time: 0.0003564685583114624 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 0.947959 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 0.395848 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9740643501281738 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0643008672274075 seconds
Avg batch train. time: 0.06881002890758024 seconds
Avg sample train. time: 0.0010757169709366375 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 0.568886 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.9969525337219238 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.059490271977016 seconds
Avg batch train. time: 0.0686496757325672 seconds
Avg sample train. time: 0.0010732101469395601 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24610662460327148 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23013618257310656 seconds
Avg batch val. time: 0.023013618257310655 seconds
Avg sample val. time: 0.000359587785270479 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 0.693532 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 0.478095 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0109686851501465 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.056255499521891 seconds
Avg batch train. time: 0.06854184998406304 seconds
Avg sample train. time: 0.0010715244916737316 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.617032 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.062760591506958 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.056662067770958 seconds
Avg batch train. time: 0.06855540225903194 seconds
Avg sample train. time: 0.0010717363563162888 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.23751473426818848 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23087403774261475 seconds
Avg batch val. time: 0.023087403774261474 seconds
Avg sample val. time: 0.00036074068397283553 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 2.706947 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 0.370103 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.3544812202453613 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.074180841445923 seconds
Avg batch train. time: 0.06913936138153076 seconds
Avg sample train. time: 0.0010808654723532688 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 0.549733 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.220386028289795 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.082303351826138 seconds
Avg batch train. time: 0.06941011172753793 seconds
Avg sample train. time: 0.001085098151029775 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25502490997314453 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23306957158175381 seconds
Avg batch val. time: 0.023306957158175382 seconds
Avg sample val. time: 0.00036417120559649035 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 2.388759 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 0.723689 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.101208209991455 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.083298344361155 seconds
Avg batch train. time: 0.06944327814537182 seconds
Avg sample train. time: 0.0010856166463580797 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 0.486546 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2347209453582764 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0908694744110106 seconds
Avg batch train. time: 0.06969564914703369 seconds
Avg sample train. time: 0.0010895619981297607 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.29599761962890625 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2383135755856832 seconds
Avg batch val. time: 0.02383135755856832 seconds
Avg sample val. time: 0.00037236496185263 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 2.323669 | 
Epoch 21 Training Summary: epoch: 21.000000 | loss: 0.513132 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.112997055053711 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.09192316872733 seconds
Avg batch train. time: 0.069730772290911 seconds
Avg sample train. time: 0.001090111083234669 seconds
Epoch 22 Training Summary: epoch: 22.000000 | loss: 0.460713 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0281460285186768 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.089024207808755 seconds
Avg batch train. time: 0.06963414026029183 seconds
Avg sample train. time: 0.001088600420952973 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25099945068359375 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23928941213167632 seconds
Avg batch val. time: 0.02392894121316763 seconds
Avg sample val. time: 0.00037388970645574424 seconds
Epoch 22 Validation Summary: epoch: 22.000000 | loss: 1.814740 | 
Epoch 23 Training Summary: epoch: 23.000000 | loss: 0.651388 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.016354560852051 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.085864657941072 seconds
Avg batch train. time: 0.06952882193136906 seconds
Avg sample train. time: 0.0010869539645341699 seconds
Epoch 24 Training Summary: epoch: 24.000000 | loss: 0.863331 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.020648717880249 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.083147327105204 seconds
Avg batch train. time: 0.06943824423684014 seconds
Avg sample train. time: 0.0010855379505498718 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21500134468078613 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23755455017089844 seconds
Avg batch val. time: 0.023755455017089845 seconds
Avg sample val. time: 0.00037117898464202883 seconds
Epoch 24 Validation Summary: epoch: 24.000000 | loss: 3.240924 | 
Epoch 25 Training Summary: epoch: 25.000000 | loss: 1.023668 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2341110706329346 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0891858768463134 seconds
Avg batch train. time: 0.06963952922821044 seconds
Avg sample train. time: 0.0010886846674550879 seconds
Epoch 26 Training Summary: epoch: 26.000000 | loss: 0.608942 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.205070734024048 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.093642986737765 seconds
Avg batch train. time: 0.06978809955792549 seconds
Avg sample train. time: 0.001091007288555375 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24300312995910645 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.23791778882344564 seconds
Avg batch val. time: 0.023791778882344565 seconds
Avg sample val. time: 0.00037174654503663383 seconds
Epoch 26 Validation Summary: epoch: 26.000000 | loss: 6.719003 | 
Epoch 27 Training Summary: epoch: 27.000000 | loss: 0.848300 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.141601324081421 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0954192214541965 seconds
Avg batch train. time: 0.06984730738180654 seconds
Avg sample train. time: 0.0010919328928891072 seconds
Epoch 28 Training Summary: epoch: 28.000000 | loss: 0.558039 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.2395009994506836 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1005649992397855 seconds
Avg batch train. time: 0.07001883330799284 seconds
Avg sample train. time: 0.0010946143820947292 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.26703524589538574 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2397376298904419 seconds
Avg batch val. time: 0.02397376298904419 seconds
Avg sample val. time: 0.00037459004670381546 seconds
Epoch 28 Validation Summary: epoch: 28.000000 | loss: 8.522417 | 
Epoch 29 Training Summary: epoch: 29.000000 | loss: 0.696881 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.187002420425415 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.103545599970324 seconds
Avg batch train. time: 0.07011818666567747 seconds
Avg sample train. time: 0.00109616758726958 seconds
Epoch 30 Training Summary: epoch: 30.000000 | loss: 0.707406 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1115357875823975 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.1038119395573935 seconds
Avg batch train. time: 0.07012706465191312 seconds
Avg sample train. time: 0.0010963063780913985 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2359452247619629 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2395145472358255 seconds
Avg batch val. time: 0.02395145472358255 seconds
Avg sample val. time: 0.0003742414800559773 seconds
Epoch 30 Validation Summary: epoch: 30.000000 | loss: 11.662007 | 
Best loss was 0.6935322523117066. Other metrics: OrderedDict([('epoch', 14), ('loss', 0.6935322523117066)])
All Done!
Total runtime: 0.0 hours, 1.0 minutes, 11.146038055419922 seconds

