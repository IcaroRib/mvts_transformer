Running:
main.py --output_dir experiments/salvador_83248/ --comment regression for salvador_83248 --name salvador_83248_Regression --records_file experiments/salvador_83248/salvador_83248_Regression.xls --data_dir datasets/files/salvador_83248/ --data_class wf --pattern TRAIN --val_pattern TEST --epochs 20 --lr 0.01 --optimizer RAdam --pos_encoding learnable --task regression

Using device: cpu
Loading and preprocessing data ...
1919 samples may be used for training
640 samples will be used for validation
0 samples will be used for testing
Creating model ...
Model:
TSTransformerEncoderClassiregressor(
  (project_inp): Linear(in_features=5, out_features=64, bias=True)
  (pos_enc): LearnablePositionalEncoding(
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (transformer_encoder): TransformerEncoder(
    (layers): ModuleList(
      (0): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (1): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
      (2): TransformerBatchNormEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
        )
        (linear1): Linear(in_features=64, out_features=256, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (linear2): Linear(in_features=256, out_features=64, bias=True)
        (norm1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (norm2): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (dropout1): Dropout(p=0.1, inplace=False)
  (output_layer): Linear(in_features=1536, out_features=1, bias=True)
)
Total number of parameters: 153409
Trainable parameters: 153409
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18300127983093262 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18300127983093262 seconds
Avg batch val. time: 0.018300127983093262 seconds
Avg sample val. time: 0.0002859394997358322 seconds
Epoch 0 Validation Summary: epoch: 0.000000 | loss: 654.832690 | 
Starting training...
Epoch 1 Training Summary: epoch: 1.000000 | loss: 494.887213 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.5939996242523193 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.5939996242523193 seconds
Avg batch train. time: 0.05313332080841064 seconds
Avg sample train. time: 0.0008306407630288272 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.18500065803527832 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.18400096893310547 seconds
Avg batch val. time: 0.018400096893310548 seconds
Avg sample val. time: 0.0002875015139579773 seconds
Epoch 1 Validation Summary: epoch: 1.000000 | loss: 104.808442 | 
Epoch 2 Training Summary: epoch: 2.000000 | loss: 55.451375 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 1.6941235065460205 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.64406156539917 seconds
Avg batch train. time: 0.05480205217997233 seconds
Avg sample train. time: 0.0008567282779568369 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.21500134468078613 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.19433442751566568 seconds
Avg batch val. time: 0.019433442751566568 seconds
Avg sample val. time: 0.0003036475429932276 seconds
Epoch 2 Validation Summary: epoch: 2.000000 | loss: 18.426120 | 
Epoch 3 Training Summary: epoch: 3.000000 | loss: 2.226404 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0125207901000977 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.7668813069661458 seconds
Avg batch train. time: 0.058896043565538195 seconds
Avg sample train. time: 0.0009207302277051307 seconds
Epoch 4 Training Summary: epoch: 4.000000 | loss: 0.924843 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.021690607070923 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.83058363199234 seconds
Avg batch train. time: 0.06101945439974467 seconds
Avg sample train. time: 0.0009539258113560918 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2310771942138672 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20352011919021606 seconds
Avg batch val. time: 0.020352011919021605 seconds
Avg sample val. time: 0.0003180001862347126 seconds
Epoch 4 Validation Summary: epoch: 4.000000 | loss: 0.339158 | 
Epoch 5 Training Summary: epoch: 5.000000 | loss: 1.425104 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1176273822784424 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.8879923820495605 seconds
Avg batch train. time: 0.06293307940165202 seconds
Avg sample train. time: 0.0009838417832462535 seconds
Epoch 6 Training Summary: epoch: 6.000000 | loss: 0.948874 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0778138637542725 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9196292956670125 seconds
Avg batch train. time: 0.06398764318890042 seconds
Avg sample train. time: 0.0010003279289562336 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22132396697998047 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.20708088874816893 seconds
Avg batch val. time: 0.020708088874816892 seconds
Avg sample val. time: 0.00032356388866901394 seconds
Epoch 6 Validation Summary: epoch: 6.000000 | loss: 1.855691 | 
Epoch 7 Training Summary: epoch: 7.000000 | loss: 0.731000 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1033613681793213 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9458767345973425 seconds
Avg batch train. time: 0.06486255781991142 seconds
Avg sample train. time: 0.0010140055938495792 seconds
Epoch 8 Training Summary: epoch: 8.000000 | loss: 0.657930 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.02280592918396 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9554928839206696 seconds
Avg batch train. time: 0.06518309613068898 seconds
Avg sample train. time: 0.0010190166148622561 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2493727207183838 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21412952740987143 seconds
Avg batch val. time: 0.021412952740987142 seconds
Avg sample val. time: 0.0003345773865779241 seconds
Epoch 8 Validation Summary: epoch: 8.000000 | loss: 4.927903 | 
Epoch 9 Training Summary: epoch: 9.000000 | loss: 0.725452 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0593111515045166 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9670282469855414 seconds
Avg batch train. time: 0.06556760823285138 seconds
Avg sample train. time: 0.0010250277472566656 seconds
Epoch 10 Training Summary: epoch: 10.000000 | loss: 0.652927 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.032599925994873 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9735854148864747 seconds
Avg batch train. time: 0.06578618049621582 seconds
Avg sample train. time: 0.0010284447185442806 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22300386428833008 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2153972898210798 seconds
Avg batch val. time: 0.02153972898210798 seconds
Avg sample val. time: 0.0003365582653454372 seconds
Epoch 10 Validation Summary: epoch: 10.000000 | loss: 1.816170 | 
Epoch 11 Training Summary: epoch: 11.000000 | loss: 0.847988 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0477375984191895 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9803265224803577 seconds
Avg batch train. time: 0.06601088408267859 seconds
Avg sample train. time: 0.0010319575416781438 seconds
Epoch 12 Training Summary: epoch: 12.000000 | loss: 0.896116 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.041518211364746 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9854258298873901 seconds
Avg batch train. time: 0.06618086099624634 seconds
Avg sample train. time: 0.001034614814949135 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2239999771118164 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21647262573242188 seconds
Avg batch val. time: 0.021647262573242187 seconds
Avg sample val. time: 0.00033823847770690917 seconds
Epoch 12 Validation Summary: epoch: 12.000000 | loss: 1.426823 | 
Epoch 13 Training Summary: epoch: 13.000000 | loss: 1.376081 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.075063467025757 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9923210327441876 seconds
Avg batch train. time: 0.06641070109147292 seconds
Avg sample train. time: 0.0010382079378552307 seconds
Epoch 14 Training Summary: epoch: 14.000000 | loss: 1.351349 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.080279588699341 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 1.9986037867409843 seconds
Avg batch train. time: 0.06662012622469947 seconds
Avg sample train. time: 0.0010414819107561148 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.22994065284729004 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.21796907318962944 seconds
Avg batch val. time: 0.021796907318962944 seconds
Avg sample val. time: 0.000340576676858796 seconds
Epoch 14 Validation Summary: epoch: 14.000000 | loss: 10.135392 | 
Epoch 15 Training Summary: epoch: 15.000000 | loss: 1.606182 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.072111129760742 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0035042762756348 seconds
Avg batch train. time: 0.0667834758758545 seconds
Avg sample train. time: 0.001044035579091003 seconds
Epoch 16 Training Summary: epoch: 16.000000 | loss: 0.714375 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.101567029953003 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0096331983804703 seconds
Avg batch train. time: 0.066987773279349 seconds
Avg sample train. time: 0.0010472293894635072 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.24400019645690918 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22057218551635743 seconds
Avg batch val. time: 0.022057218551635744 seconds
Avg sample val. time: 0.0003446440398693085 seconds
Epoch 16 Validation Summary: epoch: 16.000000 | loss: 2.398188 | 
Epoch 17 Training Summary: epoch: 17.000000 | loss: 1.122230 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0610556602478027 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.012658049078549 seconds
Avg batch train. time: 0.06708860163595162 seconds
Avg sample train. time: 0.0010488056535062787 seconds
Epoch 18 Training Summary: epoch: 18.000000 | loss: 1.237270 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.0614700317382812 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.015369825892978 seconds
Avg batch train. time: 0.06717899419643261 seconds
Avg sample train. time: 0.0010502187732636676 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.2520015239715576 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.22342939810319382 seconds
Avg batch val. time: 0.02234293981031938 seconds
Avg sample val. time: 0.0003491084345362403 seconds
Epoch 18 Validation Summary: epoch: 18.000000 | loss: 2.020272 | 
Epoch 19 Training Summary: epoch: 19.000000 | loss: 1.028227 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1032822132110596 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.0199967936465613 seconds
Avg batch train. time: 0.06733322645488538 seconds
Avg sample train. time: 0.0010526299081013869 seconds
Epoch 20 Training Summary: epoch: 20.000000 | loss: 1.023756 | 
Epoch runtime: 0.0 hours, 0.0 minutes, 2.1498353481292725 seconds

Avg epoch train. time: 0.0 hours, 0.0 minutes, 2.026488721370697 seconds
Avg batch train. time: 0.0675496240456899 seconds
Avg sample train. time: 0.0010560128824235002 seconds
Evaluating on validation set ...
Validation runtime: 0.0 hours, 0.0 minutes, 0.25151824951171875 seconds

Avg val. time: 0.0 hours, 0.0 minutes, 0.2257701357205709 seconds
Avg batch val. time: 0.02257701357205709 seconds
Avg sample val. time: 0.000352765837063392 seconds
Epoch 20 Validation Summary: epoch: 20.000000 | loss: 6.673668 | 
Best loss was 0.3391583725810051. Other metrics: OrderedDict([('epoch', 4), ('loss', 0.3391583725810051)])
All Done!
Total runtime: 0.0 hours, 0.0 minutes, 46.85339641571045 seconds

